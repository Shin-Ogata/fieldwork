{"version":3,"names":["btoa","safe","globalThis","atob","Blob","FileReader","URL","TextEncoder","Base64","encode","src","utf8Bytes","binaryString","Array","from","map","byte","String","fromCharCode","join","decode","encoded","Uint8Array","char","charCodeAt","TextDecoder","exec","methodName","args","options","cancel","token","onprogress","verify","CancelToken","Promise","resolve","reject","reader","subscription","register","abort","onabort","onerror","error","onload","result","onloadend","unsubscribe","readAsArrayBuffer","blob","readAsDataURL","readAsText","encoding","undefined","queryDataURLContext","dataURL","context","base64","Error","mimeType","test","data","binaryStringToBinary","bytes","array","split","c","toBinaryString","text","unescape","encodeURIComponent","fromBinaryString","decodeURIComponent","escape","blobToDataURL","bufferToDataURL","buffer","binaryToDataURL","binaryToBlob","binary","type","binaryToBase64","binaryToText","binaryToBinaryString","prototype","call","i","base64ToBlob","base64ToBinary","textToBlob","textToBinary","textToBase64","dataURLToBlob","dataURLToBuffer","dataURLToBinary","dataURLToBase64","_blobMap","WeakMap","_urlSet","Set","RESULT_CODE","CDP_DECLARE","DECLARE_ERROR_CODE","FormData","Headers","AbortController","URLSearchParams","XMLHttpRequest","fetch","ensureParamValue","prop","value","isFunction","toQueryStrings","params","key","Object","keys","push","toAjaxParams","assignValue","convertUrlParamType","isNumeric","Number","_execGetDefault","target","bind","_subscribableMethods","toAjaxDataStream","seed","length","loaded","stream","total","size","Math","trunc","NaN","_eventSource","EventSource","_proxyReaderHandler","get","promise","read","done","chunk","trigger","freeze","computable","isNaN","Proxy","getReader","includes","_timeout","settings","timeout","isNumber","_acceptHeaderMap","json","setupHeaders","headers","method","contentType","dataType","mode","body","username","password","delete","set","async","ajax","url","controller","opts","assign","signal","originalToken","requested","reason","source","setTimeout","makeResult","ERROR_AJAX_TIMEOUT","toUpperCase","response","ok","ERROR_AJAX_RESPONSE","statusText","ensureDataType","request","post","resource","xhr","open","forEach","setRequestHeader","send","status","JSON","parse","Worker","InlineWorker","_context","constructor","createWorkerContext","isString","TypeError","className","createObjectURL","toString","super","this","terminate","revokeObjectURL","BlobURL","create","blobs","b","cache","add","clear","has","revoke","base64ToBuffer","base64ToDataURL","base64ToText","binaryToBuffer","blobToBase64","blobToBinary","blobToBuffer","blobToText","bufferToBase64","bufferToBinary","bufferToBlob","bufferToText","dataURLToText","deserialize","cc","restoreNullish","toTypedData","fromTypedData","Boolean","fromHexString","hex","x","match","parseInt","query","serialize","ArrayBuffer","textToBuffer","textToDataURL","thread","executor","worker","ev","preventDefault","onmessage","postMessage","toHexString","reduce","str","padStart"],"sources":["cdp:///@cdp/lib-worker/binary/ssr.ts","cdp:///@cdp/lib-worker/binary/base64.ts","cdp:///@cdp/lib-worker/binary/blob-reader.ts","cdp:///@cdp/lib-worker/binary/converter.ts","cdp:///@cdp/lib-worker/binary/blob-url.ts","cdp:///@cdp/lib-worker/ajax/result-code-defs.ts","cdp:///@cdp/lib-worker/ajax/ssr.ts","cdp:///@cdp/lib-worker/ajax/params.ts","cdp:///@cdp/lib-worker/ajax/stream.ts","cdp:///@cdp/lib-worker/ajax/settings.ts","cdp:///@cdp/lib-worker/ajax/core.ts","cdp:///@cdp/lib-worker/ajax/request.ts","cdp:///@cdp/lib-worker/inline-worker/inine-worker.ts","cdp:///@cdp/lib-worker/inline-worker/thread.ts"],"sourcesContent":["import { safe } from '@cdp/core-utils';\n\n/** @internal */ export const btoa        = safe(globalThis.btoa);\n/** @internal */ export const atob        = safe(globalThis.atob);\n/** @internal */ export const Blob        = safe(globalThis.Blob);\n/** @internal */ export const FileReader  = safe(globalThis.FileReader);\n/** @internal */ export const URL         = safe(globalThis.URL);\n/** @internal */ export const TextEncoder = safe(globalThis.TextEncoder);\n","import {\n    TextEncoder,\n    atob,\n    btoa,\n} from './ssr';\n\n/**\n * @en `base64` utility for independent charactor code.\n * @ja 文字コードに依存しない `base64` ユーティリティ\n */\nexport class Base64 {\n    /**\n     * @en Encode a base-64 encoded string from a binary string.\n     * @ja 文字列を base64 形式でエンコード\n     */\n    public static encode(src: string): string {\n        const utf8Bytes = new TextEncoder().encode(src);\n        const binaryString = Array.from(utf8Bytes)\n            .map(byte => String.fromCharCode(byte))\n            .join('');\n        return btoa(binaryString);\n    }\n\n    /**\n     * @en Decodes a string of data which has been encoded using base-64 encoding.\n     * @ja base64 形式でエンコードされたデータの文字列をデコード\n     */\n    public static decode(encoded: string): string {\n        const binaryString = atob(encoded);\n        const utf8Bytes = Uint8Array.from(binaryString, char => char.charCodeAt(0));\n        return new TextDecoder().decode(utf8Bytes);\n    }\n}\n","import { type UnknownFunction, verify } from '@cdp/core-utils';\nimport { type Cancelable, CancelToken } from '@cdp/promise';\nimport { FileReader } from './ssr';\n\n/** @internal */\ninterface FileReaderArgsMap {\n    readAsArrayBuffer: [Blob];\n    readAsDataURL: [Blob];\n    readAsText: [Blob, string | undefined];\n}\n\n/** @internal */\ninterface FileReaderResultMap {\n    readAsArrayBuffer: ArrayBuffer;\n    readAsDataURL: string;\n    readAsText: string;\n}\n\n/**\n * @en `Blob` read options\n * @ja `Blob` 読み取りオプション\n */\nexport interface BlobReadOptions extends Cancelable {\n    /**\n     * @en Progress callback function.\n     * @ja 進捗コールバック関数\n     *\n     * @param progress\n     *  - `en` worker progress event\n     *  - `ja` worker 進捗イベント\n     */\n    onprogress?: (progress: ProgressEvent) => unknown;\n}\n\n/** @internal execute read blob */\nfunction exec<T extends keyof FileReaderResultMap>(\n    methodName: T,\n    args: FileReaderArgsMap[T],\n    options: BlobReadOptions,\n): Promise<FileReaderResultMap[T]> {\n    type TResult = FileReaderResultMap[T];\n    const { cancel: token, onprogress } = options;\n    token && verify('instanceOf', CancelToken, token);\n    onprogress && verify('typeOf', 'function', onprogress);\n    return new Promise<TResult>((resolve, reject) => {\n        const reader = new FileReader();\n        const subscription = token?.register(() => {\n            reader.abort();\n        });\n        reader.onabort = reader.onerror = () => {\n            reject(reader.error);\n        };\n        reader.onprogress = onprogress!;\n        reader.onload = () => {\n            resolve(reader.result as TResult);\n        };\n        reader.onloadend = () => {\n            subscription && subscription.unsubscribe();\n        };\n        (reader[methodName] as UnknownFunction)(...args);\n    }, token);\n}\n\n/**\n * @en Get the `ArrayBuffer` result from `Blob` or `File`.\n * @ja `Blob` または `File` から `ArrayBuffer` を取得\n *\n * @param blob\n *  - `en` specified reading target object.\n *  - `ja` 読み取り対象のオブジェクトを指定\n * @param options\n *  - `en` reading options.\n *  - `ja` 読み取りオプションを指定\n */\nexport function readAsArrayBuffer(blob: Blob, options?: BlobReadOptions): Promise<ArrayBuffer> {\n    return exec('readAsArrayBuffer', [blob], { ...options });\n}\n\n/**\n * @en Get the data-URL string from `Blob` or `File`.\n * @ja `Blob` または `File` から `data-url 文字列を取得\n *\n * @param blob\n *  - `en` specified reading target object.\n *  - `ja` 読み取り対象のオブジェクトを指定\n * @param options\n *  - `en` reading options.\n *  - `ja` 読み取りオプションを指定\n */\nexport function readAsDataURL(blob: Blob, options?: BlobReadOptions): Promise<string> {\n    return exec('readAsDataURL', [blob], { ...options });\n}\n\n/**\n * @en Get the text content string from `Blob` or `File`.\n * @ja `Blob` または `File` からテキスト文字列を取得\n *\n * @param blob\n *  - `en` specified reading target object.\n *  - `ja` 読み取り対象のオブジェクトを指定\n * @param encoding\n *  - `en` encoding string to use for the returned data. default: `utf-8`\n *  - `ja` エンコーディングを指定する文字列 既定: `utf-8`\n * @param options\n *  - `en` reading options.\n *  - `ja` 読み取りオプションを指定\n */\nexport function readAsText(blob: Blob, encoding?: string | null, options?: BlobReadOptions): Promise<string> {\n    return exec('readAsText', [blob, encoding ?? undefined], { ...options });\n}\n","import {\n    type Keys,\n    type Types,\n    type TypeToKey,\n    toTypedData,\n    fromTypedData,\n    restoreNullish,\n} from '@cdp/core-utils';\nimport {\n    type Cancelable,\n    checkCanceled as cc,\n} from '@cdp/promise';\nimport { Base64 } from './base64';\nimport {\n    type BlobReadOptions,\n    readAsArrayBuffer,\n    readAsDataURL,\n    readAsText,\n} from './blob-reader';\nimport { Blob } from './ssr';\n\n/** @internal */\nconst enum MimeType {\n    BINARY = 'application/octet-stream',\n    TEXT = 'text/plain',\n}\n\n//__________________________________________________________________________________________________//\n\n/** @internal data-URL 属性 */\ninterface DataURLContext {\n    mimeType: string;\n    base64: boolean;\n    data: string;\n}\n\n/**\n * @internal\n * data URI 形式の正規表現\n * 参考: https://developer.mozilla.org/ja/docs/data_URIs\n */\nfunction queryDataURLContext(dataURL: string): DataURLContext {\n    const context = { base64: false } as DataURLContext;\n\n    /**\n     * [match] 1: mime-type\n     *         2: \";base64\" を含むオプション\n     *         3: data 本体\n     */\n    const result = /^data:(.+?\\/.+?)?(;.+?)?,(.*)$/.exec(dataURL);\n    if (null == result) {\n        throw new Error(`Invalid data-URL: ${dataURL}`);\n    }\n\n    context.mimeType = result[1];\n    context.base64 = /;base64/.test(result[2]); // eslint-disable-line @typescript-eslint/prefer-includes\n    context.data = result[3];\n\n    return context;\n}\n\n//__________________________________________________________________________________________________//\n\n/** @internal helper */\nfunction binaryStringToBinary(bytes: string): Uint8Array {\n    const array = bytes.split('').map(c => c.charCodeAt(0));\n    return new Uint8Array(array);\n}\n\n/** @internal helper */\nfunction binaryToBinaryString(binary: Uint8Array): string {\n    return Array.prototype.map.call(binary, (i: number) => String.fromCharCode(i)).join('');\n}\n\n/**\n * @en Convert string to binary-string. (not human readable string)\n * @ja バイナリ文字列に変換\n *\n * @param text\n */\nexport function toBinaryString(text: string): string {\n    return unescape(encodeURIComponent(text));\n}\n\n/**\n * @en Convert string from binary-string.\n * @ja バイナリ文字列から変換\n *\n * @param bytes\n */\nexport function fromBinaryString(bytes: string): string {\n    return decodeURIComponent(escape(bytes));\n}\n\n/**\n * @en Convert binary to hex-string.\n * @ja バイナリを HEX 文字列に変換\n *\n * @param hex\n */\nexport function fromHexString(hex: string): Uint8Array {\n    const x = hex.match(/.{1,2}/g);\n    return new Uint8Array(null != x ? x.map(byte => parseInt(byte, 16)) : []);\n}\n\n/**\n * @en Convert string from hex-string.\n * @ja HEX 文字列からバイナリに変換\n *\n * @param binary\n */\nexport function toHexString(binary: Uint8Array): string {\n    return binary.reduce((str, byte) => str + byte.toString(16).toUpperCase().padStart(2, '0'), '');\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert `Blob` to `ArrayBuffer`.\n * @ja `Blob` から `ArrayBuffer` へ変換\n *\n * @param blob\n *  - `en` `Blob` instance\n *  - `ja` `Blob` インスタンスを指定\n * @param options\n */\nexport function blobToBuffer(blob: Blob, options?: BlobReadOptions): Promise<ArrayBuffer> {\n    return readAsArrayBuffer(blob, options);\n}\n\n/**\n * @en Convert `Blob` to `Uint8Array`.\n * @ja `Blob` から `Uint8Array` へ変換\n *\n * @param blob\n *  - `en` `Blob` instance\n *  - `ja` `Blob` インスタンスを指定\n * @param options\n */\nexport async function blobToBinary(blob: Blob, options?: BlobReadOptions): Promise<Uint8Array> {\n    return new Uint8Array(await readAsArrayBuffer(blob, options));\n}\n\n/**\n * @en Convert `Blob` to data-URL string.\n * @ja `Blob` から data-URL 文字列へ変換\n *\n * @param blob\n *  - `en` `Blob` instance\n *  - `ja` `Blob` インスタンスを指定\n * @param options\n */\nexport function blobToDataURL(blob: Blob, options?: BlobReadOptions): Promise<string> {\n    return readAsDataURL(blob, options);\n}\n\n/**\n * @en Convert `Blob` to text string.\n * @ja `Blob` からテキストへ変換\n *\n * @param blob\n *  - `en` `Blob` instance\n *  - `ja` `Blob` インスタンスを指定\n * @param options\n */\nexport function blobToText(blob: Blob, options?: BlobReadOptions & { encoding?: string | null; }): Promise<string> {\n    const opts = options ?? {};\n    const { encoding } = opts;\n    return readAsText(blob, encoding, opts);\n}\n\n/**\n * @en Convert `Blob` to Base64 string.\n * @ja `Blob` から Base64 文字列へ変換\n *\n * @param blob\n *  - `en` `Blob` instance\n *  - `ja` `Blob` インスタンスを指定\n * @param options\n */\nexport async function blobToBase64(blob: Blob, options?: BlobReadOptions): Promise<string> {\n    return queryDataURLContext(await readAsDataURL(blob, options)).data;\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert `ArrayBuffer` to `Blob`.\n * @ja `ArrayBuffer` から `Blob` に変換\n *\n * @param buffer\n *  - `en` `ArrayBuffer` instance\n *  - `ja` `ArrayBuffer` インスタンスを指定\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type 文字列\n */\nexport function bufferToBlob(buffer: ArrayBuffer, mimeType: string = MimeType.BINARY): Blob {\n    return new Blob([buffer], { type: mimeType });\n}\n\n/**\n * @en Convert `ArrayBuffer` to `Uint8Array`.\n * @ja `ArrayBuffer` から `Uint8Array` に変換\n *\n * @param buffer\n *  - `en` `ArrayBuffer` instance\n *  - `ja` `ArrayBuffer` インスタンスを指定\n */\nexport function bufferToBinary(buffer: ArrayBuffer): Uint8Array {\n    return new Uint8Array(buffer);\n}\n\n/**\n * @en Convert `ArrayBuffer` to data-URL string.\n * @ja `ArrayBuffer` から data-URL 文字列に変換\n *\n * @param buffer\n *  - `en` `ArrayBuffer` instance\n *  - `ja` `ArrayBuffer` インスタンスを指定\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type 文字列\n */\nexport function bufferToDataURL(buffer: ArrayBuffer, mimeType: string = MimeType.BINARY): string {\n    return binaryToDataURL(new Uint8Array(buffer), mimeType);\n}\n\n/**\n * @en Convert `ArrayBuffer` to Base64 string.\n * @ja `ArrayBuffer` から Base64 文字列に変換\n *\n * @param buffer\n *  - `en` `ArrayBuffer` instance\n *  - `ja` `ArrayBuffer` インスタンスを指定\n */\nexport function bufferToBase64(buffer: ArrayBuffer): string {\n    return binaryToBase64(new Uint8Array(buffer));\n}\n\n/**\n * @en Convert `ArrayBuffer` to text string.\n * @ja `ArrayBuffer` からテキストに変換\n *\n * @param buffer\n *  - `en` `ArrayBuffer` instance\n *  - `ja` `ArrayBuffer` インスタンスを指定\n */\nexport function bufferToText(buffer: ArrayBuffer): string {\n    return binaryToText(new Uint8Array(buffer));\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert `Uint8Array` to `Blob`.\n * @ja `Uint8Array` から `Blob` に変換\n *\n * @param binary\n *  - `en` `Uint8Array` instance\n *  - `ja` `Uint8Array` インスタンスを指定\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type 文字列\n */\nexport function binaryToBlob(binary: Uint8Array, mimeType: string = MimeType.BINARY): Blob {\n    return new Blob([binary], { type: mimeType });\n}\n\n/**\n * @en Convert `Uint8Array` to `ArrayBuffer`.\n * @ja `Uint8Array` から `ArrayBuffer` に変換\n *\n * @param binary\n *  - `en` `Uint8Array` instance\n *  - `ja` `Uint8Array` インスタンスを指定\n */\nexport function binaryToBuffer(binary: Uint8Array): ArrayBufferLike {\n    return binary.buffer;\n}\n\n/**\n * @en Convert `Uint8Array` to data-URL string.\n * @ja `Uint8Array` から data-URL 文字列に変換\n *\n * @param binary\n *  - `en` `Uint8Array` instance\n *  - `ja` `Uint8Array` インスタンスを指定\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type 文字列\n */\nexport function binaryToDataURL(binary: Uint8Array, mimeType: string = MimeType.BINARY): string {\n    return `data:${mimeType};base64,${binaryToBase64(binary)}`;\n}\n\n/**\n * @en Convert `Uint8Array` to Base64 string.\n * @ja `Uint8Array` から Base64 文字列に変換\n *\n * @param binary\n *  - `en` `Uint8Array` instance\n *  - `ja` `Uint8Array` インスタンスを指定\n */\nexport function binaryToBase64(binary: Uint8Array): string {\n    return Base64.encode(binaryToText(binary));\n}\n\n/**\n * @en Convert `Uint8Array` to text string.\n * @ja `Uint8Array` から テキストに変換\n *\n * @param binary\n *  - `en` `Uint8Array` instance\n *  - `ja` `Uint8Array` インスタンスを指定\n */\nexport function binaryToText(binary: Uint8Array): string {\n    return fromBinaryString(binaryToBinaryString(binary));\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert Base64 string to `Blob`.\n * @ja Base64 文字列から `Blob` に変換\n *\n * @param base64\n *  - `en` Base64 string data\n *  - `ja` Base64 文字列\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type 文字列\n */\nexport function base64ToBlob(base64: string, mimeType: string = MimeType.BINARY): Blob {\n    return binaryToBlob(base64ToBinary(base64), mimeType);\n}\n\n/**\n * @en Convert Base64 string to `ArrayBuffer`.\n * @ja Base64 文字列から `ArrayBuffer` に変換\n *\n * @param base64\n *  - `en` Base64 string data\n *  - `ja` Base64 文字列\n */\nexport function base64ToBuffer(base64: string): ArrayBufferLike {\n    return base64ToBinary(base64).buffer;\n}\n\n/**\n * @en Convert Base64 string to `Uint8Array`.\n * @ja Base64 文字列から `Uint8Array` に変換\n *\n * @param base64\n *  - `en` Base64 string data\n *  - `ja` Base64 文字列\n */\nexport function base64ToBinary(base64: string): Uint8Array {\n    return binaryStringToBinary(toBinaryString(Base64.decode(base64)));\n}\n\n/**\n * @en Convert Base64 string to data-URL string.\n * @ja Base64 文字列から data-URL 文字列に変換\n *\n * @param base64\n *  - `en` Base64 string data\n *  - `ja` Base64 文字列\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type 文字列\n */\nexport function base64ToDataURL(base64: string, mimeType: string = MimeType.BINARY): string {\n    return `data:${mimeType};base64,${base64}`;\n}\n\n/**\n * @en Convert Base64 string to text string.\n * @ja  Base64 文字列から テキストに変換\n *\n * @param base64\n *  - `en` Base64 string data\n *  - `ja` Base64 文字列\n */\nexport function base64ToText(base64: string): string {\n    return Base64.decode(base64);\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert text string to `Blob`.\n * @ja テキストから `Blob` に変換\n *\n * @param text\n *  - `en` text string data\n *  - `ja` テキスト文字列\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type 文字列\n */\nexport function textToBlob(text: string, mimeType: string = MimeType.TEXT): Blob {\n    return new Blob([text], { type: mimeType });\n}\n\n/**\n * @en Convert text string to `ArrayBuffer`.\n * @ja テキストから `ArrayBuffer` に変換\n *\n * @param text\n *  - `en` text string data\n *  - `ja` テキスト文字列\n */\nexport function textToBuffer(text: string): ArrayBufferLike {\n    return textToBinary(text).buffer;\n}\n\n/**\n * @en Convert text string to `Uint8Array`.\n * @ja テキストから `Uint8Array` に変換\n *\n * @param text\n *  - `en` text string data\n *  - `ja` テキスト文字列\n */\nexport function textToBinary(text: string): Uint8Array {\n    return binaryStringToBinary(toBinaryString(text));\n}\n\n/**\n * @en Convert text string to data-URL string.\n * @ja テキストから data-URL 文字列に変換\n *\n * @param text\n *  - `en` text string data\n *  - `ja` テキスト文字列\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type 文字列\n */\nexport function textToDataURL(text: string, mimeType: string = MimeType.TEXT): string {\n    const base64 = textToBase64(text);\n    return `data:${mimeType};base64,${base64}`;\n}\n\n/**\n * @en Convert text string to Base64 string.\n * @ja テキストから Base64 文字列に変換\n *\n * @param text\n *  - `en` text string data\n *  - `ja` テキスト文字列\n */\nexport function textToBase64(text: string): string {\n    return Base64.encode(text);\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert data-URL string to `Blob`.\n * @ja data-URL 文字列から `Blob` に変換\n *\n * @param dataURL\n *  - `en` data-URL string data\n *  - `ja` data-URL 文字列\n */\nexport function dataURLToBlob(dataURL: string): Blob {\n    const context = queryDataURLContext(dataURL);\n    if (context.base64) {\n        return base64ToBlob(context.data, context.mimeType || MimeType.BINARY);\n    } else {\n        return textToBlob(decodeURIComponent(context.data), context.mimeType || MimeType.TEXT);\n    }\n}\n\n/**\n * @en Convert data-URL string to `ArrayBuffer`.\n * @ja data-URL 文字列から `ArrayBuffer` に変換\n *\n * @param dataURL\n *  - `en` data-URL string data\n *  - `ja` data-URL 文字列\n */\nexport function dataURLToBuffer(dataURL: string): ArrayBufferLike {\n    return dataURLToBinary(dataURL).buffer;\n}\n\n/**\n * @en Convert data-URL string to `Uint8Array`.\n * @ja data-URL 文字列から `Uint8Array` に変換\n *\n * @param dataURL\n *  - `en` data-URL string data\n *  - `ja` data-URL 文字列\n */\nexport function dataURLToBinary(dataURL: string): Uint8Array {\n    return base64ToBinary(dataURLToBase64(dataURL));\n}\n\n/**\n * @en Convert data-URL string to text string.\n * @ja data-URL 文字列からテキストに変換\n *\n * @param dataURL\n *  - `en` data-URL string data\n *  - `ja` data-URL 文字列\n */\nexport function dataURLToText(dataURL: string): string {\n    return Base64.decode(dataURLToBase64(dataURL));\n}\n\n/**\n * @en Convert data-URL string to Base64 string.\n * @ja data-URL 文字列から Base64 文字列に変換\n *\n * @param dataURL\n *  - `en` data-URL string data\n *  - `ja` data-URL 文字列\n */\nexport function dataURLToBase64(dataURL: string): string {\n    const context = queryDataURLContext(dataURL);\n    if (context.base64) {\n        return context.data;\n    } else {\n        return Base64.encode(decodeURIComponent(context.data));\n    }\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Serializable data type list.\n * @ja シリアライズ可能なデータ型一覧\n */\nexport interface Serializable {\n    string: string;\n    number: number;\n    boolean: boolean;\n    object: object;\n    buffer: ArrayBuffer;\n    binary: Uint8Array;\n    blob: Blob;\n}\n\nexport type SerializableDataTypes = Types<Serializable>;\nexport type SerializableInputDataTypes = SerializableDataTypes | null | undefined;\nexport type SerializableKeys = Keys<Serializable>;\nexport type SerializableCastable = Omit<Serializable, 'buffer' | 'binary' | 'blob'>;\nexport type SerializableCastableTypes = Types<SerializableCastable>;\nexport type SerializableReturnType<T extends SerializableCastableTypes> = TypeToKey<SerializableCastable, T> extends never ? never : T | null | undefined;\n\n/**\n * @en Deserializable options interface.\n * @ja デシリアライズに使用するオプション\n */\nexport interface DeserializeOptions<T extends Serializable = Serializable, K extends Keys<T> = Keys<T>> extends Cancelable {\n    /** {@link SerializableKeys} */\n    dataType?: K;\n}\n\n/**\n * @en Serialize data.\n * @ja データシリアライズ\n *\n * @param data input\n * @param options blob convert options\n */\nexport async function serialize<T extends SerializableInputDataTypes>(data: T, options?: BlobReadOptions): Promise<string> {\n    const { cancel } = options ?? {};\n    await cc(cancel);\n    if (null == data) {\n        return String(data);\n    } else if (data instanceof ArrayBuffer) {\n        return bufferToDataURL(data);\n    } else if (data instanceof Uint8Array) {\n        return binaryToDataURL(data);\n    } else if (data instanceof Blob) {\n        return blobToDataURL(data, options);\n    } else {\n        return fromTypedData(data)!;\n    }\n}\n\n/**\n * @en Deserialize data.\n * @ja データの復元\n *\n * @param value input string or undefined.\n * @param options deserialize options\n */\nexport function deserialize<T extends SerializableCastableTypes = SerializableCastableTypes>(\n    value: string | undefined, options?: DeserializeOptions<Serializable, never>\n): Promise<SerializableReturnType<T>>;\n\n/**\n * @en Deserialize data.\n * @ja データの復元\n *\n * @param value input string or undefined.\n * @param options deserialize options\n */\nexport function deserialize<T extends SerializableKeys>(value: string | undefined, options: DeserializeOptions<Serializable, T>): Promise<Serializable[T] | null | undefined>;\n\nexport async function deserialize(value: string | undefined, options?: DeserializeOptions): Promise<SerializableDataTypes | null | undefined> {\n    const { dataType, cancel } = options ?? {};\n    await cc(cancel);\n\n    const data = restoreNullish(toTypedData(value));\n    switch (dataType) {\n        case 'string':\n            return fromTypedData(data);\n        case 'number':\n            return Number(data);\n        case 'boolean':\n            return Boolean(data);\n        case 'object':\n            return Object(data);\n        case 'buffer':\n            return dataURLToBuffer(fromTypedData(data)!);\n        case 'binary':\n            return dataURLToBinary(fromTypedData(data)!);\n        case 'blob':\n            return dataURLToBlob(fromTypedData(data)!);\n        default:\n            return data;\n    }\n}\n","import { URL } from './ssr';\n\n/** @internal */ const _blobMap = new WeakMap<Blob, string>();\n/** @internal */ const _urlSet  = new Set<string>();\n\n/**\n * @en `Blob URL` utility for automatic memory manegement.\n * @ja メモリ自動管理を行う `Blob URL` ユーティリティ\n */\nexport class BlobURL {\n    /**\n     * @en Create `Blob URL` from instances.\n     * @ja インスタンスを指定して `Blob URL` の構築\n     */\n    public static create(...blobs: Blob[]): void {\n        for (const b of blobs) {\n            const cache = _blobMap.get(b);\n            if (cache) {\n                continue;\n            }\n            const url = URL.createObjectURL(b);\n            _blobMap.set(b, url);\n            _urlSet.add(url);\n        }\n    }\n\n    /**\n     * @en Clear all `Blob URL` cache.\n     * @ja すべての `Blob URL` キャッシュを破棄\n     */\n    public static clear(): void {\n        for (const url of _urlSet) {\n            URL.revokeObjectURL(url);\n        }\n        _urlSet.clear();\n    }\n\n    /**\n     * @en Get `Blob URL` from instance.\n     * @ja インスタンスを指定して `Blob URL` の取得\n     */\n    public static get(blob: Blob): string {\n        const cache = _blobMap.get(blob);\n        if (cache) {\n            return cache;\n        }\n        const url = URL.createObjectURL(blob);\n        _blobMap.set(blob, url);\n        _urlSet.add(url);\n        return url;\n    }\n\n    /**\n     * @en Check `Blob URL` is available from instance.\n     * @ja インスタンスを指定して `Blob URL` が有効化判定\n     */\n    public static has(blob: Blob): boolean {\n        return _blobMap.has(blob);\n    }\n\n    /**\n     * @en Revoke `Blob URL` from instances.\n     * @ja インスタンスを指定して `Blob URL` を無効化\n     */\n    public static revoke(...blobs: Blob[]): void {\n        for (const b of blobs) {\n            const url = _blobMap.get(b);\n            if (url) {\n                URL.revokeObjectURL(url);\n                _blobMap.delete(b);\n                _urlSet.delete(url);\n            }\n        }\n    }\n}\n","/* eslint-disable\n    @typescript-eslint/no-namespace,\n    @typescript-eslint/no-unused-vars,\n */\n\nnamespace CDP_DECLARE {\n\n    const enum LOCAL_CODE_BASE {\n        AJAX = CDP_KNOWN_MODULE.AJAX * LOCAL_CODE_RANGE_GUIDE.FUNCTION,\n    }\n\n    /**\n     * @en Extends error code definitions.\n     * @ja 拡張エラーコード定義\n     */\n    export enum RESULT_CODE {\n        AJAX_DECLARE        = RESULT_CODE_BASE.DECLARE,\n        ERROR_AJAX_RESPONSE = DECLARE_ERROR_CODE(RESULT_CODE_BASE.CDP, LOCAL_CODE_BASE.AJAX + 1, 'network error.'),\n        ERROR_AJAX_TIMEOUT  = DECLARE_ERROR_CODE(RESULT_CODE_BASE.CDP, LOCAL_CODE_BASE.AJAX + 2, 'request timeout.'),\n    }\n}\n","import { safe } from '@cdp/core-utils';\n\n/** @internal */ export const FormData        = safe(globalThis.FormData);\n/** @internal */ export const Headers         = safe(globalThis.Headers);\n/** @internal */ export const AbortController = safe(globalThis.AbortController);\n/** @internal */ export const URLSearchParams = safe(globalThis.URLSearchParams);\n/** @internal */ export const XMLHttpRequest  = safe(globalThis.XMLHttpRequest);\n/** @internal */ export const fetch           = safe(globalThis.fetch);\n","import {\n    type PlainObject,\n    isFunction,\n    isNumeric,\n    assignValue,\n} from '@cdp/core-utils';\nimport { URLSearchParams } from './ssr';\n\n/** @internal ensure string value */\nconst ensureParamValue = (prop: unknown): string => {\n    const value = isFunction(prop) ? prop() : prop;\n    return undefined !== value ? String(value) : '';\n};\n\n/**\n * @en Convert `PlainObject` to query strings.\n * @ja `PlainObject` をクエリストリングに変換\n */\nexport const toQueryStrings = (data: PlainObject): string => {\n    const params: string[] = [];\n    for (const key of Object.keys(data)) {\n        const value = ensureParamValue(data[key]);\n        if (value) {\n            params.push(`${encodeURIComponent(key)}=${encodeURIComponent(value)}`);\n        }\n    }\n    return params.join('&');\n};\n\n/**\n * @en Convert `PlainObject` to Ajax parameters object.\n * @ja `PlainObject` を Ajax パラメータオブジェクトに変換\n */\nexport const toAjaxParams = (data: PlainObject): Record<string, string> => {\n    const params: Record<string, string> = {};\n    for (const key of Object.keys(data)) {\n        const value = ensureParamValue(data[key]);\n        if (value) {\n            assignValue(params, key, value);\n        }\n    }\n    return params;\n};\n\n/**\n * @en Convert URL parameters to primitive type.\n * @ja URL パラメータを primitive に変換\n */\nexport const convertUrlParamType = (value: string): string | number | boolean | null => {\n    if (isNumeric(value)) {\n        return Number(value);\n    } else if ('true' === value) {\n        return true;\n    } else if ('false' === value) {\n        return false;\n    } else if ('null' === value) {\n        return null;\n    } else {\n        return decodeURIComponent(value);\n    }\n};\n\n/**\n * @en Parse url query GET parameters.\n * @ja URLクエリのGETパラメータを解析\n *\n * @example <br>\n *\n * ```ts\n * const url = '/page/?id=5&foo=bar&bool=true';\n * const query = parseUrlQuery(url);\n * // { id: 5, foo: 'bar', bool: true }\n * ```\n *\n * @returns { key: value } object.\n */\nexport const parseUrlQuery = <T = Record<string, string | number | boolean | null>>(url: string): T => {\n    const query: Record<string, unknown> = {};\n    const params = new URLSearchParams(url.includes('?') ? url.split('?')[1] : url);\n    for (const [key, value] of params) {\n        query[decodeURIComponent(key)] = convertUrlParamType(value);\n    }\n    return query as T;\n};\n","import {\n    type UnknownFunction,\n    type Accessible,\n    type Keys,\n    isFunction,\n} from '@cdp/core-utils';\nimport { type Subscribable, EventSource } from '@cdp/events';\nimport type { AjaxDataStreamEvent, AjaxDataStream } from './interfaces';\n\n/** @internal ProxyHandler helper */\nconst _execGetDefault = (target: any, prop: string | symbol): any => { // eslint-disable-line @typescript-eslint/no-explicit-any\n    if (prop in target) {\n        if (isFunction(target[prop])) {\n            return target[prop].bind(target);\n        } else {\n            return target[prop];\n        }\n    }\n};\n\n/** @internal */\nconst _subscribableMethods: Keys<Subscribable>[] = [\n    'hasListener',\n    'channels',\n    'on',\n    'off',\n    'once',\n];\n\nexport const toAjaxDataStream = (seed: Blob | ReadableStream<Uint8Array>, length?: number): AjaxDataStream => {\n    let loaded = 0;\n    const [stream, total] = (() => {\n        if (seed instanceof Blob) {\n            return [seed.stream(), seed.size];\n        } else {\n            return [seed, length != null ? Math.trunc(length) : NaN];\n        }\n    })();\n\n    const _eventSource = new EventSource<AjaxDataStreamEvent>() as Accessible<EventSource<AjaxDataStreamEvent>, UnknownFunction>;\n\n    const _proxyReaderHandler: ProxyHandler<ReadableStreamDefaultReader<Uint8Array>> = {\n        get: (target: ReadableStreamDefaultReader<Uint8Array>, prop: string) => {\n            if ('read' === prop) {\n                const promise = target.read();\n                void (async () => {\n                    const { done, value: chunk } = await promise;\n                    chunk && (loaded += chunk.length);\n                    _eventSource.trigger('progress', Object.freeze({\n                        computable: !Number.isNaN(total),\n                        loaded,\n                        total,\n                        done,\n                        chunk,\n                    }));\n                })();\n                return () => promise;\n            } else {\n                return _execGetDefault(target, prop);\n            }\n        },\n    };\n\n    return new Proxy(stream, {\n        get: (target: ReadableStream<Uint8Array>, prop: string) => {\n            if ('getReader' === prop) {\n                return () => new Proxy(target.getReader(), _proxyReaderHandler);\n            } else if ('length' === prop) {\n                return total;\n            } else if (_subscribableMethods.includes(prop as Keys<Subscribable>)) {\n                return (...args: unknown[]) => _eventSource[prop](...args);\n            } else {\n                return _execGetDefault(target, prop);\n            }\n        },\n    }) as AjaxDataStream;\n};\n","import { isNumber } from '@cdp/core-utils';\n\n/** @internal */ let _timeout: number | undefined;\n\nexport const settings = {\n    get timeout(): number | undefined {\n        return _timeout;\n    },\n    set timeout(value: number | undefined) {\n        _timeout = (isNumber(value) && 0 <= value) ? value : undefined;\n    },\n};\n","import { CancelToken } from '@cdp/promise';\nimport { RESULT_CODE, makeResult } from '@cdp/result';\nimport { Base64 } from '@cdp/binary';\nimport type {\n    AjaxDataTypes,\n    AjaxOptions,\n    AjaxResult,\n} from './interfaces';\nimport {\n    FormData,\n    Headers,\n    AbortController,\n    URLSearchParams,\n    fetch,\n} from './ssr';\nimport { toQueryStrings, toAjaxParams } from './params';\nimport { toAjaxDataStream } from './stream';\nimport { settings } from './settings';\n\n/** @internal */\nexport type AjaxHeaderOptions = Pick<AjaxOptions<AjaxDataTypes>, 'headers' | 'method' | 'contentType' | 'dataType' | 'mode' | 'body' | 'username' | 'password'>;\n\n/** @internal */\nconst _acceptHeaderMap: Record<string, string> = {\n    text: 'text/plain, text/html, application/xml; q=0.8, text/xml; q=0.8, */*; q=0.01',\n    json: 'application/json, text/javascript, */*; q=0.01',\n};\n\n/**\n * @en Setup `headers` from options parameter.\n * @ja オプションから `headers` を設定\n *\n * @internal\n */\nexport function setupHeaders(options: AjaxHeaderOptions): Headers {\n    const headers = new Headers(options.headers);\n    const { method, contentType, dataType, mode, body, username, password } = options;\n\n    // Content-Type\n    if ('POST' === method || 'PUT' === method || 'PATCH' === method) {\n        /*\n         * fetch() の場合, FormData を自動解釈するため, 指定がある場合は削除\n         * https://stackoverflow.com/questions/35192841/fetch-post-with-multipart-form-data\n         * https://muffinman.io/uploading-files-using-fetch-multipart-form-data/\n         */\n        if (headers.get('Content-Type') && body instanceof FormData) {\n            headers.delete('Content-Type');\n        } else if (!headers.get('Content-Type')) {\n            if (null == contentType && 'json' === dataType!) {\n                headers.set('Content-Type', 'application/json; charset=UTF-8');\n            } else if (null != contentType) {\n                headers.set('Content-Type', contentType);\n            }\n        }\n    }\n\n    // Accept\n    if (!headers.get('Accept')) {\n        headers.set('Accept', _acceptHeaderMap[dataType!] || '*/*');\n    }\n\n    /*\n     * X-Requested-With\n     * 非標準ヘッダーであるため, 既定では cors の preflight response で許可されない\n     * また mode の既定値は cors であるため, 有効にするには mode の明示的指定が必要となる\n     */\n    if (mode && 'cors' !== mode && !headers.get('X-Requested-With')) {\n        headers.set('X-Requested-With', 'XMLHttpRequest');\n    }\n\n    // Basic Authorization\n    if (null != username && !headers.get('Authorization')) {\n        headers.set('Authorization', `Basic ${Base64.encode(`${username}:${password ?? ''}`)}`);\n    }\n\n    return headers;\n}\n\n/**\n * @en Perform an asynchronous HTTP (Ajax) request.\n * @ja HTTP (Ajax)リクエストの送信\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxリクエストを送信するURLを指定\n * @param options\n *  - `en` Ajax request settings.\n *  - `ja` Ajaxリクエスト設定\n */\nasync function ajax<T extends AjaxDataTypes | object = 'response'>(url: string, options?: AjaxOptions<T>): Promise<AjaxResult<T>> {\n    const controller = new AbortController();\n    const abort = (): void => controller.abort();\n\n    const opts = Object.assign({\n        method: 'GET',\n        dataType: 'response',\n        timeout: settings.timeout,\n    }, options, {\n        signal: controller.signal, // force override\n    });\n\n    const { cancel: originalToken, timeout } = opts;\n\n    // cancellation\n    if (originalToken) {\n        if (originalToken.requested) {\n            throw originalToken.reason;\n        }\n        originalToken.register(abort);\n    }\n\n    const source = CancelToken.source(originalToken!);\n    const { token } = source;\n    token.register(abort);\n\n    // timeout\n    if (timeout) {\n        setTimeout(() => source.cancel(makeResult(RESULT_CODE.ERROR_AJAX_TIMEOUT, 'request timeout')), timeout);\n    }\n\n    // normalize\n    opts.method = opts.method.toUpperCase();\n\n    // header\n    opts.headers = setupHeaders(opts);\n\n    // parse param\n    const { method, data, dataType } = opts;\n    if (null != data) {\n        if (('GET' === method || 'HEAD' === method) && !url.includes('?')) {\n            url += `?${toQueryStrings(data)}`;\n        } else {\n            opts.body ??= new URLSearchParams(toAjaxParams(data));\n        }\n    }\n\n    // execute\n    const response = await Promise.resolve(fetch(url, opts), token);\n    if ('response' === dataType) {\n        return response as AjaxResult<T>;\n    } else if (!response.ok) {\n        throw makeResult(RESULT_CODE.ERROR_AJAX_RESPONSE, response.statusText, response);\n    } else if ('stream' === dataType) {\n        return toAjaxDataStream(\n            response.body!,\n            Number(response.headers.get('content-length')),\n        ) as AjaxResult<T>;\n    } else {\n        // eslint-disable-next-line\n        return Promise.resolve(response[dataType as Exclude<AjaxDataTypes, 'response' | 'stream'>](), token);\n    }\n}\n\najax.settings = settings;\n\nexport { ajax };\n","import type { PlainObject } from '@cdp/core-utils';\nimport { RESULT_CODE, makeResult } from '@cdp/result';\nimport type {\n    AjaxDataTypes,\n    AjaxOptions,\n    AjaxRequestOptions,\n    AjaxGetRequestShortcutOptions,\n    AjaxResult,\n} from './interfaces';\nimport { ajax, setupHeaders } from './core';\nimport { toQueryStrings } from './params';\nimport { XMLHttpRequest } from './ssr';\n\n/** @internal */\nconst ensureDataType = (dataType?: AjaxDataTypes): AjaxDataTypes => {\n    return dataType ?? 'json';\n};\n\n/**\n * @en `GET` request shortcut.\n * @ja `GET` リクエストショートカット\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxリクエストを送信するURLを指定\n * @param data\n *  - `en` Data to be sent to the server.\n *  - `ja` サーバーに送信されるデータ.\n * @param dataType\n *  - `en` Data to be sent to the server.\n *  - `ja` サーバーから返される期待するデータの型を指定\n * @param options\n *  - `en` request settings.\n *  - `ja` リクエスト設定\n */\nconst get = <T extends AjaxDataTypes | object = 'json'>(\n    url: string,\n    data?: PlainObject,\n    dataType?: T extends AjaxDataTypes ? T : 'json',\n    options?: AjaxRequestOptions\n): Promise<AjaxResult<T>> => {\n    return ajax(url, { ...options, method: 'GET', data, dataType: ensureDataType(dataType) } as AjaxOptions<T>);\n};\n\n/**\n * @en `GET` text request shortcut.\n * @ja `GET` テキストリクエストショートカット\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxリクエストを送信するURLを指定\n * @param options\n *  - `en` request settings.\n *  - `ja` リクエスト設定\n */\nconst text = (url: string, options?: AjaxGetRequestShortcutOptions): Promise<AjaxResult<'text'>> => {\n    return get(url, undefined, 'text', options);\n};\n\n/**\n * @en `GET` JSON request shortcut.\n * @ja `GET` JSON リクエストショートカット\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxリクエストを送信するURLを指定\n * @param options\n *  - `en` request settings.\n *  - `ja` リクエスト設定\n */\nconst json = <T extends 'json' | object = 'json'>(url: string, options?: AjaxGetRequestShortcutOptions): Promise<AjaxResult<T>> => {\n    return get<T>(url, undefined, ('json' as T extends AjaxDataTypes ? T : 'json'), options);\n};\n\n/**\n * @en `GET` Blob request shortcut.\n * @ja `GET` Blob リクエストショートカット\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxリクエストを送信するURLを指定\n * @param options\n *  - `en` request settings.\n *  - `ja` リクエスト設定\n */\nconst blob = (url: string, options?: AjaxGetRequestShortcutOptions): Promise<AjaxResult<'blob'>> => {\n    return get(url, undefined, 'blob', options);\n};\n\n/**\n * @en `POST` request shortcut.\n * @ja `POST` リクエストショートカット\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxリクエストを送信するURLを指定\n * @param data\n *  - `en` Data to be sent to the server.\n *  - `ja` サーバーに送信されるデータ.\n * @param dataType\n *  - `en` The type of data that you're expecting back from the server.\n *  - `ja` Ajaxリクエストを送信するURLを指定\n * @param options\n *  - `en` request settings.\n *  - `ja` リクエスト設定\n */\nconst post = <T extends AjaxDataTypes | object = 'json'>(\n    url: string,\n    data: PlainObject,\n    dataType?: T extends AjaxDataTypes ? T : 'json',\n    options?: AjaxRequestOptions\n): Promise<AjaxResult<T>> => {\n    return ajax(url, { ...options, method: 'POST', data, dataType: ensureDataType(dataType) } as AjaxOptions<T>);\n};\n\n/**\n * @en Synchronous `GET` request for resource access. <br>\n *     Many browsers have deprecated synchronous XHR support on the main thread entirely.\n * @ja リソース取得のための 同期 `GET` リクエスト. <br>\n *     多くのブラウザではメインスレッドにおける同期的な XHR の対応を全面的に非推奨としているので積極使用は避けること.\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxリクエストを送信するURLを指定\n * @param dataType\n *  - `en` The type of data that you're expecting back from the server.\n *  - `ja` Ajaxリクエストを送信するURLを指定\n * @param data\n *  - `en` Data to be sent to the server.\n *  - `ja` サーバーに送信されるデータ.\n */\nconst resource = <T extends 'text' | 'json' | object = 'json'>(\n    url: string,\n    dataType?: T extends 'text' | 'json' ? T : 'json',\n    data?: PlainObject,\n): AjaxResult<T> => {\n    const xhr = new XMLHttpRequest();\n\n    if (null != data && !url.includes('?')) {\n        url += `?${toQueryStrings(data)}`;\n    }\n\n    // synchronous\n    xhr.open('GET', url, false);\n\n    const type = ensureDataType(dataType);\n    const headers = setupHeaders({ method: 'GET', dataType: type });\n    headers.forEach((value, key) => {\n        xhr.setRequestHeader(key, value);\n    });\n\n    xhr.send(null);\n    if (!(200 <= xhr.status && xhr.status < 300)) {\n        throw makeResult(RESULT_CODE.ERROR_AJAX_RESPONSE, xhr.statusText, xhr);\n    }\n\n    return 'json' === type ? JSON.parse(xhr.response) : xhr.response;\n};\n\nexport const request = {\n    get,\n    text,\n    json,\n    blob,\n    post,\n    resource,\n};\n","import {\n    isFunction,\n    isString,\n    className,\n    safe,\n} from '@cdp/core-utils';\n\n/**\n * @en {@link InlineWorker} source type definition.\n * @ja {@link InlineWorker} に指定可能なソース型定義\n */\nexport type InlienWorkerSource = ((self: Worker) => unknown) | string;\n\n/** @internal */ const URL    = safe(globalThis.URL);\n/** @internal */ const Worker = safe(globalThis.Worker);\n/** @internal */ const Blob   = safe(globalThis.Blob);\n\n/** @internal */\nfunction createWorkerContext(src: InlienWorkerSource): string {\n    if (!(isFunction(src) || isString(src))) {\n        throw new TypeError(`${className(src)} is not a function or string.`);\n    }\n    return URL.createObjectURL(new Blob([isFunction(src) ? `(${src.toString()})(self);` : src], { type: 'application/javascript' }));\n}\n\n/**\n * @en Specified `Worker` class which doesn't require a script file.\n * @ja スクリプトファイルを必要としない `Worker` クラス\n */\nexport class InlineWorker extends Worker {\n    /** @internal */\n    private _context: string;\n\n    /**\n     * constructor\n     *\n     * @param src\n     *  - `en` source function or script body.\n     *  - `ja` 実行関数またはスクリプト実体\n     * @param options\n     *  - `en` worker options.\n     *  - `ja` Worker オプション\n     */\n    constructor(src: InlienWorkerSource, options?: WorkerOptions) {\n        const context = createWorkerContext(src);\n        super(context, options);\n        this._context = context;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// override: Worker\n\n    /**\n     * @en For BLOB release. When calling `close ()` in the Worker, call this method as well.\n     * @ja BLOB 解放用. Worker 内で `close()` を呼ぶ場合, 本メソッドもコールすること.\n     */\n    terminate(): void {\n        super.terminate();\n        URL.revokeObjectURL(this._context);\n    }\n}\n","import type { UnknownFunction } from '@cdp/core-utils';\nimport { type Cancelable, CancelToken } from '@cdp/promise';\nimport { InlineWorker } from './inine-worker';\n\n/**\n * @en Thread options\n * @en スレッドオプション\n */\nexport interface ThreadOptions<T extends UnknownFunction> extends Cancelable, WorkerOptions {\n    args?: Parameters<T>;\n}\n\n/**\n * @en Ensure execution in worker thread.\n * @ja ワーカースレッド内で実行を保証\n *\n * @example <br>\n *\n * ```ts\n * const exec = (arg1: number, arg2: string) => {\n *    // this scope is worker scope. you cannot use closure access.\n *    const param = {...};\n *    const method = (p) => {...};\n *    // you can access arguments from options.\n *    console.log(arg1); // '1'\n *    console.log(arg2); // 'test'\n *    :\n *    return method(param);\n * };\n *\n * const arg1 = 1;\n * const arg2 = 'test';\n * const result = await thread(exec, { args: [arg1, arg2] });\n * ```\n *\n * @param executor\n *  - `en` implement as function scope.\n *  - `ja` 関数スコープとして実装\n * @param options\n *  - `en` thread options\n *  - `ja` スレッドオプション\n */\nexport function thread<T, U>(executor: (...args: U[]) => T | Promise<T>, options?: ThreadOptions<typeof executor>): Promise<T> {\n    const { cancel: originalToken, args } = Object.assign({ args: [] }, options);\n\n    // already cancel\n    if (originalToken?.requested) {\n        throw originalToken.reason;\n    }\n\n    const exec = `(self => {\n        self.addEventListener('message', async ({ data }) => {\n            try {\n                const result = await (${executor.toString()})(...data);\n                self.postMessage(result);\n            } catch (e) {\n                setTimeout(function() { throw e; });\n            }\n        });\n    })(self);`;\n\n    const worker = new InlineWorker(exec, options);\n\n    const abort = (): void => worker.terminate();\n    originalToken?.register(abort);\n    const { token } = CancelToken.source(originalToken!);\n\n    const promise = new Promise((resolve, reject) => {\n        worker.onerror = ev => {\n            ev.preventDefault();\n            reject(ev);\n            worker.terminate();\n        };\n        worker.onmessage = ev => {\n            resolve(ev.data);\n            worker.terminate();\n        };\n    }, token);\n\n    worker.postMessage(args);\n\n    return promise as Promise<T>;\n}\n"],"mappings":"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","ignoreList":[]}