{"version":3,"sources":["cdp:///@cdp/lib-worker/binary/ssr.ts","cdp:///@cdp/lib-worker/binary/base64.ts","cdp:///@cdp/lib-worker/binary/blob-reader.ts","cdp:///@cdp/lib-worker/binary/converter.ts","cdp:///@cdp/lib-worker/binary/blob-url.ts","cdp:///@cdp/lib-worker/ajax/result-code-defs.ts","cdp:///@cdp/lib-worker/ajax/ssr.ts","cdp:///@cdp/lib-worker/ajax/settings.ts","cdp:///@cdp/lib-worker/ajax/core.ts","cdp:///@cdp/lib-worker/ajax/request.ts","cdp:///@cdp/lib-worker/inline-worker/inine-worker.ts","cdp:///@cdp/lib-worker/inline-worker/thread.ts"],"names":["btoa","safe","globalThis","atob","Blob","FileReader","URL","Base64","static","src","unescape","encodeURIComponent","encoded","decodeURIComponent","escape","exec","methodName","args","options","cancel","token","onprogress","verify","CancelToken","Promise","resolve","reject","reader","subscription","register","abort","onabort","onerror","error","onload","result","onloadend","unsubscribe","readAsArrayBuffer","blob","readAsDataURL","readAsText","encoding","undefined","queryDataURLContext","dataURL","context","base64","Error","mimeType","test","data","binaryStringToBinary","bytes","array","split","map","c","charCodeAt","Uint8Array","toBinaryString","text","fromBinaryString","blobToDataURL","bufferToDataURL","buffer","binaryToDataURL","binaryToBlob","binary","type","binaryToBase64","encode","binaryToText","binaryToBinaryString","Array","prototype","call","i","String","fromCharCode","join","base64ToBlob","base64ToBinary","decode","textToBlob","textToBinary","textToBase64","dataURLToBlob","dataURLToBuffer","dataURLToBinary","dataURLToBase64","_blobMap","WeakMap","_urlSet","Set","RESULT_CODE","CDP_DECLARE","DECLARE_ERROR_CODE","FormData","Headers","AbortController","URLSearchParams","XMLHttpRequest","fetch","_timeout","settings","timeout","value","isNumber","_acceptHeaderMap","json","setupHeaders","headers","method","contentType","dataType","mode","body","username","password","get","delete","set","ensureParamValue","prop","isFunction","toQueryStrings","params","key","Object","keys","push","toAjaxParams","async","ajax","url","controller","opts","assign","signal","originalToken","requested","reason","source","setTimeout","makeResult","ERROR_AJAX_TIMEOUT","toUpperCase","includes","response","ok","length","Number","stream","ERROR_AJAX_RESPONSE","statusText","ensureDataType","post","resource","xhr","open","forEach","setRequestHeader","send","status","JSON","parse","Worker","InlineWorker","constructor","createWorkerContext","isString","TypeError","className","createObjectURL","toString","super","this","_context","terminate","revokeObjectURL","BlobURL","blobs","b","cache","add","clear","has","base64ToBuffer","base64ToDataURL","base64ToText","binaryToBuffer","blobToBase64","blobToBinary","blobToBuffer","blobToText","bufferToBase64","bufferToBinary","bufferToBlob","bufferToText","dataURLToText","deserialize","cc","restoreNil","toTypedData","fromTypedData","Boolean","fromHexString","hex","x","match","byte","parseInt","serialize","ArrayBuffer","textToBuffer","textToDataURL","thread","executor","worker","promise","ev","preventDefault","onmessage","postMessage","toHexString","reduce","str","padStart"],"mappings":"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","sourcesContent":["import { safe } from '@cdp/core-utils';\n\n/** @internal */ export const btoa       = safe(globalThis.btoa);\n/** @internal */ export const atob       = safe(globalThis.atob);\n/** @internal */ export const Blob       = safe(globalThis.Blob);\n/** @internal */ export const FileReader = safe(globalThis.FileReader);\n/** @internal */ export const URL        = safe(globalThis.URL);\n","import { atob, btoa } from './ssr';\n\n/**\n * @en `base64` utility for independent charactor code.\n * @ja æå­ã³ã¼ãã«ä¾å­ããªã `base64` ã¦ã¼ãã£ãªãã£\n */\nexport class Base64 {\n    /**\n     * @en Encode a base-64 encoded string from a binary string.\n     * @ja æå­åã base64 å½¢å¼ã§ã¨ã³ã³ã¼ã\n     */\n    public static encode(src: string): string {\n        return btoa(unescape(encodeURIComponent(src)));\n    }\n\n    /**\n     * @en Decodes a string of data which has been encoded using base-64 encoding.\n     * @ja base64 å½¢å¼ã§ã¨ã³ã³ã¼ãããããã¼ã¿ã®æå­åããã³ã¼ã\n     */\n    public static decode(encoded: string): string {\n        return decodeURIComponent(escape(atob(encoded)));\n    }\n}\n","import { UnknownFunction, verify } from '@cdp/core-utils';\nimport { CancelToken, Cancelable } from '@cdp/promise';\nimport { FileReader } from './ssr';\n\n/** @internal */\ninterface FileReaderArgsMap {\n    readAsArrayBuffer: [Blob];\n    readAsDataURL: [Blob];\n    readAsText: [Blob, string | undefined];\n}\n\n/** @internal */\ninterface FileReaderResultMap {\n    readAsArrayBuffer: ArrayBuffer;\n    readAsDataURL: string;\n    readAsText: string;\n}\n\n/**\n * @en `Blob` read options\n * @ja `Blob` èª­ã¿åããªãã·ã§ã³\n */\nexport interface BlobReadOptions extends Cancelable {\n    /**\n     * @en Progress callback function.\n     * @ja é²æã³ã¼ã«ããã¯é¢æ°\n     *\n     * @param progress\n     *  - `en` worker progress event\n     *  - `ja` worker é²æã¤ãã³ã\n     */\n    onprogress?: (progress: ProgressEvent) => unknown;\n}\n\n/** @internal execute read blob */\nfunction exec<T extends keyof FileReaderResultMap>(\n    methodName: T,\n    args: FileReaderArgsMap[T],\n    options: BlobReadOptions,\n): Promise<FileReaderResultMap[T]> {\n    type TResult = FileReaderResultMap[T];\n    const { cancel: token, onprogress } = options;\n    token && verify('instanceOf', CancelToken, token);\n    onprogress && verify('typeOf', 'function', onprogress);\n    return new Promise<TResult>((resolve, reject) => {\n        const reader = new FileReader();\n        const subscription = token && token.register(() => {\n            reader.abort();\n        });\n        reader.onabort = reader.onerror = () => {\n            reject(reader.error);\n        };\n        reader.onprogress = onprogress!; // eslint-disable-line @typescript-eslint/no-non-null-assertion\n        reader.onload = () => {\n            resolve(reader.result as TResult);\n        };\n        reader.onloadend = () => {\n            subscription && subscription.unsubscribe();\n        };\n        (reader[methodName] as UnknownFunction)(...args);\n    }, token);\n}\n\n/**\n * @en Get the `ArrayBuffer` result from `Blob` or `File`.\n * @ja `Blob` ã¾ãã¯ `File` ãã `ArrayBuffer` ãåå¾\n *\n * @param blob\n *  - `en` specified reading target object.\n *  - `ja` èª­ã¿åãå¯¾è±¡ã®ãªãã¸ã§ã¯ããæå®\n * @param options\n *  - `en` reading options.\n *  - `ja` èª­ã¿åããªãã·ã§ã³ãæå®\n */\nexport function readAsArrayBuffer(blob: Blob, options?: BlobReadOptions): Promise<ArrayBuffer> {\n    return exec('readAsArrayBuffer', [blob], { ...options });\n}\n\n/**\n * @en Get the data-URL string from `Blob` or `File`.\n * @ja `Blob` ã¾ãã¯ `File` ãã `data-url æå­åãåå¾\n *\n * @param blob\n *  - `en` specified reading target object.\n *  - `ja` èª­ã¿åãå¯¾è±¡ã®ãªãã¸ã§ã¯ããæå®\n * @param options\n *  - `en` reading options.\n *  - `ja` èª­ã¿åããªãã·ã§ã³ãæå®\n */\nexport function readAsDataURL(blob: Blob, options?: BlobReadOptions): Promise<string> {\n    return exec('readAsDataURL', [blob], { ...options });\n}\n\n/**\n * @en Get the text content string from `Blob` or `File`.\n * @ja `Blob` ã¾ãã¯ `File` ãããã­ã¹ãæå­åãåå¾\n *\n * @param blob\n *  - `en` specified reading target object.\n *  - `ja` èª­ã¿åãå¯¾è±¡ã®ãªãã¸ã§ã¯ããæå®\n * @param encoding\n *  - `en` encoding string to use for the returned data. default: `utf-8`\n *  - `ja` ã¨ã³ã³ã¼ãã£ã³ã°ãæå®ããæå­å æ¢å®: `utf-8`\n * @param options\n *  - `en` reading options.\n *  - `ja` èª­ã¿åããªãã·ã§ã³ãæå®\n */\nexport function readAsText(blob: Blob, encoding?: string | null, options?: BlobReadOptions): Promise<string> {\n    return exec('readAsText', [blob, encoding || undefined], { ...options });\n}\n","import {\n    Keys,\n    Types,\n    TypeToKey,\n    toTypedData,\n    fromTypedData,\n    restoreNil,\n} from '@cdp/core-utils';\nimport {\n    Cancelable,\n    checkCanceled as cc,\n} from '@cdp/promise';\nimport { Base64 } from './base64';\nimport {\n    BlobReadOptions,\n    readAsArrayBuffer,\n    readAsDataURL,\n    readAsText,\n} from './blob-reader';\nimport { Blob } from './ssr';\n\n/** @internal */\nconst enum MimeType {\n    BINARY = 'application/octet-stream',\n    TEXT = 'text/plain',\n}\n\n//__________________________________________________________________________________________________//\n\n/** @internal data-URL å±æ§ */\ninterface DataURLContext {\n    mimeType: string;\n    base64: boolean;\n    data: string;\n}\n\n/**\n * @internal\n * data URI å½¢å¼ã®æ­£è¦è¡¨ç¾\n * åè: https://developer.mozilla.org/ja/docs/data_URIs\n */\nfunction queryDataURLContext(dataURL: string): DataURLContext {\n    const context = { base64: false } as DataURLContext;\n\n    /**\n     * [match] 1: mime-type\n     *         2: \";base64\" ãå«ããªãã·ã§ã³\n     *         3: data æ¬ä½\n     */\n    const result = /^data:(.+?\\/.+?)?(;.+?)?,(.*)$/.exec(dataURL);\n    if (null == result) {\n        throw new Error(`Invalid data-URL: ${dataURL}`);\n    }\n\n    context.mimeType = result[1];\n    context.base64 = /;base64/.test(result[2]); // eslint-disable-line @typescript-eslint/prefer-includes\n    context.data = result[3];\n\n    return context;\n}\n\n//__________________________________________________________________________________________________//\n\n/** @internal helper */\nfunction binaryStringToBinary(bytes: string): Uint8Array {\n    const array = bytes.split('').map(c => c.charCodeAt(0));\n    return new Uint8Array(array);\n}\n\n/** @internal helper */\nfunction binaryToBinaryString(binary: Uint8Array): string {\n    return Array.prototype.map.call(binary, (i: number) => String.fromCharCode(i)).join('');\n}\n\n/**\n * @en Convert string to binary-string. (not human readable string)\n * @ja ãã¤ããªæå­åã«å¤æ\n *\n * @param text\n */\nexport function toBinaryString(text: string): string {\n    return unescape(encodeURIComponent(text));\n}\n\n/**\n * @en Convert string from binary-string.\n * @ja ãã¤ããªæå­åããå¤æ\n *\n * @param bytes\n */\nexport function fromBinaryString(bytes: string): string {\n    return decodeURIComponent(escape(bytes));\n}\n\n/**\n * @en Convert binary to hex-string.\n * @ja ãã¤ããªã HEX æå­åã«å¤æ\n *\n * @param hex\n */\nexport function fromHexString(hex: string): Uint8Array {\n    const x = hex.match(/.{1,2}/g);\n    return new Uint8Array(null != x ? x.map(byte => parseInt(byte, 16)) : []);\n}\n\n/**\n * @en Convert string from hex-string.\n * @ja HEX æå­åãããã¤ããªã«å¤æ\n *\n * @param binary\n */\nexport function toHexString(binary: Uint8Array): string {\n    return binary.reduce((str, byte) => str + byte.toString(16).toUpperCase().padStart(2, '0'), '');\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert `Blob` to `ArrayBuffer`.\n * @ja `Blob` ãã `ArrayBuffer` ã¸å¤æ\n *\n * @param blob\n *  - `en` `Blob` instance\n *  - `ja` `Blob` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n * @param options\n */\nexport function blobToBuffer(blob: Blob, options?: BlobReadOptions): Promise<ArrayBuffer> {\n    return readAsArrayBuffer(blob, options);\n}\n\n/**\n * @en Convert `Blob` to `Uint8Array`.\n * @ja `Blob` ãã `Uint8Array` ã¸å¤æ\n *\n * @param blob\n *  - `en` `Blob` instance\n *  - `ja` `Blob` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n * @param options\n */\nexport async function blobToBinary(blob: Blob, options?: BlobReadOptions): Promise<Uint8Array> {\n    return new Uint8Array(await readAsArrayBuffer(blob, options));\n}\n\n/**\n * @en Convert `Blob` to data-URL string.\n * @ja `Blob` ãã data-URL æå­åã¸å¤æ\n *\n * @param blob\n *  - `en` `Blob` instance\n *  - `ja` `Blob` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n * @param options\n */\nexport function blobToDataURL(blob: Blob, options?: BlobReadOptions): Promise<string> {\n    return readAsDataURL(blob, options);\n}\n\n/**\n * @en Convert `Blob` to text string.\n * @ja `Blob` ãããã­ã¹ãã¸å¤æ\n *\n * @param blob\n *  - `en` `Blob` instance\n *  - `ja` `Blob` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n * @param options\n */\nexport function blobToText(blob: Blob, options?: BlobReadOptions & { encoding?: string | null; }): Promise<string> {\n    const opts = options || {};\n    const { encoding } = opts;\n    return readAsText(blob, encoding, opts);\n}\n\n/**\n * @en Convert `Blob` to Base64 string.\n * @ja `Blob` ãã Base64 æå­åã¸å¤æ\n *\n * @param blob\n *  - `en` `Blob` instance\n *  - `ja` `Blob` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n * @param options\n */\nexport async function blobToBase64(blob: Blob, options?: BlobReadOptions): Promise<string> {\n    return queryDataURLContext(await readAsDataURL(blob, options)).data;\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert `ArrayBuffer` to `Blob`.\n * @ja `ArrayBuffer` ãã `Blob` ã«å¤æ\n *\n * @param buffer\n *  - `en` `ArrayBuffer` instance\n *  - `ja` `ArrayBuffer` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type æå­å\n */\nexport function bufferToBlob(buffer: ArrayBuffer, mimeType: string = MimeType.BINARY): Blob {\n    return new Blob([buffer], { type: mimeType });\n}\n\n/**\n * @en Convert `ArrayBuffer` to `Uint8Array`.\n * @ja `ArrayBuffer` ãã `Uint8Array` ã«å¤æ\n *\n * @param buffer\n *  - `en` `ArrayBuffer` instance\n *  - `ja` `ArrayBuffer` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n */\nexport function bufferToBinary(buffer: ArrayBuffer): Uint8Array {\n    return new Uint8Array(buffer);\n}\n\n/**\n * @en Convert `ArrayBuffer` to data-URL string.\n * @ja `ArrayBuffer` ãã data-URL æå­åã«å¤æ\n *\n * @param buffer\n *  - `en` `ArrayBuffer` instance\n *  - `ja` `ArrayBuffer` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type æå­å\n */\nexport function bufferToDataURL(buffer: ArrayBuffer, mimeType: string = MimeType.BINARY): string {\n    return binaryToDataURL(new Uint8Array(buffer), mimeType);\n}\n\n/**\n * @en Convert `ArrayBuffer` to Base64 string.\n * @ja `ArrayBuffer` ãã Base64 æå­åã«å¤æ\n *\n * @param buffer\n *  - `en` `ArrayBuffer` instance\n *  - `ja` `ArrayBuffer` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n */\nexport function bufferToBase64(buffer: ArrayBuffer): string {\n    return binaryToBase64(new Uint8Array(buffer));\n}\n\n/**\n * @en Convert `ArrayBuffer` to text string.\n * @ja `ArrayBuffer` ãããã­ã¹ãã«å¤æ\n *\n * @param buffer\n *  - `en` `ArrayBuffer` instance\n *  - `ja` `ArrayBuffer` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n */\nexport function bufferToText(buffer: ArrayBuffer): string {\n    return binaryToText(new Uint8Array(buffer));\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert `Uint8Array` to `Blob`.\n * @ja `Uint8Array` ãã `Blob` ã«å¤æ\n *\n * @param binary\n *  - `en` `Uint8Array` instance\n *  - `ja` `Uint8Array` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type æå­å\n */\nexport function binaryToBlob(binary: Uint8Array, mimeType: string = MimeType.BINARY): Blob {\n    return new Blob([binary], { type: mimeType });\n}\n\n/**\n * @en Convert `Uint8Array` to `ArrayBuffer`.\n * @ja `Uint8Array` ãã `ArrayBuffer` ã«å¤æ\n *\n * @param binary\n *  - `en` `Uint8Array` instance\n *  - `ja` `Uint8Array` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n */\nexport function binaryToBuffer(binary: Uint8Array): ArrayBuffer {\n    return binary.buffer;\n}\n\n/**\n * @en Convert `Uint8Array` to data-URL string.\n * @ja `Uint8Array` ãã data-URL æå­åã«å¤æ\n *\n * @param binary\n *  - `en` `Uint8Array` instance\n *  - `ja` `Uint8Array` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type æå­å\n */\nexport function binaryToDataURL(binary: Uint8Array, mimeType: string = MimeType.BINARY): string {\n    return `data:${mimeType};base64,${binaryToBase64(binary)}`;\n}\n\n/**\n * @en Convert `Uint8Array` to Base64 string.\n * @ja `Uint8Array` ãã Base64 æå­åã«å¤æ\n *\n * @param binary\n *  - `en` `Uint8Array` instance\n *  - `ja` `Uint8Array` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n */\nexport function binaryToBase64(binary: Uint8Array): string {\n    return Base64.encode(binaryToText(binary));\n}\n\n/**\n * @en Convert `Uint8Array` to text string.\n * @ja `Uint8Array` ãã ãã­ã¹ãã«å¤æ\n *\n * @param binary\n *  - `en` `Uint8Array` instance\n *  - `ja` `Uint8Array` ã¤ã³ã¹ã¿ã³ã¹ãæå®\n */\nexport function binaryToText(binary: Uint8Array): string {\n    return fromBinaryString(binaryToBinaryString(binary));\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert Base64 string to `Blob`.\n * @ja Base64 æå­åãã `Blob` ã«å¤æ\n *\n * @param base64\n *  - `en` Base64 string data\n *  - `ja` Base64 æå­å\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type æå­å\n */\nexport function base64ToBlob(base64: string, mimeType: string = MimeType.BINARY): Blob {\n    return binaryToBlob(base64ToBinary(base64), mimeType);\n}\n\n/**\n * @en Convert Base64 string to `ArrayBuffer`.\n * @ja Base64 æå­åãã `ArrayBuffer` ã«å¤æ\n *\n * @param base64\n *  - `en` Base64 string data\n *  - `ja` Base64 æå­å\n */\nexport function base64ToBuffer(base64: string): ArrayBuffer {\n    return base64ToBinary(base64).buffer;\n}\n\n/**\n * @en Convert Base64 string to `Uint8Array`.\n * @ja Base64 æå­åãã `Uint8Array` ã«å¤æ\n *\n * @param base64\n *  - `en` Base64 string data\n *  - `ja` Base64 æå­å\n */\nexport function base64ToBinary(base64: string): Uint8Array {\n    return binaryStringToBinary(toBinaryString(Base64.decode(base64)));\n}\n\n/**\n * @en Convert Base64 string to data-URL string.\n * @ja Base64 æå­åãã data-URL æå­åã«å¤æ\n *\n * @param base64\n *  - `en` Base64 string data\n *  - `ja` Base64 æå­å\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type æå­å\n */\nexport function base64ToDataURL(base64: string, mimeType: string = MimeType.BINARY): string {\n    return `data:${mimeType};base64,${base64}`;\n}\n\n/**\n * @en Convert Base64 string to text string.\n * @ja  Base64 æå­åãã ãã­ã¹ãã«å¤æ\n *\n * @param base64\n *  - `en` Base64 string data\n *  - `ja` Base64 æå­å\n */\nexport function base64ToText(base64: string): string {\n    return Base64.decode(base64);\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert text string to `Blob`.\n * @ja ãã­ã¹ããã `Blob` ã«å¤æ\n *\n * @param text\n *  - `en` text string data\n *  - `ja` ãã­ã¹ãæå­å\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type æå­å\n */\nexport function textToBlob(text: string, mimeType: string = MimeType.TEXT): Blob {\n    return new Blob([text], { type: mimeType });\n}\n\n/**\n * @en Convert text string to `ArrayBuffer`.\n * @ja ãã­ã¹ããã `ArrayBuffer` ã«å¤æ\n *\n * @param text\n *  - `en` text string data\n *  - `ja` ãã­ã¹ãæå­å\n */\nexport function textToBuffer(text: string): ArrayBuffer {\n    return textToBinary(text).buffer;\n}\n\n/**\n * @en Convert text string to `Uint8Array`.\n * @ja ãã­ã¹ããã `Uint8Array` ã«å¤æ\n *\n * @param text\n *  - `en` text string data\n *  - `ja` ãã­ã¹ãæå­å\n */\nexport function textToBinary(text: string): Uint8Array {\n    return binaryStringToBinary(toBinaryString(text));\n}\n\n/**\n * @en Convert text string to data-URL string.\n * @ja ãã­ã¹ããã data-URL æå­åã«å¤æ\n *\n * @param text\n *  - `en` text string data\n *  - `ja` ãã­ã¹ãæå­å\n * @param mimeType\n *  - `en` mime-type string\n *  - `ja` mime-type æå­å\n */\nexport function textToDataURL(text: string, mimeType: string = MimeType.TEXT): string {\n    const base64 = textToBase64(text);\n    return `data:${mimeType};base64,${base64}`;\n}\n\n/**\n * @en Convert text string to Base64 string.\n * @ja ãã­ã¹ããã Base64 æå­åã«å¤æ\n *\n * @param text\n *  - `en` text string data\n *  - `ja` ãã­ã¹ãæå­å\n */\nexport function textToBase64(text: string): string {\n    return Base64.encode(text);\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Convert data-URL string to `Blob`.\n * @ja data-URL æå­åãã `Blob` ã«å¤æ\n *\n * @param dataURL\n *  - `en` data-URL string data\n *  - `ja` data-URL æå­å\n */\nexport function dataURLToBlob(dataURL: string): Blob {\n    const context = queryDataURLContext(dataURL);\n    if (context.base64) {\n        return base64ToBlob(context.data, context.mimeType || MimeType.BINARY);\n    } else {\n        return textToBlob(decodeURIComponent(context.data), context.mimeType || MimeType.TEXT);\n    }\n}\n\n/**\n * @en Convert data-URL string to `ArrayBuffer`.\n * @ja data-URL æå­åãã `ArrayBuffer` ã«å¤æ\n *\n * @param dataURL\n *  - `en` data-URL string data\n *  - `ja` data-URL æå­å\n */\nexport function dataURLToBuffer(dataURL: string): ArrayBuffer {\n    return dataURLToBinary(dataURL).buffer;\n}\n\n/**\n * @en Convert data-URL string to `Uint8Array`.\n * @ja data-URL æå­åãã `Uint8Array` ã«å¤æ\n *\n * @param dataURL\n *  - `en` data-URL string data\n *  - `ja` data-URL æå­å\n */\nexport function dataURLToBinary(dataURL: string): Uint8Array {\n    return base64ToBinary(dataURLToBase64(dataURL));\n}\n\n/**\n * @en Convert data-URL string to text string.\n * @ja data-URL æå­åãããã­ã¹ãã«å¤æ\n *\n * @param dataURL\n *  - `en` data-URL string data\n *  - `ja` data-URL æå­å\n */\nexport function dataURLToText(dataURL: string): string {\n    return Base64.decode(dataURLToBase64(dataURL));\n}\n\n/**\n * @en Convert data-URL string to Base64 string.\n * @ja data-URL æå­åãã Base64 æå­åã«å¤æ\n *\n * @param dataURL\n *  - `en` data-URL string data\n *  - `ja` data-URL æå­å\n */\nexport function dataURLToBase64(dataURL: string): string {\n    const context = queryDataURLContext(dataURL);\n    if (context.base64) {\n        return context.data;\n    } else {\n        return Base64.encode(decodeURIComponent(context.data));\n    }\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Serializable data type list.\n * @ja ã·ãªã¢ã©ã¤ãºå¯è½ãªãã¼ã¿åä¸è¦§\n */\nexport interface Serializable {\n    string: string;\n    number: number;\n    boolean: boolean;\n    object: object;\n    buffer: ArrayBuffer;\n    binary: Uint8Array;\n    blob: Blob;\n}\n\nexport type SerializableDataTypes = Types<Serializable>;\nexport type SerializableInputDataTypes = SerializableDataTypes | null | undefined;\nexport type SerializableKeys = Keys<Serializable>;\nexport type SerializableCastable = Omit<Serializable, 'buffer' | 'binary' | 'blob'>;\nexport type SerializableCastableTypes = Types<SerializableCastable>;\nexport type SerializableReturnType<T extends SerializableCastableTypes> = TypeToKey<SerializableCastable, T> extends never ? never : T | null | undefined;\n\n/**\n * @en Deserializable options interface.\n * @ja ãã·ãªã¢ã©ã¤ãºã«ä½¿ç¨ãããªãã·ã§ã³\n */\nexport interface DeserializeOptions<T extends Serializable = Serializable, K extends Keys<T> = Keys<T>> extends Cancelable {\n    /** [[SerializableKeys]] */\n    dataType?: K;\n}\n\n/**\n * @en Serialize data.\n * @ja ãã¼ã¿ã·ãªã¢ã©ã¤ãº\n *\n * @param data input\n * @param options blob convert options\n */\nexport async function serialize<T extends SerializableInputDataTypes>(data: T, options?: BlobReadOptions): Promise<string> {\n    const { cancel } = options || {};\n    await cc(cancel);\n    if (null == data) {\n        return String(data);\n    } else if (data instanceof ArrayBuffer) {\n        return bufferToDataURL(data);\n    } else if (data instanceof Uint8Array) {\n        return binaryToDataURL(data);\n    } else if (data instanceof Blob) {\n        return blobToDataURL(data, options);\n    } else {\n        return fromTypedData(data) as string;\n    }\n}\n\n/**\n * @en Deserialize data.\n * @ja ãã¼ã¿ã®å¾©å\n *\n * @param value input string or undefined.\n * @param options deserialize options\n */\nexport function deserialize<T extends SerializableCastableTypes = SerializableCastableTypes>(\n    value: string | undefined, options?: DeserializeOptions<Serializable, never>\n): Promise<SerializableReturnType<T>>;\n\n/**\n * @en Deserialize data.\n * @ja ãã¼ã¿ã®å¾©å\n *\n * @param value input string or undefined.\n * @param options deserialize options\n */\nexport function deserialize<T extends SerializableKeys>(value: string | undefined, options: DeserializeOptions<Serializable, T>): Promise<Serializable[T] | null | undefined>;\n\nexport async function deserialize(value: string | undefined, options?: DeserializeOptions): Promise<SerializableDataTypes | null | undefined> {\n    const { dataType, cancel } = options || {};\n    await cc(cancel);\n\n    const data = restoreNil(toTypedData(value));\n    switch (dataType) {\n        case 'string':\n            return fromTypedData(data);\n        case 'number':\n            return Number(data);\n        case 'boolean':\n            return Boolean(data);\n        case 'object':\n            return Object(data);\n        case 'buffer':\n            return dataURLToBuffer(fromTypedData(data) as string);\n        case 'binary':\n            return dataURLToBinary(fromTypedData(data) as string);\n        case 'blob':\n            return dataURLToBlob(fromTypedData(data) as string);\n        default:\n            return data;\n    }\n}\n","import { URL } from './ssr';\n\n/** @internal */ const _blobMap = new WeakMap<Blob, string>();\n/** @internal */ const _urlSet  = new Set<string>();\n\n/**\n * @en `Blob URL` utility for automatic memory manegement.\n * @ja ã¡ã¢ãªèªåç®¡çãè¡ã `Blob URL` ã¦ã¼ãã£ãªãã£\n */\nexport class BlobURL {\n    /**\n     * @en Create `Blob URL` from instances.\n     * @ja ã¤ã³ã¹ã¿ã³ã¹ãæå®ãã¦ `Blob URL` ã®æ§ç¯\n     */\n    public static create(...blobs: Blob[]): void {\n        for (const b of blobs) {\n            const cache = _blobMap.get(b);\n            if (cache) {\n                continue;\n            }\n            const url = URL.createObjectURL(b);\n            _blobMap.set(b, url);\n            _urlSet.add(url);\n        }\n    }\n\n    /**\n     * @en Clear all `Blob URL` cache.\n     * @ja ãã¹ã¦ã® `Blob URL` ã­ã£ãã·ã¥ãç ´æ£\n     */\n    public static clear(): void {\n        for (const url of _urlSet) {\n            URL.revokeObjectURL(url);\n        }\n        _urlSet.clear();\n    }\n\n    /**\n     * @en Get `Blob URL` from instance.\n     * @ja ã¤ã³ã¹ã¿ã³ã¹ãæå®ãã¦ `Blob URL` ã®åå¾\n     */\n    public static get(blob: Blob): string {\n        const cache = _blobMap.get(blob);\n        if (cache) {\n            return cache;\n        }\n        const url = URL.createObjectURL(blob);\n        _blobMap.set(blob, url);\n        _urlSet.add(url);\n        return url;\n    }\n\n    /**\n     * @en Check `Blob URL` is available from instance.\n     * @ja ã¤ã³ã¹ã¿ã³ã¹ãæå®ãã¦ `Blob URL` ãæå¹åå¤å®\n     */\n    public static has(blob: Blob): boolean {\n        return _blobMap.has(blob);\n    }\n\n    /**\n     * @en Revoke `Blob URL` from instances.\n     * @ja ã¤ã³ã¹ã¿ã³ã¹ãæå®ãã¦ `Blob URL` ãç¡å¹å\n     */\n    public static revoke(...blobs: Blob[]): void {\n        for (const b of blobs) {\n            const url = _blobMap.get(b);\n            if (url) {\n                URL.revokeObjectURL(url);\n                _blobMap.delete(b);\n                _urlSet.delete(url);\n            }\n        }\n    }\n}\n","/* eslint-disable\n    @typescript-eslint/no-namespace,\n    @typescript-eslint/no-unused-vars,\n    @typescript-eslint/restrict-plus-operands,\n */\n\nnamespace CDP_DECLARE {\n\n    const enum LOCAL_CODE_BASE {\n        AJAX = CDP_KNOWN_MODULE.AJAX * LOCAL_CODE_RANGE_GUIDE.FUNCTION,\n    }\n\n    /**\n     * @en Extends error code definitions.\n     * @ja æ¡å¼µéã¨ã©ã¼ã³ã¼ãå®ç¾©\n     */\n    export enum RESULT_CODE {\n        AJAX_DECLARE        = RESULT_CODE_BASE.DECLARE,\n        ERROR_AJAX_RESPONSE = DECLARE_ERROR_CODE(RESULT_CODE_BASE.CDP, LOCAL_CODE_BASE.AJAX + 1, 'network error.'),\n        ERROR_AJAX_TIMEOUT  = DECLARE_ERROR_CODE(RESULT_CODE_BASE.CDP, LOCAL_CODE_BASE.AJAX + 2, 'request timeout.'),\n    }\n}\n","import { safe } from '@cdp/core-utils';\n\n/** @internal */ export const FormData        = safe(globalThis.FormData);\n/** @internal */ export const Headers         = safe(globalThis.Headers);\n/** @internal */ export const AbortController = safe(globalThis.AbortController);\n/** @internal */ export const URLSearchParams = safe(globalThis.URLSearchParams);\n/** @internal */ export const XMLHttpRequest  = safe(globalThis.XMLHttpRequest);\n/** @internal */ export const fetch           = safe(globalThis.fetch);\n","import { isNumber } from '@cdp/core-utils';\n\n/** @internal */ let _timeout: number | undefined;\n\nexport const settings = {\n    get timeout(): number | undefined {\n        return _timeout;\n    },\n    set timeout(value: number | undefined) {\n        _timeout = (isNumber(value) && 0 <= value) ? value : undefined;\n    },\n};\n","import { PlainObject, isFunction } from '@cdp/core-utils';\nimport { CancelToken } from '@cdp/promise';\nimport { RESULT_CODE, makeResult } from '@cdp/result';\nimport { Base64 } from '@cdp/binary';\nimport {\n    AjaxDataTypes,\n    AjaxOptions,\n    AjaxResult,\n} from './interfaces';\nimport {\n    FormData,\n    Headers,\n    AbortController,\n    URLSearchParams,\n    fetch,\n} from './ssr';\nimport { settings } from './settings';\n\n/** @internal */\nexport type AjaxHeaderOptions = Pick<AjaxOptions<AjaxDataTypes>, 'headers' | 'method' | 'contentType' | 'dataType' | 'mode' | 'body' | 'username' | 'password'>;\n\n/** @internal */\nconst _acceptHeaderMap = {\n    text: 'text/plain, text/html, application/xml; q=0.8, text/xml; q=0.8, */*; q=0.01',\n    json: 'application/json, text/javascript, */*; q=0.01',\n};\n\n/**\n * @en Setup `headers` from options parameter.\n * @ja ãªãã·ã§ã³ãã `headers` ãè¨­å®\n *\n * @internal\n */\nexport function setupHeaders(options: AjaxHeaderOptions): Headers {\n    const headers = new Headers(options.headers);\n    const { method, contentType, dataType, mode, body, username, password } = options;\n\n    // Content-Type\n    if ('POST' === method || 'PUT' === method || 'PATCH' === method) {\n        /*\n         * fetch() ã®å ´å, FormData ãèªåè§£éãããã, æå®ãããå ´åã¯åé¤\n         * https://stackoverflow.com/questions/35192841/fetch-post-with-multipart-form-data\n         * https://muffinman.io/uploading-files-using-fetch-multipart-form-data/\n         */\n        if (headers.get('Content-Type') && body instanceof FormData) {\n            headers.delete('Content-Type');\n        } else if (!headers.get('Content-Type')) {\n            if (null == contentType && 'json' === dataType as AjaxDataTypes) {\n                headers.set('Content-Type', 'application/json; charset=UTF-8');\n            } else if (null != contentType) {\n                headers.set('Content-Type', contentType);\n            }\n        }\n    }\n\n    // Accept\n    if (!headers.get('Accept')) {\n        headers.set('Accept', _acceptHeaderMap[dataType as AjaxDataTypes] || '*/*');\n    }\n\n    // X-Requested-With\n    if ('cors' !== mode && !headers.get('X-Requested-With')) {\n        headers.set('X-Requested-With', 'XMLHttpRequest');\n    }\n\n    // Basic Authorization\n    if (null != username && !headers.get('Authorization')) {\n        headers.set('Authorization', `Basic ${Base64.encode(`${username}:${password || ''}`)}`);\n    }\n\n    return headers;\n}\n\n/** @internal ensure string value */\nfunction ensureParamValue(prop: unknown): string {\n    const value = isFunction(prop) ? prop() : prop;\n    return undefined !== value ? String(value) : '';\n}\n\n/**\n * @en Convert `PlainObject` to query strings.\n * @ja `PlainObject` ãã¯ã¨ãªã¹ããªã³ã°ã«å¤æ\n */\nexport function toQueryStrings(data: PlainObject): string {\n    const params: string[] = [];\n    for (const key of Object.keys(data)) {\n        const value = ensureParamValue(data[key]);\n        if (value) {\n            params.push(`${encodeURIComponent(key)}=${encodeURIComponent(value)}`);\n        }\n    }\n    return params.join('&');\n}\n\n/**\n * @en Convert `PlainObject` to Ajax parameters object.\n * @ja `PlainObject` ã Ajax ãã©ã¡ã¼ã¿ãªãã¸ã§ã¯ãã«å¤æ\n */\nexport function toAjaxParams(data: PlainObject): Record<string, string> {\n    const params: Record<string, string> = {};\n    for (const key of Object.keys(data)) {\n        const value = ensureParamValue(data[key]);\n        if (value) {\n            params[key] = value;\n        }\n    }\n    return params;\n}\n\n/**\n * @en Perform an asynchronous HTTP (Ajax) request.\n * @ja HTTP (Ajax)ãªã¯ã¨ã¹ãã®éä¿¡\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxãªã¯ã¨ã¹ããéä¿¡ããURLãæå®\n * @param options\n *  - `en` Ajax request settings.\n *  - `ja` Ajaxãªã¯ã¨ã¹ãè¨­å®\n */\nasync function ajax<T extends AjaxDataTypes | object = 'response'>(url: string, options?: AjaxOptions<T>): Promise<AjaxResult<T>> {\n    const controller = new AbortController();\n    const abort = (): void => controller.abort();\n\n    const opts = Object.assign({\n        method: 'GET',\n        dataType: 'response',\n        timeout: settings.timeout,\n    }, options, {\n        signal: controller.signal, // force override\n    });\n\n    const { cancel: originalToken, timeout } = opts;\n\n    // cancellation\n    if (originalToken) {\n        if (originalToken.requested) {\n            throw originalToken.reason;\n        }\n        originalToken.register(abort);\n    }\n\n    const source = CancelToken.source(originalToken as CancelToken);\n    const { token } = source;\n    token.register(abort);\n\n    // timeout\n    if (timeout) {\n        setTimeout(() => source.cancel(makeResult(RESULT_CODE.ERROR_AJAX_TIMEOUT, 'request timeout')), timeout);\n    }\n\n    // normalize\n    opts.method = opts.method.toUpperCase();\n\n    // header\n    opts.headers = setupHeaders(opts);\n\n    // parse param\n    const { method, data, dataType } = opts;\n    if (null != data) {\n        if (('GET' === method || 'HEAD' === method) && !url.includes('?')) {\n            url += `?${toQueryStrings(data)}`;\n        } else if (null == opts.body) {\n            opts.body = new URLSearchParams(toAjaxParams(data));\n        }\n    }\n\n    // execute\n    const response = await Promise.resolve(fetch(url, opts), token);\n    if ('response' === dataType) {\n        return response as AjaxResult<T>;\n    } else if (!response.ok) {\n        throw makeResult(RESULT_CODE.ERROR_AJAX_RESPONSE, response.statusText, response);\n    } else if ('stream' === dataType) {\n        const length = Number(response.headers.get('content-length'));\n        const stream = response.body as ReadableStream<Uint8Array>;\n        stream['length'] = length;\n        return stream as AjaxResult<T>;\n    } else {\n        return Promise.resolve(response[dataType as Exclude<AjaxDataTypes, 'response' | 'stream'>](), token);\n    }\n}\n\najax.settings = settings;\n\nexport { ajax };\n","import { PlainObject } from '@cdp/core-utils';\nimport { RESULT_CODE, makeResult } from '@cdp/result';\nimport {\n    AjaxDataTypes,\n    AjaxOptions,\n    AjaxRequestOptions,\n    AjaxGetRequestShortcutOptions,\n    AjaxResult,\n} from './interfaces';\nimport {\n    ajax,\n    toQueryStrings,\n    setupHeaders,\n} from './core';\nimport { XMLHttpRequest } from './ssr';\n\n/** @internal */\nfunction ensureDataType(dataType?: AjaxDataTypes): AjaxDataTypes {\n    return dataType || 'json';\n}\n\n/**\n * @en `GET` request shortcut.\n * @ja `GET` ãªã¯ã¨ã¹ãã·ã§ã¼ãã«ãã\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxãªã¯ã¨ã¹ããéä¿¡ããURLãæå®\n * @param data\n *  - `en` Data to be sent to the server.\n *  - `ja` ãµã¼ãã¼ã«éä¿¡ããããã¼ã¿.\n * @param dataType\n *  - `en` Data to be sent to the server.\n *  - `ja` ãµã¼ãã¼ããè¿ãããæå¾ãããã¼ã¿ã®åãæå®\n * @param options\n *  - `en` request settings.\n *  - `ja` ãªã¯ã¨ã¹ãè¨­å®\n */\nexport function get<T extends AjaxDataTypes | object = 'json'>(\n    url: string,\n    data?: PlainObject,\n    dataType?: T extends AjaxDataTypes ? T : 'json',\n    options?: AjaxRequestOptions\n): Promise<AjaxResult<T>> {\n    return ajax(url, { ...options, method: 'GET', data, dataType: ensureDataType(dataType) } as AjaxOptions<T>);\n}\n\n/**\n * @en `GET` text request shortcut.\n * @ja `GET` ãã­ã¹ããªã¯ã¨ã¹ãã·ã§ã¼ãã«ãã\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxãªã¯ã¨ã¹ããéä¿¡ããURLãæå®\n * @param options\n *  - `en` request settings.\n *  - `ja` ãªã¯ã¨ã¹ãè¨­å®\n */\nexport function text(url: string, options?: AjaxGetRequestShortcutOptions): Promise<AjaxResult<'text'>> {\n    return get(url, undefined, 'text', options);\n}\n\n/**\n * @en `GET` JSON request shortcut.\n * @ja `GET` JSON ãªã¯ã¨ã¹ãã·ã§ã¼ãã«ãã\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxãªã¯ã¨ã¹ããéä¿¡ããURLãæå®\n * @param options\n *  - `en` request settings.\n *  - `ja` ãªã¯ã¨ã¹ãè¨­å®\n */\nexport function json<T extends 'json' | object = 'json'>(url: string, options?: AjaxGetRequestShortcutOptions): Promise<AjaxResult<T>> {\n    return get<T>(url, undefined, ('json' as T extends AjaxDataTypes ? T : 'json'), options);\n}\n\n/**\n * @en `GET` Blob request shortcut.\n * @ja `GET` Blob ãªã¯ã¨ã¹ãã·ã§ã¼ãã«ãã\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxãªã¯ã¨ã¹ããéä¿¡ããURLãæå®\n * @param options\n *  - `en` request settings.\n *  - `ja` ãªã¯ã¨ã¹ãè¨­å®\n */\nexport function blob(url: string, options?: AjaxGetRequestShortcutOptions): Promise<AjaxResult<'blob'>> {\n    return get(url, undefined, 'blob', options);\n}\n\n/**\n * @en `POST` request shortcut.\n * @ja `POST` ãªã¯ã¨ã¹ãã·ã§ã¼ãã«ãã\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxãªã¯ã¨ã¹ããéä¿¡ããURLãæå®\n * @param data\n *  - `en` Data to be sent to the server.\n *  - `ja` ãµã¼ãã¼ã«éä¿¡ããããã¼ã¿.\n * @param dataType\n *  - `en` The type of data that you're expecting back from the server.\n *  - `ja` Ajaxãªã¯ã¨ã¹ããéä¿¡ããURLãæå®\n * @param options\n *  - `en` request settings.\n *  - `ja` ãªã¯ã¨ã¹ãè¨­å®\n */\nexport function post<T extends AjaxDataTypes | object = 'json'>(\n    url: string,\n    data: PlainObject,\n    dataType?: T extends AjaxDataTypes ? T : 'json',\n    options?: AjaxRequestOptions\n): Promise<AjaxResult<T>> {\n    return ajax(url, { ...options, method: 'POST', data, dataType: ensureDataType(dataType) } as AjaxOptions<T>);\n}\n\n/**\n * @en Synchronous `GET` request for resource access. <br>\n *     Many browsers have deprecated synchronous XHR support on the main thread entirely.\n * @ja ãªã½ã¼ã¹åå¾ã®ããã® åæ `GET` ãªã¯ã¨ã¹ã. <br>\n *     å¤ãã®ãã©ã¦ã¶ã§ã¯ã¡ã¤ã³ã¹ã¬ããã«ãããåæçãª XHR ã®å¯¾å¿ãå¨é¢çã«éæ¨å¥¨ã¨ãã¦ããã®ã§ç©æ¥µä½¿ç¨ã¯é¿ãããã¨.\n *\n * @param url\n *  - `en` A string containing the URL to which the request is sent.\n *  - `ja` Ajaxãªã¯ã¨ã¹ããéä¿¡ããURLãæå®\n * @param dataType\n *  - `en` The type of data that you're expecting back from the server.\n *  - `ja` Ajaxãªã¯ã¨ã¹ããéä¿¡ããURLãæå®\n * @param data\n *  - `en` Data to be sent to the server.\n *  - `ja` ãµã¼ãã¼ã«éä¿¡ããããã¼ã¿.\n */\nexport function resource<T extends 'text' | 'json' | object = 'json'>(\n    url: string,\n    dataType?: T extends 'text' | 'json' ? T : 'json',\n    data?: PlainObject,\n): AjaxResult<T> {\n    const xhr = new XMLHttpRequest();\n\n    if (null != data && !url.includes('?')) {\n        url += `?${toQueryStrings(data)}`;\n    }\n\n    // synchronous\n    xhr.open('GET', url, false);\n\n    const type = ensureDataType(dataType);\n    const headers = setupHeaders({ method: 'GET', dataType: type });\n    headers.forEach((value, key) => {\n        xhr.setRequestHeader(key, value);\n    });\n\n    xhr.send(null);\n    if (!(200 <= xhr.status && xhr.status < 300)) {\n        throw makeResult(RESULT_CODE.ERROR_AJAX_RESPONSE, xhr.statusText, xhr);\n    }\n\n    return 'json' === type ? JSON.parse(xhr.response) : xhr.response;\n}\n","import {\n    isFunction,\n    isString,\n    className,\n    safe,\n} from '@cdp/core-utils';\n\n/**\n * @en [[InlineWorker]] source type definition.\n * @ja [[InlineWorker]] ã«æå®å¯è½ãªã½ã¼ã¹åå®ç¾©\n */\nexport type InlienWorkerSource = ((self: Worker) => unknown) | string;\n\n/** @internal */ const URL    = safe(globalThis.URL);\n/** @internal */ const Worker = safe(globalThis.Worker);\n/** @internal */ const Blob   = safe(globalThis.Blob);\n\n/** @internal */\nfunction createWorkerContext(src: InlienWorkerSource): string {\n    if (!(isFunction(src) || isString(src))) {\n        throw new TypeError(`${className(src)} is not a function or string.`);\n    }\n    return URL.createObjectURL(new Blob([isFunction(src) ? `(${src.toString()})(self);` : src], { type: 'application/javascript' }));\n}\n\n/**\n * @en Specified `Worker` class which doesn't require a script file.\n * @ja ã¹ã¯ãªãããã¡ã¤ã«ãå¿è¦ã¨ããªã `Worker` ã¯ã©ã¹\n */\nexport class InlineWorker extends Worker {\n    /** @internal */\n    private _context: string;\n\n    /**\n     * constructor\n     *\n     * @param src\n     *  - `en` source function or script body.\n     *  - `ja` å®è¡é¢æ°ã¾ãã¯ã¹ã¯ãªããå®ä½\n     * @param options\n     *  - `en` worker options.\n     *  - `ja` Worker ãªãã·ã§ã³\n     */\n    constructor(src: InlienWorkerSource, options?: WorkerOptions) {\n        const context = createWorkerContext(src);\n        super(context, options);\n        this._context = context;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// override: Worker\n\n    /**\n     * @en For BLOB release. When calling `close ()` in the Worker, call this method as well.\n     * @ja BLOB è§£æ¾ç¨. Worker åã§ `close()` ãå¼ã¶å ´å, æ¬ã¡ã½ãããã³ã¼ã«ãããã¨.\n     */\n    terminate(): void {\n        super.terminate();\n        URL.revokeObjectURL(this._context);\n    }\n}\n","import { UnknownFunction } from '@cdp/core-utils';\nimport { Cancelable, CancelToken } from '@cdp/promise';\nimport { InlineWorker } from './inine-worker';\n\n/**\n * @en Thread options\n * @en ã¹ã¬ãããªãã·ã§ã³\n */\nexport interface ThreadOptions<T extends UnknownFunction> extends Cancelable, WorkerOptions {\n    args?: Parameters<T>;\n}\n\n/**\n * @en Ensure execution in worker thread.\n * @ja ã¯ã¼ã«ã¼ã¹ã¬ããåã§å®è¡ãä¿è¨¼\n *\n * @example <br>\n *\n * ```ts\n * const exec = (arg1: number, arg2: string) => {\n *    // this scope is worker scope. you cannot use closure access.\n *    const param = {...};\n *    const method = (p) => {...};\n *    // you can access arguments from options.\n *    console.log(arg1); // '1'\n *    console.log(arg2); // 'test'\n *    :\n *    return method(param);\n * };\n *\n * const arg1 = 1;\n * const arg2 = 'test';\n * const result = await thread(exec, { args: [arg1, arg2] });\n * ```\n *\n * @param executor\n *  - `en` implement as function scope.\n *  - `ja` é¢æ°ã¹ã³ã¼ãã¨ãã¦å®è£\n * @param options\n *  - `en` thread options\n *  - `ja` ã¹ã¬ãããªãã·ã§ã³\n */\nexport function thread<T, U>(executor: (...args: U[]) => T | Promise<T>, options?: ThreadOptions<typeof executor>): Promise<T> {\n    const { cancel: originalToken, args } = Object.assign({ args: [] }, options);\n\n    // already cancel\n    if (originalToken?.requested) {\n        throw originalToken.reason;\n    }\n\n    const exec = `(self => {\n        self.addEventListener('message', async ({ data }) => {\n            try {\n                const result = await (${executor.toString()})(...data);\n                self.postMessage(result);\n            } catch (e) {\n                setTimeout(function() { throw e; });\n            }\n        });\n    })(self);`;\n\n    const worker = new InlineWorker(exec, options);\n\n    const abort = (): void => worker.terminate();\n    originalToken?.register(abort);\n    const { token } = CancelToken.source(originalToken as CancelToken);\n\n    const promise = new Promise((resolve, reject) => {\n        worker.onerror = ev => {\n            ev.preventDefault();\n            reject(ev);\n            worker.terminate();\n        };\n        worker.onmessage = ev => {\n            resolve(ev.data);\n            worker.terminate();\n        };\n    }, token);\n\n    worker.postMessage(args);\n\n    return promise as Promise<T>;\n}\n"]}