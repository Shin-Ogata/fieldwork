{"version":3,"names":["RESULT_CODE","CDP_DECLARE","DECLARE_ERROR_CODE","getComputedStyle","safe","globalThis","getTransformMatrixValues","el","style","m11","m22","m33","m41","m42","m43","DOMMatrixReadOnly","transform","translateX","translateY","translateZ","scaleX","scaleY","scaleZ","setTransformTransition","prop","msec","timingFunction","animation","setProperty","clearTransition","removeProperty","post","noop","styleCore","styleButton","_config","NAMESPACE","SCROLL_MAP_CLASS","INACTIVE_CLASS","RECYCLE_CLASS","LISTITEM_BASE_CLASS","DATA_PAGE_INDEX","DATA_ITEM_INDEX","ListViewGlobalConfig","newConfig","ns","scrollmap","inactive","recycle","itembase","datapage","dataitem","undefined","Object","assign","ensureNewConfig","key","keys","ItemProfile","_owner","_height","_initializer","_info","_index","_pageIndex","_offset","_$base","_instance","constructor","owner","height","initializer","this","index","updateIndex","pageIndex","updatePageIndex","offset","updateOffset","info","activate","prepareBaseElement","options","item","css","hide","deactivate","remove","addClass","refresh","render","isActive","updateHeight","newHeight","delta","updateScrollMapHeight","reflectAll","updateProfiles","resetDepth","baseDepth","$base","$recycle","findRecycleElements","first","itemTagName","console","length","removeAttr","removeClass","$","$scrollMap","append","attr","String","enableTransformOffset","top","parseInt","PageProfile","_items","_status","status","push","normalize","enableAll","every","getItem","at","getItemFirst","getItemLast","GroupProfile","_id","_parent","_children","_expanded","id","isExpanded","parent","children","getNextItemIndex","withActiveChildren","items","queryOperationTarget","addItem","group","context","Math","trunc","_addItem","update","addChildren","target","Array","isArray","child","setParent","hasChildren","expand","statusScope","collapse","delay","animationDuration","removeItem","ensureVisible","callback","scrollPos","toggle","register","insertTo","makeResult","ERROR_UI_LISTVIEW_INVALID_PARAM","toHelpString","preprocess","restore","concat","slice","newStatus","operation","findTargets","_properties","Symbol","ListItemView","View","_properties$3","super","$el","off","setElement","stopListening","hasChildNode","ElementScroller","_$target","_$scrollMap","_options","_scrollStopTrigger","_scrollDuration","map","timer","clearTimeout","setTimeout","trigger","CustomEvent","bubbles","cancelable","on","TYPE","getFactory","factory","defineProperties","type","configurable","writable","enumerable","value","pos","scrollTop","posMax","max","scrollTo","animate","time","Promise","resolve","enableAnimation","destroy","_defaultOpts","scrollerFactory","enableHiddenPage","scrollMapRefreshInterval","scrollRefreshDistance","pagePrepareCount","pagePreloadCount","removeItemWithTransition","useDummyInactiveScrollMap","_$invalid","verify","x","ERROR_UI_LISTVIEW_INVALID_INITIALIZATION","ListCore","_$root","_$map","_mapHeight","_scroller","_active","_settings","_scrollEventHandler","_scrollStopEventHandler","_baseHeight","_pages","_lastActivePageContext","from","to","_backup","onScroll","onScrollStop","initialize","$root","ensureOverflowY","overflowY","ensureScrollMap","mapClass","$map","find","createScroller","setBaseHeight","setScrollerCondition","resetScrollerCondition","release","setActiveState","active","treatScrollPosition","useDummyMap","display","prepareInactiveMap","$target","scrollMapHeight","i","n","last","isInitialized","deltaHeight","addTail","it","splice","clearPage","arg2","arg3","_removeItemRandomly","_removeItemContinuously","_queryRemoveItemsContext","indexes","removed","transition","idx","current","scrollPosMax","_updateWithRemoveItemsContext","profileUpdate","setupScrollMapTransition","size","_","sort","lhs","rhs","transitionEnd","getItemInfo","parser","hasClass","Number","NaN","Event","isNaN","targets","currentPageIndex","getPageIndex","highPriorityIndex","storeNextPageState","abs","searchCount","beginIndex","endIndex","overflowPrev","overflowNext","page","filter","action","pageCurrent","assignPage","rebuild","scrollerType","setScrollHandler","handler","method","setScrollStopHandler","partialOK","setTop","currentScope","targetScope","backup","hasBackup","clearBackup","getBackupData","setBackupData","data","scrollMapSize","lastPage","getLastPage","validRange","candidate","floor","basePage","nextItemIndex","asigneeItems","workPage","newPage","$parent","$inactiveMap","$listItemViews","clone","element","ListView","_properties$2","initialHeight","ExpandCore","_mapGroups","_aryTopGroups","newGroup","luid","getGroup","registerTopGroup","topGroup","lastGroup","getTopGroups","expandAll","promisies","all","collapseAll","isExpanding","isStatusIn","isCollapsing","isSwitching","statusAddRef","statusRelease","executor","tops","ExpandableListItemView","_properties$1","ExpandableListView","expandContext"],"sources":["cdp:///@cdp/ui-components/ui-utils/result-code-defs.ts","cdp:///@cdp/ui-components/ui-utils/ssr.ts","cdp:///@cdp/ui-components/ui-utils/css/misc.ts","cdp:///@cdp/ui-components/ui-forms/index.ts","cdp:///@cdp/ui-components/ui-listview/result-code-defs.ts","cdp:///@cdp/ui-components/ui-listview/global-config.ts","cdp:///@cdp/ui-components/ui-listview/profile/item.ts","cdp:///@cdp/ui-components/ui-listview/profile/page.ts","cdp:///@cdp/ui-components/ui-listview/profile/group.ts","cdp:///@cdp/ui-components/ui-listview/list-item-view.ts","cdp:///@cdp/ui-components/ui-listview/core/element-scroller.ts","cdp:///@cdp/ui-components/ui-listview/core/list.ts","cdp:///@cdp/ui-components/ui-listview/list-view.ts","cdp:///@cdp/ui-components/ui-listview/expandable-list-item-view.ts","cdp:///@cdp/ui-components/ui-listview/core/expand.ts","cdp:///@cdp/ui-components/ui-listview/expandable-list-view.ts"],"sourcesContent":["/* eslint-disable\n    @typescript-eslint/no-namespace,\n    @typescript-eslint/no-unused-vars,\n */\n\nnamespace CDP_DECLARE {\n\n    export const enum CDP_KNOWN_UI_MODULE {\n        /** `@cdp/ui-utils` */\n        UTILS     = 1,\n        /** `@cdp/ui-listview` */\n        LISTVIEW  = 2,\n        /** offset for unknown ui-module */\n        OFFSET,\n    }\n\n    const enum LOCAL_CODE_BASE {\n        UI_UTILS = (CDP_KNOWN_MODULE.OFFSET + CDP_KNOWN_UI_MODULE.UTILS) * LOCAL_CODE_RANGE_GUIDE.FUNCTION,\n    }\n\n    /**\n     * @en Extends error code definitions.\n     * @ja 拡張エラーコード定義\n     */\n    export enum RESULT_CODE {\n        UI_UTILS_DECLARE = RESULT_CODE_BASE.DECLARE,\n        ERROR_UI_UTILS_FATAL = DECLARE_ERROR_CODE(RESULT_CODE_BASE.CDP, LOCAL_CODE_BASE.UI_UTILS + 1, 'UI utils something wrong.'),\n    }\n}\n","import { safe } from '@cdp/runtime';\n\n/** @internal */ export const getComputedStyle = safe(globalThis.getComputedStyle);\n","import { getComputedStyle } from '../ssr';\n\n/**\n * @en CSS vendor prefix string definition.\n * @ja CSS ベンダープリフィックス文字列定義\n */\nexport const cssPrefixes = ['-webkit-', '-moz-', '-ms-', '-o-', ''];\n\n/**\n * @en Stores the value specified in css `transform(3d)`.\n * @ja css `transform(3d)` に指定される値を格納\n */\nexport interface TransformMatrixValues {\n    translateX: number;\n    translateY: number;\n    translateZ: number;\n    scaleX: number;\n    scaleY: number;\n    scaleZ: number;\n}\n\n/**\n * @en Get the value of the transform matrix specified in `Element`.\n * @ja `Element` に指定された transform 行列の値を取得\n *\n * @param el\n *  - `en` target `Element` instance\n *  - `ja` 対象 `Element` インスタンス\n */\nexport const getTransformMatrixValues = (el: Element): TransformMatrixValues => {\n    const style = getComputedStyle(el);\n    const { m11, m22, m33, m41, m42, m43 } = new DOMMatrixReadOnly(style.transform);\n    return {\n        translateX: m41,\n        translateY: m42,\n        translateZ: m43,\n        scaleX: m11,\n        scaleY: m22,\n        scaleZ: m33,\n    };\n};\n\n/**\n * @en Setting property conversion animation using css transition for specified element.\n * @ja 指定要素に対して css transition を用いたプロパティ変換アニメーションの設定\n *\n * @param el\n *  - `en` target `HTMLElement` instance\n *  - `ja` 対象 `HTMLElement` インスタンス\n * @param prop\n *  - `en` target property name [ex: height]\n *  - `ja` 対象プロパティ名 [ex: height]\n * @param msec\n *  - `en` animation duration [msec]\n *  - `ja` アニメーション時間 [msec]\n * @param el\n *  - `en` timing function name [default: ease]\n *  - `ja` タイミング関数名 [default: ease]\n */\nexport const setTransformTransition = (el: HTMLElement, prop: string, msec: number, timingFunction = 'ease'): void => {\n    const animation = `${(msec / 1000)}s ${timingFunction}`;\n    el.style.setProperty('transition', `${prop} ${animation}, transform ${animation}`);\n};\n\n\n/**\n * @en Clear css transition settings for specified element.\n * @ja 指定要素の css transition 設定を解除\n *\n * @param el\n *  - `en` target `HTMLElement` instance\n *  - `ja` 対象 `HTMLElement` インスタンス\n */\nexport const clearTransition = (el: HTMLElement): void => {\n    el.style.removeProperty('transition');\n};\n","export const UI_FORMS_STATUS = 'UNDER CONSTRUCTION';\n\nimport { noop, post } from '@cdp/runtime';\n\nimport styleCore from '@css/structure.css' with { type: 'css' };\nimport styleButton from '@css/structure-button.css' with { type: 'css' };\n\nvoid post(noop(styleCore, styleButton));\n","/* eslint-disable\n    @typescript-eslint/no-namespace,\n    @typescript-eslint/no-unused-vars,\n */\n\nnamespace CDP_DECLARE {\n\n    const enum LOCAL_CODE_BASE {\n        UI_LISTVIEW = (CDP_KNOWN_MODULE.OFFSET + CDP_KNOWN_UI_MODULE.LISTVIEW) * LOCAL_CODE_RANGE_GUIDE.FUNCTION,\n    }\n\n    /**\n     * @en Extends error code definitions.\n     * @ja 拡張エラーコード定義\n     */\n    export enum RESULT_CODE {\n        UI_LISTVIEW_DECLARE = RESULT_CODE_BASE.DECLARE,\n        ERROR_UI_LISTVIEW_INVALID_INITIALIZATION = DECLARE_ERROR_CODE(RESULT_CODE_BASE.CDP, LOCAL_CODE_BASE.UI_LISTVIEW + 1, 'listview has invalid initialization.'),\n        ERROR_UI_LISTVIEW_INVALID_PARAM          = DECLARE_ERROR_CODE(RESULT_CODE_BASE.CDP, LOCAL_CODE_BASE.UI_LISTVIEW + 2, 'listview given a invalid param.'),\n        ERROR_UI_LISTVIEW_INVALID_OPERATION      = DECLARE_ERROR_CODE(RESULT_CODE_BASE.CDP, LOCAL_CODE_BASE.UI_LISTVIEW + 3, 'listview invalid operation.'),\n    }\n}\n","/**\n * @en Global configuration definition for list views.\n * @ja リストビューのグローバルコンフィグレーション定義\n */\nexport interface ListViewGlobalConfig {\n    NAMESPACE: string;\n    SCROLL_MAP_CLASS: string;\n    INACTIVE_CLASS: string;\n    RECYCLE_CLASS: string;\n    LISTITEM_BASE_CLASS: string;\n    DATA_PAGE_INDEX: string;\n    DATA_ITEM_INDEX: string;\n}\n\n/** @internal */\nconst enum DefaultV {\n    NAMESPACE           = 'cdp-ui', // TODO: namespace は utils に移す\n    SCROLL_MAP_CLASS    = `${NAMESPACE}-listview-scroll-map`,\n    INACTIVE_CLASS      = `${NAMESPACE}-inactive`,\n    RECYCLE_CLASS       = `${NAMESPACE}-listview-recycle`,\n    LISTITEM_BASE_CLASS = `${NAMESPACE}-listview-item-base`,\n    DATA_PAGE_INDEX     = 'data-page-index',\n    DATA_ITEM_INDEX     = 'data-item-index',\n}\n\nconst _config = {\n    NAMESPACE: DefaultV.NAMESPACE,\n    SCROLL_MAP_CLASS: DefaultV.SCROLL_MAP_CLASS,\n    INACTIVE_CLASS: DefaultV.INACTIVE_CLASS,\n    RECYCLE_CLASS: DefaultV.RECYCLE_CLASS,\n    LISTITEM_BASE_CLASS: DefaultV.LISTITEM_BASE_CLASS,\n    DATA_PAGE_INDEX: DefaultV.DATA_PAGE_INDEX,\n    DATA_ITEM_INDEX: DefaultV.DATA_ITEM_INDEX,\n};\n\nexport type ListViewGlobalConfigArg = Partial<\n    Pick<ListViewGlobalConfig\n        , 'NAMESPACE'\n        | 'SCROLL_MAP_CLASS'\n        | 'INACTIVE_CLASS'\n        | 'RECYCLE_CLASS'\n        | 'LISTITEM_BASE_CLASS'\n        | 'DATA_PAGE_INDEX'\n        | 'DATA_ITEM_INDEX'\n    >\n>;\n\nconst ensureNewConfig = (newConfig: ListViewGlobalConfigArg): Partial<ListViewGlobalConfig> => {\n    const {\n        NAMESPACE: ns,\n        SCROLL_MAP_CLASS: scrollmap,\n        INACTIVE_CLASS: inactive,\n        RECYCLE_CLASS: recycle,\n        LISTITEM_BASE_CLASS: itembase,\n        DATA_PAGE_INDEX: datapage,\n        DATA_ITEM_INDEX: dataitem,\n    } = newConfig;\n\n    const NAMESPACE = ns;\n    const SCROLL_MAP_CLASS = scrollmap ?? (ns ? `${ns}-listview-scroll-map` : undefined);\n    const INACTIVE_CLASS = inactive ?? (ns ? `${ns}-inactive` : undefined);\n    const RECYCLE_CLASS = recycle ?? (ns ? `${ns}-listview-recycle` : undefined);\n    const LISTITEM_BASE_CLASS = itembase ?? (ns ? `${ns}-listview-item-base` : undefined);\n\n    return Object.assign(newConfig, {\n        NAMESPACE,\n        SCROLL_MAP_CLASS,\n        INACTIVE_CLASS,\n        RECYCLE_CLASS,\n        LISTITEM_BASE_CLASS,\n        DATA_PAGE_INDEX: datapage,\n        DATA_ITEM_INDEX: dataitem,\n    });\n};\n\n/**\n * @en Get/Update global configuration of list view.\n * @ja リストビューのグローバルコンフィグレーションの取得/更新\n */\nexport const ListViewGlobalConfig = (newConfig?: ListViewGlobalConfigArg): ListViewGlobalConfig => {\n    if (newConfig) {\n        ensureNewConfig(newConfig);\n        for (const key of Object.keys(newConfig)) {\n            if (undefined === newConfig[key as keyof ListViewGlobalConfigArg]) {\n                delete newConfig[key as keyof ListViewGlobalConfigArg];\n            }\n        }\n    }\n    return Object.assign({}, Object.assign(_config, newConfig));\n};\n","import {\n    UnknownObject,\n    DOM,\n    dom as $,\n} from '@cdp/runtime';\nimport { getTransformMatrixValues } from '@cdp/ui-utils';\nimport type { IListContext } from '../interfaces/base';\nimport type {\n    IListItemView,\n    IListItemViewConstructor,\n    ListItemUpdateHeightOptions,\n} from '../interfaces/list-item-view';\nimport { ListViewGlobalConfig } from '../global-config';\n\n/**\n * @en A class that stores UI structure information for list items.\n * @ja リストアイテムの UI 構造情報を格納するクラス\n */\nexport class ItemProfile {\n    /** @internal */\n    private readonly _owner: IListContext;\n    /** @internal */\n    private _height: number;\n    /** @internal */\n    private readonly _initializer: IListItemViewConstructor;\n    /** @internal */\n    private readonly _info: UnknownObject;\n    /** @internal global index */\n    private _index?: number;\n    /** @internal belonging page index */\n    private _pageIndex?: number;\n    /** @internal global offset */\n    private _offset = 0;\n    /** @internal base dom instance */\n    private _$base?: DOM;\n    /** @internal IListItemView instance */\n    private _instance?: IListItemView;\n\n    /**\n     * constructor\n     *\n     * @param owner\n     *  - `en` {@link IListViewContext} instance\n     *  - `ja` {@link IListViewContext} インスタンス\n     * @param height\n     *  - `en` initial item's height\n     *  - `ja` item の初期の高さ\n     * @param initializer\n     *  - `en` constructor for {@link IListItemView}'s subclass\n     *  - `ja` {@link IListItemView} のサブクラスのコンストラクタ\n     * @param info\n     *  - `en` init parameters for {@link IListItemView}'s subclass\n     *  - `ja` {@link IListItemView} のサブクラスの初期化パラメータ\n     */\n    constructor(owner: IListContext, height: number, initializer: IListItemViewConstructor, _info: UnknownObject) {\n        this._owner       = owner;\n        this._height      = height;\n        this._initializer = initializer;\n        this._info        = _info;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// accessors:\n\n    /** Get the item's height. */\n    get height(): number {\n        return this._height;\n    }\n\n    /** Get the item's global index. */\n    get index(): number | undefined {\n        return this._index;\n    }\n\n    /** Set the item's global index. */\n    set index(index: number) {\n        this._index = index;\n        this.updateIndex();\n    }\n\n    /** Get belonging the page index. */\n    get pageIndex(): number | undefined {\n        return this._pageIndex;\n    }\n\n    /** Set belonging the page index. */\n    set pageIndex(index: number) {\n        this._pageIndex = index;\n        this.updatePageIndex();\n    }\n\n    /** Get global offset. */\n    get offset(): number {\n        return this._offset;\n    }\n\n    /** Set global offset. */\n    set offset(offset: number) {\n        this._offset = offset;\n        this.updateOffset();\n    }\n\n    /** Get init parameters. */\n    get info(): UnknownObject {\n        return this._info;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// public methods:\n\n    /**\n     * @en Activate of the item.\n     * @ja item の活性化\n     */\n    public activate(): void {\n        if (null == this._instance) {\n            this._$base = this.prepareBaseElement();\n            this.updateIndex();\n            this.updateOffset();\n            const options = Object.assign({\n                el: this._$base,\n                owner: this._owner,\n                item: this,\n            }, this._info);\n            this._instance = new this._initializer(options);\n            if ('none' === this._$base.css('display')) {\n                this._$base.css('display', 'block');\n            }\n        }\n        this.updatePageIndex();\n        if (this._$base && 'visible' !== this._$base.css('visibility')) {\n            this._$base.css('visibility', 'visible');\n        }\n    }\n\n    /**\n     * @en Make the item invisible.\n     * @ja item の不可視化\n     */\n    public hide(): void {\n        if (null == this._instance) {\n            this.activate();\n        }\n        if (this._$base && 'hidden' !== this._$base.css('visibility')) {\n            this._$base.css('visibility', 'hidden');\n        }\n    }\n\n    /**\n     * @en Deactivate of the item.\n     * @ja item の非活性化\n     */\n    public deactivate(): void {\n        if (null != this._instance) {\n            this._instance.remove();\n            this._instance = undefined;\n            this._$base?.addClass(this._config.RECYCLE_CLASS);\n            this._$base?.css('display', 'none');\n            this._$base = undefined;\n        }\n    }\n\n    /**\n     * @en Refresh the item.\n     * @ja item の更新\n     */\n    public refresh(): void {\n        if (null != this._instance) {\n            this._instance.render();\n        }\n    }\n\n    /**\n     * @en Check the activation status of the item.\n     * @ja item の活性状態判定\n     */\n    public isActive(): boolean {\n        return null != this._instance;\n    }\n\n    /**\n     * @en Update height information of the item. Called from {@link ListItemView}.\n     * @ja item の高さ情報の更新. {@link ListItemView} からコールされる。\n     */\n    public updateHeight(newHeight: number, options?: ListItemUpdateHeightOptions): void {\n        const delta = newHeight - this._height;\n        this._height = newHeight;\n        this._owner.updateScrollMapHeight(delta);\n        if (options?.reflectAll) {\n            this._owner.updateProfiles(this._index ?? 0);\n        }\n    }\n\n    /**\n     * @en Reset z-index. Called from {@link ScrollManager}`.removeItem()`.\n     * @ja z-index のリセット. {@link ScrollManager}`.removeItem()` からコールされる。\n     */\n    public resetDepth(): void {\n        if (null != this._instance) {\n            this._$base?.css('z-index', this._owner.options.baseDepth);\n        }\n    }\n\n///////////////////////////////////////////////////////////////////////\n// internal:\n\n    /** @internal */\n    private get _config(): ListViewGlobalConfig {\n        return ListViewGlobalConfig();\n    }\n\n    /** @internal */\n    private prepareBaseElement(): DOM {\n        let $base: DOM;\n        const $recycle = this._owner.findRecycleElements().first();\n        const itemTagName = this._owner.options.itemTagName;\n\n        if (null != this._$base) {\n            console.warn('this._$base is not null.');\n            return this._$base;\n        }\n\n        if (0 < $recycle.length) {\n            $base = $recycle;\n            $base.removeAttr('z-index');\n            $base.removeClass(this._config.RECYCLE_CLASS);\n        } else {\n            // TODO:  要検討. <li> 全般は <slot> とどのように協調するか?\n            $base = $(`<${itemTagName} class=\"${this._config.LISTITEM_BASE_CLASS}\"></\"${itemTagName}\">`);\n            $base.css('display', 'none');\n            this._owner.$scrollMap.append($base);\n        }\n\n        // 高さの更新\n        if ($base.height() !== this._height) {\n            $base.height(this._height);\n        }\n\n        return $base;\n    }\n\n    /** @internal */\n    private updateIndex(): void {\n        if (this._$base && this._$base.attr(this._config.DATA_ITEM_INDEX) !== String(this._index)) {\n            this._$base.attr(this._config.DATA_ITEM_INDEX, this._index!);\n        }\n    }\n\n    /** @internal */\n    private updatePageIndex(): void {\n        if (this._$base && this._$base.attr(this._config.DATA_PAGE_INDEX) !== String(this._pageIndex)) {\n            this._$base.attr(this._config.DATA_PAGE_INDEX, this._pageIndex!);\n        }\n    }\n\n    /** @internal */\n    private updateOffset(): void {\n        if (!this._$base) {\n            return;\n        }\n\n        if (this._owner.options.enableTransformOffset) {\n            const { translateY } = getTransformMatrixValues(this._$base[0]);\n            if (translateY !== this._offset) {\n                this._$base.css('transform', `translate3d(0,${this._offset}px,0`);\n            }\n        } else {\n            const top = parseInt(this._$base.css('top'), 10);\n            if (top !== this._offset) {\n                this._$base.css('top', `${this._offset}px`);\n            }\n        }\n    }\n}\n","import { at } from '@cdp/runtime';\nimport type { ItemProfile } from './item';\n\n/**\n * @en A class that stores UI structure information for one page of the list.\n * @ja リスト1ページ分の UI 構造情報を格納するクラス\n */\nexport class PageProfile {\n    /** @internal page index */\n    private _index = 0;\n    /** @internal page offset from top */\n    private _offset = 0;\n    /** @internal page's height */\n    private _height = 0;\n    /** @internal item's profile managed with in page */\n    private _items: ItemProfile[] = [];\n    /** @internal page status */\n    private _status: 'active' | 'inactive' | 'hidden' = 'inactive';\n\n///////////////////////////////////////////////////////////////////////\n// accessors:\n\n    /** Get the page index */\n    get index(): number {\n        return this._index;\n    }\n\n    /** Set the page index */\n    set index(index: number) {\n        this._index = index;\n    }\n\n    /** Get the page offset */\n    get offset(): number {\n        return this._offset;\n    }\n\n    /** Set the page offset */\n    set offset(offset: number) {\n        this._offset = offset;\n    }\n\n    /** Get the page height */\n    get height(): number {\n        return this._height;\n    }\n\n    /** Get the page status */\n    get status(): 'active' | 'inactive' | 'hidden' {\n        return this._status;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// public methods:\n\n    /**\n     * @en Activate of the page.\n     * @ja page の活性化\n     */\n    public activate(): void {\n        if ('active' !== this._status) {\n            for (const item of this._items) {\n                item.activate();\n            }\n        }\n        this._status = 'active';\n    }\n\n    /**\n     * @en Make the page invisible.\n     * @ja page の不可視化\n     */\n    public hide(): void {\n        if ('hidden' !== this._status) {\n            for (const item of this._items) {\n                item.hide();\n            }\n        }\n        this._status = 'hidden';\n    }\n\n    /**\n     * @en Deactivate of the page.\n     * @ja page の非活性化\n     */\n    public deactivate(): void {\n        if ('inactive' !== this._status) {\n            for (const item of this._items) {\n                item.deactivate();\n            }\n        }\n        this._status = 'inactive';\n    }\n\n    /**\n     * @en Add {@link ItemProfile} to the page.\n     * @ja {@link ItemProfile} の追加\n     */\n    public push(item: ItemProfile): void {\n        this._items.push(item);\n        this._height += item.height;\n    }\n\n    /**\n     * @en If all {@link ItemProfile} under the page are not valid, disable the page's status.\n     * @ja 配下の {@link ItemProfile} すべてが有効でない場合, page ステータスを無効にする\n     */\n    public normalize(): void {\n        const enableAll = this._items.every(item => item.isActive());\n        if (!enableAll) {\n            this._status = 'inactive';\n        }\n    }\n\n    /**\n     * @en Get {@link ItemProfile} by index.\n     * @ja インデックスを指定して {@link ItemProfile} を取得\n     */\n    public getItem(index: number): ItemProfile {\n        return at(this._items, index);\n    }\n\n    /**\n     * @en Get first {@link ItemProfile}.\n     * @ja 最初の {@link ItemProfile} を取得\n     */\n    public getItemFirst(): ItemProfile | undefined {\n        return this._items[0];\n    }\n\n    /**\n     * @en Get last {@link ItemProfile}.\n     * @ja 最後の {@link ItemProfile} を取得\n     */\n    public getItemLast(): ItemProfile | undefined {\n        return this._items[this._items.length - 1];\n    }\n}\n","import {\n    type UnknownObject,\n    RESULT_CODE,\n    makeResult,\n    toHelpString,\n} from '@cdp/runtime';\nimport type { ListEnsureVisibleOptions } from '../interfaces/base';\nimport type { IListItemViewConstructor } from '../interfaces/list-item-view';\nimport type { IExpandableListContext } from '../interfaces/expandable-context';\nimport { ItemProfile } from './item';\n\n/**\n * @en UI structure information storage class for group management of list items. <br>\n *     This class does not directly manipulate the DOM.\n * @ja リストアイテムをグループ管理する UI 構造情報格納クラス <br>\n *     本クラスは直接は DOM を操作しない\n */\nexport class GroupProfile {\n    /** @internal profile id */\n    private readonly _id: string;\n    /** @internal {@link ExpandableListView} instance*/\n    private readonly _owner: IExpandableListContext;\n    /** @internal parent {@link GroupProfile} instance */\n    private _parent?: GroupProfile;\n    /** @internal child {@link GroupProfile} array */\n    private readonly _children: GroupProfile[] = [];\n    /** @internal expanded / collapsed status */\n    private _expanded = false;\n    /** @internal registration status for _owner */\n    private _status: 'registered' | 'unregistered' = 'unregistered';\n    /** @internal stored {@link ItemProfile} information */\n    private readonly _items: ItemProfile[] = [];\n\n    /**\n     * constructor\n     *\n     * @param owner\n     *  - `en` {@link IExpandableListContext} instance\n     *  - `ja` {@link IExpandableListContext} インスタンス\n     * @param id\n     *  - `en` id of the instance. specified by the framework.\n     *  - `ja` インスタンスの ID. フレームワークが指定\n     */\n    constructor(owner: IExpandableListContext, id: string) {\n        this._id    = id;\n        this._owner = owner;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// accessors:\n\n    /**\n     * @en Get ID.\n     * @ja ID を取得\n     */\n    get id(): string {\n        return this._id;\n    }\n\n    /**\n     * \n     * @en Get status. 'registered' | 'unregistered'\n     * @ja ステータスを取得 'registered' | 'unregistered'\n     */\n    get status(): 'registered' | 'unregistered' {\n        return this._status;\n    }\n\n    /**\n     * @en Check expanded / collapsed status.\n     * @ja 展開状態を判定\n     *\n     * @returns\n     *  - `en` true: expanded, collapsed: close\n     *  - `ja` true: 展開, false: 収束\n     */\n    get isExpanded(): boolean {\n        return this._expanded;\n    }\n\n    /**\n     * @en Get parent {@link GroupProfile}.\n     * @ja 親 {@link GroupProfile} を取得\n     */\n    get parent(): GroupProfile | undefined {\n        return this._parent;\n    }\n\n    /**\n     * @en Get children {@link GroupProfile}.\n     * @ja 子 {@link GroupProfile} を取得\n     */\n    get children(): GroupProfile[] {\n        return this._children;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// public methods:\n\n    /**\n     * @en Get the next available index of the last item element.\n     * @ja 最後の item 要素の次に使用できる index を取得\n     *\n     * @param withActiveChildren \n     *  - `en` specify true to search including registered child elements\n     *  - `ja` 登録済みの子要素を含めて検索する場合は true を指定\n     */\n    public getNextItemIndex(withActiveChildren = false): number {\n        let items: ItemProfile[] = [];\n        if (withActiveChildren) {\n            items = this.queryOperationTarget('active');\n        }\n        if (null == items || items.length <= 0) {\n            items = this._items;\n        }\n        return (items[items.length - 1]?.index ?? 0) + 1;\n    }\n\n    /**\n     * @en Item registration.\n     * @ja 本 GroupProfile が管理する item を作成して登録\n     *\n     * @param height\n     *  - `en` initial item's height\n     *  - `ja` item の高さ\n     * @param initializer\n     *  - `en` constructor for {@link IListItemView}'s subclass\n     *  - `ja` {@link IListItemView} のサブクラスのコンストラクタ\n     * @param info\n     *  - `en` init parameters for {@link IListItemView}'s subclass\n     *  - `ja` {@link IListItemView} のサブクラスの初期化パラメータ\n     */\n    public addItem(\n        height: number,\n        initializer: IListItemViewConstructor,\n        info: UnknownObject,\n    ): GroupProfile {\n        const options = Object.assign({ group: this }, info);\n        const item = new ItemProfile(this._owner.context, Math.trunc(height), initializer, options);\n\n        // _owner の管理下にあるときは速やかに追加\n        if ('registered' === this._status) {\n            this._owner._addItem(item, this.getNextItemIndex());\n            this._owner.update();\n        }\n        this._items.push(item);\n\n        return this;\n    }\n\n    /**\n     * @en Add {@link GroupProfile} as child element.\n     * @ja 子要素として {@link GroupProfile} を追加\n     *\n     * @param target {@link GroupProfile} instance / instance array\n     */\n    public addChildren(target: GroupProfile | GroupProfile[]): this {\n        const children: GroupProfile[] = Array.isArray(target) ? target : [target];\n        for (const child of children) {\n            child.setParent(this);\n        }\n        this._children.push(...children);\n        return this;\n    }\n\n    /**\n     * @en Determine if it has a child {@link GroupProfile}.\n     * @ja 子 {@link GroupProfile} を持っているか判定\n     *\n     * @returns\n     *  - `en` true: exists, false: unexists\n     *  - `ja` true: 有, false: 無\n     */\n    get hasChildren(): boolean {\n        return !!this._children.length;\n    }\n\n    /**\n     * @en Group expansion.\n     * @ja グループ展開\n     */\n    public async expand(): Promise<void> {\n        if (!this.isExpanded) {\n            const items = this.queryOperationTarget('registered');\n            if (0 < items.length) {\n                await this._owner.statusScope('expanding', () => {\n                    // 自身を更新\n                    for (const item of this._items) {\n                        item.refresh();\n                    }\n                    // 配下を更新\n                    this._owner._addItem(items, this.getNextItemIndex());\n                    this._owner.update();\n                });\n            }\n        }\n        // 子要素がなくても展開状態にする\n        this._expanded = true;\n    }\n\n    /**\n     * @en Group collapse.\n     * @ja グループ収束\n     *\n     * @param delay\n     *  - `en` delay time spent removing elements. [default: `animationDuration` value]\n     *  - `ja` 要素削除に費やす遅延時間. [default: `animationDuration` value]\n     */\n    public async collapse(delay?: number): Promise<void> {\n        if (this.isExpanded) {\n            const items = this.queryOperationTarget('unregistered');\n            if (0 < items.length) {\n                delay = delay ?? this._owner.context.options.animationDuration;\n                await this._owner.statusScope('collapsing', () => {\n                    // 自身を更新\n                    for (const item of this._items) {\n                        item.refresh();\n                    }\n                    // 配下を更新\n                    items[0].index && this._owner.removeItem(items[0].index, items.length, delay);\n                    this._owner.update();\n                });\n            }\n        }\n        // 子要素がなくても収束状態にする\n        this._expanded = false;\n    }\n\n    /**\n     * @en Show self in visible area of list.\n     * @ja 自身をリストの可視領域に表示\n     *\n     * @param options\n     *  - `en` {@link ListEnsureVisibleOptions} option's object\n     *  - `ja` {@link ListEnsureVisibleOptions} オプション\n     */\n    async ensureVisible(options?: ListEnsureVisibleOptions): Promise<void> {\n        if (0 < this._items.length) {\n            (null != this._items[0].index) && await this._owner.ensureVisible(this._items[0].index, options);\n        } else {\n            options?.callback?.(this._owner.scrollPos);\n        }\n    }\n\n    /**\n     * @en Toggle expand / collapse.\n     * @ja 開閉のトグル\n     *\n     * @param delay\n     *  - `en` delay time spent removing elements. [default: `animationDuration` value]\n     *  - `ja` 要素削除に費やす遅延時間. [default: `animationDuration` value]\n     */\n    public async toggle(delay?: number): Promise<void> {\n        if (this._expanded) {\n            await this.collapse(delay);\n        } else {\n            await this.expand();\n        }\n    }\n\n    /**\n     * @en Register to list view. Only 1st layer group can be registered.\n     * @ja リストビューへ登録. 第1階層グループのみ登録可能.\n     *\n     * @param insertTo\n     *  - `en` specify insertion position with index\n     *  - `ja` 挿入位置を index で指定\n     */\n    public register(insertTo: number): this {\n        if (this._parent) {\n            throw makeResult(\n                RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM,\n                `${toHelpString(RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM)} 'GroupProfile#register' method is acceptable only 1st layer group.`\n            );\n        }\n        this._owner._addItem(this.preprocess('registered'), insertTo);\n        return this;\n    }\n\n    /**\n     * @en Restore to list view. Only 1st layer group can be specified.\n     * @ja リストビューへ復元. 第1階層グループのみ指示可能.\n     */\n    public restore(): this {\n        if (this._parent) {\n            throw makeResult(\n                RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM,\n                `${toHelpString(RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM)} 'GroupProfile#restore' method is acceptable only 1st layer group.`\n            );\n        }\n\n        if (this._items) {\n            const items = this._expanded ? this._items.concat(this.queryOperationTarget('active')) : this._items.slice();\n            this._owner._addItem(items);\n        }\n        return this;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// internal:\n\n    /** @internal 親 Group 指定 */\n    private setParent(parent: GroupProfile): void {\n        this._parent = parent;\n    }\n\n    /** @internal  register / unregister の前処理 */\n    private preprocess(newStatus: 'registered' | 'unregistered'): ItemProfile[] {\n        const items: ItemProfile[] = [];\n        if (newStatus !== this._status) {\n            items.push(...this._items);\n        }\n        this._status = newStatus;\n        return items;\n    }\n\n    /** @internal 操作対象の ItemProfile 配列を取得 */\n    private queryOperationTarget(operation: 'registered' | 'unregistered' | 'active'): ItemProfile[] {\n        const findTargets = (group: GroupProfile): ItemProfile[] => {\n            const items: ItemProfile[] = [];\n            for (const child of group._children) {\n                switch (operation) {\n                    case 'registered':\n                    case 'unregistered':\n                        items.push(...child.preprocess(operation));\n                        break;\n                    case 'active':\n                        if (null != child._items) {\n                            items.push(...child._items);\n                        }\n                        break;\n                    default:\n                        // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n                        console.warn(`unknown operation: ${operation}`);\n                        break;\n                }\n                if (child.isExpanded) {\n                    items.push(...findTargets(child));\n                }\n            }\n            return items;\n        };\n        return findTargets(this);\n    }\n}\n","import {\n    type Writable,\n    type ViewConstructionOptions,\n    View,\n} from '@cdp/runtime';\nimport type {\n    IListView,\n    ListItemUpdateHeightOptions,\n    IListItemView,\n} from './interfaces';\nimport type { ItemProfile } from './profile';\n\n/** @internal */ const _properties = Symbol('properties');\n\n/** @internal */\ninterface Property {\n    readonly owner: IListView;\n    readonly item: ItemProfile;\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Options to pass to {@link ListItemView} construction.\n * @ja {@link ListItemView} 構築に渡すオプション\n */\nexport interface ListItemViewConstructionOptions<TElement extends Node = HTMLElement, TFuncName = string>\n    extends ViewConstructionOptions<TElement, TFuncName> {\n    owner: IListView;\n    item: ItemProfile;\n}\n\n/**\n * @en List item container class handled by {@link ListView}.\n * @ja {@link ListView} が扱うリストアイテムコンテナクラス\n */\nexport abstract class ListItemView<TElement extends Node = HTMLElement, TEvent extends object = object>\n    extends View<TElement, TEvent> implements IListItemView {\n\n    /** @internal */\n    private readonly [_properties]!: Property;\n\n    /** constructor */\n    constructor(options: ListItemViewConstructionOptions<TElement>) {\n        super(options);\n\n        const { owner, item } = options;\n        (this[_properties] as Writable<Property>) = {\n            owner,\n            item,\n        } as Property;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// public methods:\n\n    /** Owner 取得 */\n    get owner(): IListView {\n        return this[_properties].owner;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// View component methods:\n\n    /**\n     * @override\n     * @en Remove this view by taking the element out of the DOM with release all listeners.\n     * @ja View から DOM を切り離し, リスナーを解除\n     */\n    override remove(): this {\n        this.$el.children().remove();\n        this.$el.off();\n        // this.$el は再利用するため完全な破棄はしない\n        this.setElement('null');\n        this.stopListening();\n        return this;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListItemView\n\n    /**\n     * @en Get own item index\n     * @ja 自身の item インデックスを取得\n     */\n    get index(): number {\n        return this[_properties].item.index!;\n    }\n\n    /**\n     * @en Get specified height.\n     * @ja 指定された高さを取得\n     */\n    get height(): number {\n        return this[_properties].item.height;\n    }\n\n    /**\n     * @en Check if child node exists.\n     * @ja child node が存在するか判定\n     */\n    get hasChildNode(): boolean {\n        return !!this.$el?.children().length;\n    }\n\n    /**\n     * @en Update item's height.\n     * @ja item の高さを更新\n     *\n     * @param newHeight\n     *  - `en` new item's height\n     *  - `ja` item の新しい高さ\n     * @param options\n     *  - `en` update options object\n     *  - `ja` 更新オプション\n     */\n    updateHeight(newHeight: number, options?: ListItemUpdateHeightOptions): this {\n        if (this.$el && this.height !== newHeight) {\n            this[_properties].item.updateHeight(newHeight, options);\n            this.$el.height(newHeight);\n        }\n        return this;\n    }\n}\n","import {\n    type Nullable,\n    type UnknownFunction,\n    type DOM,\n    type DOMSelector,\n    type DOMEventListener,\n    type ConnectEventMap,\n    type TimerHandle,\n    setTimeout,\n    clearTimeout,\n    dom as $,\n} from '@cdp/runtime';\nimport type {\n    ListScrollerFactory,\n    ListContextOptions,\n    IListScroller,\n} from '../interfaces';\n\n/** @internal */\ntype ScrollerEventMap = HTMLElementEventMap & ConnectEventMap & { 'scrollstop': Event; };\n\n/** @internal */\nconst enum Const {\n    MIN_SCROLLSTOP_DURATION = 50,\n}\n\n/**\n * @internal\n * @en {@link IListScroller} implementation class for HTMLElement.\n * @ja HTMLElement を対象とした {@link IListScroller} 実装クラス\n */\nexport class ElementScroller implements IListScroller {\n    private readonly _$target: DOM;\n    private readonly _$scrollMap: DOM;\n    private readonly _options: ListContextOptions;\n    private readonly _scrollStopTrigger: DOMEventListener;\n    private _scrollDuration?: number;\n\n    /** constructor */\n    constructor(target: DOMSelector, map: DOMSelector, options: ListContextOptions) {\n        this._$target = $(target);\n        this._$scrollMap = this._$target.children().first();\n        this._options = options;\n\n        /*\n         * fire custom event: `scrollstop`\n         * `scrollend` の Safari 対応待ち\n         * https://developer.mozilla.org/ja/docs/Web/API/Element/scrollend_event\n         */\n        let timer: TimerHandle;\n        this._scrollStopTrigger = (): void => {\n            if (null != timer) {\n                clearTimeout(timer);\n            }\n            timer = setTimeout(() => {\n                this._$target.trigger(new CustomEvent('scrollstop', { bubbles: true, cancelable: true }));\n            }, this._scrollDuration ?? Const.MIN_SCROLLSTOP_DURATION);\n        };\n        this._$target.on('scroll', this._scrollStopTrigger);\n    }\n\n///////////////////////////////////////////////////////////////////////\n// static methods:\n\n    /** タイプ定義識別子 */\n    static get TYPE(): string {\n        return 'cdp:element-overflow-scroller';\n    }\n\n    /** factory 取得 */\n    static getFactory(): ListScrollerFactory {\n        const factory = (target: DOMSelector, map: DOMSelector, options: ListContextOptions): IListScroller => {\n            return new ElementScroller(target, map, options);\n        };\n        // set type signature.\n        Object.defineProperties(factory, {\n            type: {\n                configurable: false,\n                writable: false,\n                enumerable: true,\n                value: ElementScroller.TYPE,\n            },\n        });\n        return factory as ListScrollerFactory;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListScroller\n\n    /** Scroller の型情報を取得 */\n    get type(): string {\n        return ElementScroller.TYPE;\n    }\n\n    /** スクロール位置取得 */\n    get pos(): number {\n        return this._$target.scrollTop();\n    }\n\n    /** スクロール最大値位置を取得 */\n    get posMax(): number {\n        return Math.max(this._$scrollMap.height() - this._$target.height(), 0);\n    }\n\n    /** スクロールイベント登録 */\n    on(type: 'scroll' | 'scrollstop', callback: DOMEventListener): void {\n        this._$target.on<ScrollerEventMap>(type, callback as UnknownFunction);\n    }\n\n    /** スクロールイベント登録解除 */\n    off(type: 'scroll' | 'scrollstop', callback: DOMEventListener): void {\n        this._$target.off<ScrollerEventMap>(type, callback as UnknownFunction);\n    }\n\n    /** スクロール位置を指定 */\n    scrollTo(pos: number, animate?: boolean, time?: number): Promise<void> {\n        if (pos === this._$target.scrollTop()) {\n            return Promise.resolve();\n        }\n        return new Promise(resolve => {\n            this._scrollDuration = (animate ?? this._options.enableAnimation) ? time ?? this._options.animationDuration : undefined;\n            this._$target.scrollTop(pos, this._scrollDuration, undefined, () => {\n                this._scrollDuration = undefined;\n                resolve();\n            });\n        });\n    }\n\n    /** Scroller の状態更新 */\n    update(): void {\n        // noop\n    }\n\n    /** Scroller の破棄 */\n    destroy(): void {\n        this._$target?.off();\n        (this._$target as Nullable<DOM>) = (this._$scrollMap as Nullable<DOM>) = null;\n    }\n}\n","import {\n    type UnknownObject,\n    type DOM,\n    type DOMEventListener,\n    post,\n    noop,\n    RESULT_CODE,\n    makeResult,\n    toHelpString,\n    dom as $,\n} from '@cdp/runtime';\nimport {\n    getTransformMatrixValues,\n    setTransformTransition,\n    clearTransition,\n} from '@cdp/ui-utils';\nimport type {\n    ListContextOptions,\n    IListContext,\n    ListEnsureVisibleOptions,\n    IListScroller,\n    IListOperation,\n    IListScrollable,\n    IListBackupRestore,\n    IListItemViewConstructor,\n} from '../interfaces';\nimport { ListViewGlobalConfig } from '../global-config';\nimport { ItemProfile, PageProfile } from '../profile';\nimport { ElementScroller } from './element-scroller';\n\n/** ListContextOptions 既定値 */\nconst _defaultOpts: Required<ListContextOptions> = {\n    scrollerFactory: ElementScroller.getFactory(),\n    enableHiddenPage: false,\n    enableTransformOffset: true,\n    scrollMapRefreshInterval: 200,\n    scrollRefreshDistance: 200,\n    pagePrepareCount: 3,\n    pagePreloadCount: 1,\n    enableAnimation: true,\n    animationDuration: 0,\n    baseDepth: 'auto',\n    itemTagName: 'div',\n    removeItemWithTransition: true,\n    useDummyInactiveScrollMap: false,\n};\n\n/** invalid instance */\nconst _$invalid = $() as DOM;\n\n/** 初期化済みか検証 */\nfunction verify<T>(x: T | undefined): asserts x is T {\n    if (null == x) {\n        throw makeResult(RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_INITIALIZATION);\n    }\n}\n\n/** overflow-y を保証 */\nfunction ensureOverflowY($el: DOM): DOM {\n    const overflowY = $el.css('overflow-y');\n    if ('hidden' === overflowY || 'visible' === overflowY) {\n        $el.css('overflow-y', 'auto');\n    }\n    return $el;\n}\n\n/** scroll-map element を保証 */\nfunction ensureScrollMap($root: DOM, mapClass: string): DOM {\n    let $map = $root.find(`.${mapClass}`);\n    // $map が無い場合は作成する\n    if ($map.length <= 0) {\n        $map = $(`<div class=\"${mapClass}\"></div>`);\n        $root.append($map);\n    }\n    return $map;\n}\n\n/** @internal アイテム削除情報 */\ninterface RemoveItemsContext {\n    removed: ItemProfile[];\n    delta: number;\n    transition: boolean;\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @internal\n * @en Core logic implementation class for scroll processing that manages memory. Accesses the DOM.\n * @ja メモリ管理を行うスクロール処理のコアロジック実装クラス. DOM にアクセスする.\n */\nexport class ListCore implements IListContext, IListOperation, IListScrollable, IListBackupRestore {\n    private _$root: DOM;\n    private _$map: DOM;\n    private _mapHeight = 0;\n    private _scroller: IListScroller | undefined;\n\n    /** UI 表示中に true */\n    private _active = true;\n\n    /** 初期オプションを格納 */\n    private readonly _settings: Required<ListContextOptions>;\n    /** Scroll Event Handler */\n    private readonly _scrollEventHandler: (ev?: Event) => void;\n    /** Scroll Stop Event Handler */\n    private readonly _scrollStopEventHandler: (ev?: Event) => void;\n    /** 1ページ分の高さの基準値 */\n    private _baseHeight = 0;\n    /** 管理下にある ItemProfile 配列 */\n    private readonly _items: ItemProfile[] = [];\n    /** 管理下にある PageProfile 配列 */\n    private readonly _pages: PageProfile[] = [];\n\n    /** 最新の表示領域情報を格納 (Scroll 中の更新処理に使用) */\n    private readonly _lastActivePageContext = {\n        index: 0,\n        from: 0,\n        to: 0,\n        pos: 0,    // scroll position\n    };\n\n    /** データの backup 領域. key と _items を格納 */\n    private readonly _backup: Record<string, { items: ItemProfile[]; }> = {};\n\n    /** constructor */\n    constructor(options?: ListContextOptions) {\n        this._$root = this._$map = _$invalid;\n        this._settings = Object.assign({}, _defaultOpts, options);\n\n        this._scrollEventHandler = () => {\n            this.onScroll(this._scroller!.pos);\n        };\n        this._scrollStopEventHandler = (): void => {\n            this.onScrollStop(this._scroller!.pos);\n        };\n    }\n\n///////////////////////////////////////////////////////////////////////\n// public methods:\n\n    /** 内部オブジェクトの初期化 */\n    public initialize($root: DOM, height: number): void {\n        // 既に構築されていた場合は破棄\n        if (this._$root.length) {\n            this.destroy();\n        }\n\n        this._$root = ensureOverflowY($root);\n        this._$map  = ensureScrollMap(this._$root, this._config.SCROLL_MAP_CLASS);\n\n        this._scroller = this.createScroller();\n        this.setBaseHeight(height);\n        this.setScrollerCondition();\n    }\n\n    /** 内部オブジェクトの破棄 */\n    public destroy(): void {\n        this.resetScrollerCondition();\n        this._scroller?.destroy();\n        this._scroller = undefined;\n        this.release();\n        this._$root = this._$map = _$invalid;\n    }\n\n    /** ページの基準値を取得 */\n    public setBaseHeight(height: number): void {\n        if (height <= 0) {\n            throw makeResult(\n                RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM,\n                `${toHelpString(RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM)} [base hight: ${height}]`\n            );\n        }\n        this._baseHeight = height;\n        this._scroller?.update();\n    }\n\n    /** active 状態設定 */\n    public async setActiveState(active: boolean): Promise<void> {\n        this._active = active;\n        await this.treatScrollPosition();\n    }\n\n    /** active 状態判定 */\n    get active(): boolean {\n        return this._active;\n    }\n\n    /** スクロール位置の保存/復元 */\n    public async treatScrollPosition(): Promise<void> {\n        verify(this._scroller);\n\n        const offset = (this._scroller.pos - this._lastActivePageContext.pos);\n        const { useDummyInactiveScrollMap: useDummyMap } = this._settings;\n\n        const updateOffset = ($target: DOM): void => {\n            const { translateY } = getTransformMatrixValues($target[0]);\n            if (offset !== translateY) {\n                $target.css('transform', `translate3d(0,${offset}px,0`);\n            }\n        };\n\n        if (this._active) {\n            await this._scroller.scrollTo(this._lastActivePageContext.pos, false, 0);\n            this._$map.css({ 'transform': '', 'display': 'block' });\n            if (useDummyMap) {\n                this.prepareInactiveMap().remove();\n            }\n        } else {\n            const $map = useDummyMap ? this.prepareInactiveMap() : this._$map;\n            updateOffset($map);\n        }\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListContext\n\n    /** get scroll-map element */\n    get $scrollMap(): DOM {\n        return this._$map;\n    }\n\n    /** get scroll-map height [px] */\n    get scrollMapHeight(): number {\n        return this._$map.length ? this._mapHeight : 0;\n    }\n\n    /** get {@link ListContextOptions} */\n    get options(): Required<ListContextOptions> {\n        return this._settings;\n    }\n\n    /** update scroll-map height (delta [px]) */\n    updateScrollMapHeight(delta: number): void {\n        if (this._$map.length) {\n            this._mapHeight += Math.trunc(delta);\n            // for fail safe.\n            if (this._mapHeight < 0) {\n                this._mapHeight = 0;\n            }\n            this._$map.height(this._mapHeight);\n        }\n    }\n\n    /** update internal profile */\n    updateProfiles(from: number): void {\n        const { _items } = this;\n        for (let i = from, n = _items.length; i < n; i++) {\n            if (0 < i) {\n                const last = _items[i - 1];\n                _items[i].index = last.index! + 1;\n                _items[i].offset = last.offset + last.height;\n            } else {\n                _items[i].index = 0;\n                _items[i].offset = 0;\n            }\n        }\n    }\n\n    /** get recyclable element */\n    findRecycleElements(): DOM {\n        return this._$map.find(`.${this._config.RECYCLE_CLASS}`);\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListView\n\n    /** 初期化済みか判定 */\n    get isInitialized(): boolean {\n        return !!this._scroller;\n    }\n\n    /** item 登録 */\n    addItem(height: number, initializer: IListItemViewConstructor, info: UnknownObject, insertTo?: number): void {\n        this._addItem(new ItemProfile(this, Math.trunc(height), initializer, info), insertTo);\n    }\n\n    /** item 登録 (内部用) */\n    _addItem(item: ItemProfile | ItemProfile[], insertTo?: number): void {\n        const items: ItemProfile[] = Array.isArray(item) ? item : [item];\n        let deltaHeight = 0;\n        let addTail = false;\n\n        if (null == insertTo || this._items.length < insertTo) {\n            insertTo = this._items.length;\n        }\n\n        if (insertTo === this._items.length) {\n            addTail = true;\n        }\n\n        // scroll map の更新\n        for (const it of items) {\n            deltaHeight += it.height;\n        }\n        this.updateScrollMapHeight(deltaHeight);\n\n        // 挿入\n        this._items.splice(insertTo, 0, ...items);\n\n        // page 設定の解除\n        if (!addTail) {\n            if (0 === insertTo) {\n                this.clearPage();\n            } else if (null != this._items[insertTo - 1].pageIndex) {\n                this.clearPage(this._items[insertTo - 1].pageIndex);\n            }\n        }\n\n        // offset の再計算\n        this.updateProfiles(insertTo);\n    }\n\n    /** 指定した Item を削除 */\n    removeItem(index: number, size?: number, delay?: number): void;\n    removeItem(index: number[], delay?: number): void;\n    removeItem(index: number | number[], arg2?: number, arg3?: number): void {\n        if (Array.isArray(index)) {\n            this._removeItemRandomly(index, arg2);\n        } else {\n            this._removeItemContinuously(index, arg2, arg3);\n        }\n    }\n\n    /** helper: 削除候補と変化量の算出 */\n    private _queryRemoveItemsContext(indexes: number[], delay: number): RemoveItemsContext {\n        const removed: ItemProfile[] = [];\n        let delta = 0;\n        let transition = false;\n\n        for (const idx of indexes) {\n            const item = this._items[idx];\n            delta += item.height;\n            // 削除要素の z-index の初期化\n            item.resetDepth();\n            removed.push(item);\n        }\n        // 自動設定・削除遅延時間が設定されかつ、スクロールポジションに変更がある場合は transition 設定\n        if (this._settings.removeItemWithTransition && (0 < delay)) {\n            const current = this.scrollPos;\n            const posMax = this.scrollPosMax - delta;\n            transition = (posMax < current);\n        }\n\n        return { removed, delta, transition };\n    }\n\n    /** helper: 削除時の更新 */\n    private _updateWithRemoveItemsContext(context: RemoveItemsContext, delay: number, profileUpdate: () => void): void {\n        const { removed, delta, transition } = context;\n\n        // transition 設定\n        if (transition) {\n            this.setupScrollMapTransition(delay);\n        }\n\n        // customize point: プロファイルの更新\n        profileUpdate();\n\n        // スクロール領域の更新\n        this.updateScrollMapHeight(-delta);\n        // 遅延削除\n        setTimeout(() => {\n            for (const item of removed) {\n                item.deactivate();\n            }\n        }, delay);\n    }\n\n    /** 指定した ItemProfile を削除: 連続 index 版 */\n    private _removeItemContinuously(index: number, size: number | undefined, delay: number | undefined): void {\n        size = size ?? 1;\n        delay = delay ?? 0;\n\n        if (index < 0 || this._items.length < index + size) {\n            throw makeResult(\n                RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM,\n                `${toHelpString(RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM)} [removeItem(), invalid index: ${index}]`\n            );\n        }\n\n        // 削除候補と変化量の算出\n        const indexes = Array.from({ length: size }, (_, i) => index + i);\n        const context = this._queryRemoveItemsContext(indexes, delay);\n\n        // 更新\n        this._updateWithRemoveItemsContext(context, delay, () => {\n            // page 設定の解除\n            if (null != this._items[index].pageIndex) {\n                this.clearPage(this._items[index].pageIndex);\n            }\n            // 配列から削除\n            this._items.splice(index, size);\n            // offset の再計算\n            this.updateProfiles(index);\n        });\n    }\n\n    /** 指定した ItemProfile を削除: random access 版 */\n    private _removeItemRandomly(indexes: number[], delay?: number): void {\n        delay = delay ?? 0;\n        indexes.sort((lhs, rhs) => rhs - lhs); // 降順ソート\n\n        for (const index of indexes) {\n            if (index < 0 || this._items.length < index) {\n                throw makeResult(\n                    RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM,\n                    `${toHelpString(RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM)} [removeItem(), invalid index: ${index}]`\n                );\n            }\n        }\n\n        // 削除候補と変化量の算出\n        const context = this._queryRemoveItemsContext(indexes, delay);\n\n        // 更新\n        this._updateWithRemoveItemsContext(context, delay, () => {\n            for (const idx of indexes) {\n                // page 設定の解除\n                if (null != this._items[idx].pageIndex) {\n                    this.clearPage(this._items[idx].pageIndex);\n                }\n                // 配列から削除\n                this._items.splice(idx, 1);\n            }\n            // offset の再計算\n            const first = indexes[indexes.length - 1];\n            this.updateProfiles(first);\n        });\n    }\n\n    /** scroll map のトランジション設定 */\n    private setupScrollMapTransition(delay: number): void {\n        verify(this._scroller);\n        const el = this._$map[0];\n        this._$map.transitionEnd(() => {\n            clearTransition(el);\n        });\n        setTransformTransition(el, 'height', delay, 'ease');\n    }\n\n    /** 指定した item に設定した情報を取得 */\n    getItemInfo(target: number | Event): UnknownObject {\n        const { _items, _config } = this;\n\n        const parser = ($target: DOM): number => {\n            if ($target.hasClass(_config.LISTITEM_BASE_CLASS)) {\n                return Number($target.attr(_config.DATA_ITEM_INDEX));\n            } else if ($target.hasClass(_config.SCROLL_MAP_CLASS) || $target.length <= 0) {\n                console.warn('cannot ditect item from event object.');\n                return NaN;\n            } else {\n                return parser($target.parent());\n            }\n        };\n\n        const index = target instanceof Event ? parser($(target.target as HTMLElement)) : Number(target);\n\n        if (Number.isNaN(index)) {\n            throw makeResult(\n                RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM,\n                `${toHelpString(RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM)} [unsupported type: ${typeof target}]`\n            );\n        } else if (index < 0 || _items.length <= index) {\n            throw makeResult(\n                RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM,\n                `${toHelpString(RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM)} getItemInfo() [invalid index: ${index}]`\n            );\n        }\n\n        return _items[index].info;\n    }\n\n    /** アクティブページを更新 */\n    refresh(): this {\n        const { _pages, _items, _settings, _lastActivePageContext } = this;\n\n        const targets: Record<number, 'activate' | 'hide' | 'deactivate'> = {};\n        const currentPageIndex = this.getPageIndex();\n        const highPriorityIndex: number[] = [];\n\n        const storeNextPageState = (index: number): void => {\n            if (index === currentPageIndex) {\n                targets[index] = 'activate';\n                highPriorityIndex.push(index);\n            } else if (Math.abs(currentPageIndex - index) <= _settings.pagePrepareCount) {\n                targets[index] = 'activate';\n            } else if (_settings.enableHiddenPage) {\n                targets[index] = 'hide';\n            } else {\n                targets[index] = 'deactivate';\n            }\n            // current page の 前後は high priority にする\n            if (currentPageIndex + 1 === index || currentPageIndex - 1 === index) {\n                highPriorityIndex.push(index);\n            }\n        };\n\n        // 対象無し\n        if (_items.length <= 0) {\n            return this;\n        }\n\n        {\n            const searchCount = _settings.pagePrepareCount + _settings.pagePreloadCount;\n            const beginIndex = currentPageIndex - searchCount;\n            const endIndex = currentPageIndex + searchCount;\n\n            let overflowPrev = 0, overflowNext = 0;\n            for (let pageIndex = beginIndex; pageIndex <= endIndex; pageIndex++) {\n                if (pageIndex < 0) {\n                    overflowPrev++;\n                    continue;\n                }\n                if (_pages.length <= pageIndex) {\n                    overflowNext++;\n                    continue;\n                }\n                storeNextPageState(pageIndex);\n            }\n\n            if (0 < overflowPrev) {\n                for (let i = 0, pageIndex = currentPageIndex + searchCount + 1; i < overflowPrev; i++, pageIndex++) {\n                    if (_pages.length <= pageIndex) {\n                        break;\n                    }\n                    storeNextPageState(pageIndex);\n                }\n            }\n\n            if (0 < overflowNext) {\n                for (let i = 0, pageIndex = currentPageIndex - searchCount - 1; i < overflowNext; i++, pageIndex--) {\n                    if (pageIndex < 0) {\n                        break;\n                    }\n                    storeNextPageState(pageIndex);\n                }\n            }\n        }\n\n        // 不要になった page の 非活性化\n        for (const page of _pages.filter(page => 'inactive' !== page.status)) {\n            if (null == targets[page.index]) {\n                page.deactivate();\n            }\n        }\n\n        // 優先 page の activate\n        for (const idx of highPriorityIndex.sort((lhs, rhs) => lhs - rhs)) { // 昇順ソート\n            void post(() => {\n                this.isInitialized && _pages[idx]?.activate();\n            });\n        }\n\n        // そのほかの page の 状態変更\n        for (const key of Object.keys(targets)) {\n            const index = Number(key);\n            const action = targets[index];\n            void post(() => {\n                this.isInitialized && _pages[index]?.[action]?.();\n            });\n        }\n\n        // 更新後に使用しなかった DOM を削除\n        this.findRecycleElements().remove();\n\n        const pageCurrent = _pages[currentPageIndex];\n        _lastActivePageContext.from  = pageCurrent?.getItemFirst()?.index ?? 0;\n        _lastActivePageContext.to    = pageCurrent?.getItemLast()?.index ?? 0;\n        _lastActivePageContext.index = currentPageIndex;\n\n        return this;\n    }\n\n    /** 未アサインページを構築 */\n    update(): this {\n        this.assignPage(Math.max(this._pages.length - 1, 0));\n        this.refresh();\n        return this;\n    }\n\n    /** ページアサインを再構成 */\n    rebuild(): this {\n        this.clearPage();\n        this.assignPage();\n        this.refresh();\n        return this;\n    }\n\n    /** 管轄データを破棄 */\n    release(): this {\n        for (const item of this._items) {\n            item.deactivate();\n        }\n        this._pages.length = 0;\n        this._items.length = 0;\n        this._mapHeight = 0;\n        this._$map.height(0);\n        return this;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListScrollable\n\n    /** scroller の種類を取得 */\n    get scrollerType(): string | undefined {\n        return this._scroller?.type;\n    }\n\n    /** スクロール位置を取得 */\n    get scrollPos(): number {\n        return this._scroller?.pos ?? 0;\n    }\n\n    /** スクロール位置の最大値を取得 */\n    get scrollPosMax(): number {\n        return this._scroller?.posMax ?? 0;\n    }\n\n    /** スクロールイベントハンドラ設定/解除 */\n    setScrollHandler(handler: DOMEventListener, method: 'on' | 'off'): void {\n        this._scroller?.[method]('scroll', handler);\n    }\n\n    /** スクロール終了イベントハンドラ設定/解除 */\n    setScrollStopHandler(handler: DOMEventListener, method: 'on' | 'off'): void {\n        this._scroller?.[method]('scrollstop', handler);\n    }\n\n    /** スクロール位置を指定 */\n    async scrollTo(pos: number, animate?: boolean, time?: number): Promise<void> {\n        verify(this._scroller);\n        if (pos < 0) {\n            console.warn(`invalid position, too small. [pos: ${pos}]`);\n            pos = 0;\n        } else if (this._scroller.posMax < pos) {\n            console.warn(`invalid position, too big. [pos: ${pos}]`);\n            pos = this._scroller.posMax;\n        }\n        // pos のみ先駆けて更新\n        this._lastActivePageContext.pos = pos;\n        if (pos !== this._scroller.pos) {\n            await this._scroller.scrollTo(pos, animate, time);\n        }\n    }\n\n    /** インデックス指定された item の表示を保証 */\n    async ensureVisible(index: number, options?: ListEnsureVisibleOptions): Promise<void> {\n        const { _scroller, _items, _settings, _baseHeight } = this;\n\n        verify(_scroller);\n        if (index < 0 || _items.length <= index) {\n            throw makeResult(\n                RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM,\n                `${toHelpString(RESULT_CODE.ERROR_UI_LISTVIEW_INVALID_PARAM)} ensureVisible() [invalid index: ${index}]`\n            );\n        }\n\n        const { partialOK, setTop, animate, time, callback } = Object.assign({\n            partialOK: true,\n            setTop: false,\n            animate: _settings.enableAnimation,\n            time: _settings.animationDuration,\n            callback: noop,\n        }, options) as Required<ListEnsureVisibleOptions>;\n\n        const currentScope = {\n            from: _scroller.pos,\n            to: _scroller.pos + _baseHeight,\n        };\n\n        const target = _items[index];\n\n        const targetScope = {\n            from: target.offset,\n            to: target.offset + target.height,\n        };\n\n        const isInScope = (): boolean => {\n            if (partialOK) {\n                if (targetScope.from <= currentScope.from) {\n                    return currentScope.from <= targetScope.to;\n                } else {\n                    return targetScope.from <= currentScope.to;\n                }\n            } else {\n                return currentScope.from <= targetScope.from && targetScope.to <= currentScope.to;\n            }\n        };\n\n        const detectPosition = (): number => {\n            return targetScope.from < currentScope.from\n                ? targetScope.from\n                : target.offset - target.height // bottom 合わせは情報不足により不可\n            ;\n        };\n\n        let pos: number;\n        if (setTop) {\n            pos = targetScope.from;\n        } else if (isInScope()) {\n            callback(_scroller.pos);\n            return; // noop\n        } else {\n            pos = detectPosition();\n        }\n\n        await this.scrollTo(pos, animate, time);\n        callback(pos);\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListBackupRestore\n\n    /** 内部データのバックアップを実行 */\n    backup(key: string): boolean {\n        this._backup[key] = { items: this._items };\n        return true;\n    }\n\n    /** 内部データのバックアップを実行 */\n    restore(key: string, rebuild: boolean): boolean {\n        if (null == this._backup[key]) {\n            return false;\n        }\n        if (0 < this._items.length) {\n            this.release();\n        }\n\n        this._addItem(this._backup[key].items);\n\n        if (rebuild) {\n            this.rebuild();\n        }\n\n        return true;\n    }\n\n    /** バックアップデータの有無を確認 */\n    hasBackup(key: string): boolean {\n        return null != this._backup[key];\n    }\n\n    /** バックアップデータの破棄 */\n    clearBackup(key?: string): boolean {\n        if (null == key) {\n            for (const key of Object.keys(this._backup)) {\n                delete this._backup[key];\n            }\n            return true;\n        } else if (null != this._backup[key]) {\n            delete this._backup[key];\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    /** バックアップデータにアクセス */\n    getBackupData(key: string): { items: ItemProfile[]; } | undefined {\n        return this._backup[key];\n    }\n\n    /** バックアップデータを外部より設定 */\n    setBackupData(key: string, data: { items: ItemProfile[]; }): boolean {\n        if (Array.isArray(data.items)) {\n            this._backup[key] = data;\n            return true;\n        }\n        return false;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// internal:\n\n    /** @internal */\n    private get _config(): ListViewGlobalConfig {\n        return ListViewGlobalConfig();\n    }\n\n    /** Scroller 用環境設定 */\n    private setScrollerCondition(): void {\n        this._scroller?.on('scroll', this._scrollEventHandler);\n        this._scroller?.on('scrollstop', this._scrollStopEventHandler);\n    }\n\n    /** Scroller 用環境破棄 */\n    private resetScrollerCondition(): void {\n        this._scroller?.off('scrollstop', this._scrollStopEventHandler);\n        this._scroller?.off('scroll', this._scrollEventHandler);\n    }\n\n    /** 既定の Scroller オブジェクトの作成 */\n    private createScroller(): IListScroller {\n        return this._settings.scrollerFactory(this._$root, this._$map, this._settings);\n    }\n\n    /** 現在の Page Index を取得 */\n    private getPageIndex(): number {\n        const { _scroller, _baseHeight, _pages } = this;\n        verify(_scroller);\n\n        const { pos: scrollPos, posMax: scrollPosMax } = _scroller;\n\n        const scrollMapSize = (() => {\n            const lastPage = this.getLastPage();\n            return lastPage ? lastPage.offset + lastPage.height : _baseHeight;\n        })();\n\n        const pos = (() => {\n            if (0 === scrollPosMax || scrollPosMax <= _baseHeight) {\n                return 0;\n            } else {\n                return scrollPos * scrollMapSize / scrollPosMax;\n            }\n        })();\n\n        const validRange = (page: PageProfile | undefined): boolean => {\n            if (null == page) {\n                return false;\n            } else if (page.offset <= pos && pos <= page.offset + page.height) {\n                return true;\n            } else {\n                return false;\n            }\n        };\n\n        let candidate = Math.floor(pos / _baseHeight);\n        if (0 !== candidate && _pages.length <= candidate) {\n            candidate = _pages.length - 1;\n        }\n\n        let page = _pages[candidate];\n        if (validRange(page)) {\n            return page.index;\n        } else if (pos < page?.offset) {\n            for (let i = candidate - 1; i >= 0; i--) {\n                page = _pages[i];\n                if (validRange(page)) {\n                    return page.index;\n                }\n            }\n        } else {\n            for (let i = candidate + 1, n = _pages.length; i < n; i++) {\n                page = _pages[i];\n                if (validRange(page)) {\n                    return page.index;\n                }\n            }\n        }\n\n        console.warn(`cannot detect page index. fallback: ${_pages.length - 1}`);\n        return Math.max(0, _pages.length - 1);\n    }\n\n    /** 最後のページを取得 */\n    private getLastPage(): PageProfile | undefined {\n        if (0 < this._pages.length) {\n            return this._pages[this._pages.length - 1];\n        } else {\n            return undefined;\n        }\n    }\n\n    /** スクロールイベント*/\n    private onScroll(pos: number): void {\n        if (this._active && 0 < this._pages.length) {\n            const currentPageIndex = this.getPageIndex();\n            // TODO: intersectionRect を使用する場合, Scroll ハンドラー全般はどうあるべきか要検討\n            if (Math.abs(pos - this._lastActivePageContext.pos) < this._settings.scrollRefreshDistance) {\n                if (this._lastActivePageContext.index !== currentPageIndex) {\n                    this.refresh();\n                }\n            }\n            this._lastActivePageContext.pos = pos;\n        }\n    }\n\n    /** スクロール停止イベント */\n    private onScrollStop(pos: number): void {\n        if (this._active && 0 < this._pages.length) {\n            const currentPageIndex = this.getPageIndex();\n            if (this._lastActivePageContext.index !== currentPageIndex) {\n                this.refresh();\n            }\n            this._lastActivePageContext.pos = pos;\n        }\n    }\n\n    /** ページ区分のアサイン */\n    private assignPage(from?: number): void {\n        this.clearPage(from);\n\n        const { _items, _pages, _baseHeight, _scroller } = this;\n        const basePage = this.getLastPage();\n        const nextItemIndex = basePage?.getItemLast()?.index ?? 0;\n        const asigneeItems  = _items.slice(nextItemIndex);\n\n        let workPage = basePage;\n        if (null == workPage) {\n            workPage = new PageProfile();\n            _pages.push(workPage);\n        }\n\n        for (const item of asigneeItems) {\n            if (_baseHeight <= workPage.height) {\n                workPage.normalize();\n                const newPage = new PageProfile();\n                newPage.index = workPage.index + 1;\n                newPage.offset = workPage.offset + workPage.height;\n                workPage = newPage;\n                _pages.push(workPage);\n            }\n            item.pageIndex = workPage.index;\n            workPage.push(item);\n        }\n\n        workPage.normalize();\n\n        _scroller?.update();\n    }\n\n    /** ページ区分の解除 */\n    private clearPage(from?: number): void {\n        this._pages.splice(from ?? 0);\n    }\n\n    /** inactive 用 Map の生成 */\n    private prepareInactiveMap(): DOM {\n        const { _config, _$map, _mapHeight } = this;\n        const $parent = _$map.parent();\n        let $inactiveMap = $parent.find(`.${_config.INACTIVE_CLASS}`);\n\n        if ($inactiveMap.length <= 0) {\n            const currentPageIndex = this.getPageIndex();\n            const $listItemViews = _$map.clone().children().filter((_, element: HTMLElement) => {\n                const pageIndex = Number($(element).attr(_config.DATA_PAGE_INDEX));\n                if (currentPageIndex - 1 <= pageIndex && pageIndex <= currentPageIndex + 1) {\n                    return true;\n                } else {\n                    return false;\n                }\n            });\n            $inactiveMap = $(`<section class=\"${_config.SCROLL_MAP_CLASS} ${_config.INACTIVE_CLASS}\"></section>`)\n                .append($listItemViews)\n                .height(_mapHeight);\n            $parent.append($inactiveMap);\n            _$map.css('display', 'none');\n        }\n\n        return $inactiveMap;\n    }\n}\n","import {\n    type Writable,\n    type UnknownObject,\n    type DOM,\n    type DOMSelector,\n    type DOMEventListener,\n    dom as $,\n    type ViewConstructionOptions,\n    View,\n} from '@cdp/runtime';\nimport type {\n    ListContextOptions,\n    IListContext,\n    IListView,\n    ListEnsureVisibleOptions,\n    IListItemViewConstructor,\n} from './interfaces';\nimport { ListCore } from './core/list';\nimport { ItemProfile } from './profile';\n\n/** @internal */ const _properties = Symbol('properties');\n\n/** @internal */\ninterface Property {\n    readonly context: ListCore;\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Interface class that stores {@link ListView} initialization information.\n * @ja {@link ListView} の初期化情報を格納するインターフェイスクラス\n */\nexport interface ListViewConstructOptions<TElement extends Node = HTMLElement, TFuncName = string>\n    extends ListContextOptions, ViewConstructionOptions<TElement, TFuncName> {\n    initialHeight?: number;\n}\n\n/**\n * @en Virtual list view class that provides memory management functionality.\n * @ja メモリ管理機能を提供する仮想リストビュークラス\n */\nexport abstract class ListView<TElement extends Node = HTMLElement, TEvent extends object = object>\n    extends View<TElement, TEvent> implements IListView {\n\n    /** @internal */\n    private readonly [_properties]!: Property;\n\n    /** constructor */\n    constructor(options?: ListViewConstructOptions<TElement>) {\n        super(options);\n\n        (this[_properties] as Writable<Property>) = {\n            context: new ListCore(options),\n        } as Property;\n\n        this.setElement(this.$el as DOMSelector<TElement>);\n    }\n\n    /** context accessor */\n    get context(): IListContext {\n        return this[_properties].context;\n    }\n\n    /** construct option accessor */\n    get options(): ListViewConstructOptions<TElement> {\n        return this.context.options;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// View component methods:\n\n    /** `this.el` 更新時の新しい HTML をレンダリングロジックの実装関数. モデル更新と View テンプレートを連動させる. */\n    abstract render(...args: unknown[]): any; // eslint-disable-line @typescript-eslint/no-explicit-any\n\n    /**\n     * @override\n     * @en Change the view's element (`this.el` property) and re-delegate the view's events on the new element.\n     * @ja View が管轄する要素 (`this.el` property) の変更. イベント再設定も実行\n     *\n     * @param el\n     *  - `en` Object or the selector string which becomes origin of element.\n     *  - `ja` 要素のもとになるオブジェクトまたはセレクタ文字列\n     */\n    override setElement(el: DOMSelector<TElement | string>): this {\n        if (this[_properties]) {\n            const { context } = this[_properties];\n            const $el = $(el);\n            context.destroy();\n            context.initialize($el as DOM<Node> as DOM, this.options.initialHeight ?? $el.height());\n        }\n        return super.setElement(el);\n    }\n\n    /**\n     * @override\n     * @en Remove this view by taking the element out of the DOM with release all listeners.\n     * @ja View から DOM を切り離し, リスナーを解除\n     */\n    override remove(): this {\n        this[_properties].context.destroy();\n        return super.remove();\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListOperation\n\n    /**\n     * @en Determine whether it has been initialized.\n     * @ja 初期化済みか判定\n     *\n     * @returns\n     *  - `en` true: initialized / false: uninitialized\n     *  - `ja` true: 初期化済み / false: 未初期化\n     */\n    get isInitialized(): boolean {\n        return this[_properties].context.isInitialized;\n    }\n\n    /**\n     * @en Item registration.\n     * @ja item 登録\n     *\n     * @param height\n     *  - `en` initial item's height\n     *  - `ja` item の高さ\n     * @param initializer\n     *  - `en` constructor for {@link IListItemView}'s subclass\n     *  - `ja` {@link IListItemView} のサブクラスのコンストラクタ\n     * @param info\n     *  - `en` init parameters for {@link IListItemView}'s subclass\n     *  - `ja` {@link IListItemView} のサブクラスの初期化パラメータ\n     * @param insertTo\n     *  - `en` specify the insertion position of item by index\n     *  - `ja` item の挿入位置をインデックスで指定\n     */\n    addItem(height: number, initializer: IListItemViewConstructor, info: UnknownObject, insertTo?: number): void {\n        this._addItem(new ItemProfile(this.context, Math.trunc(height), initializer, info), insertTo);\n    }\n\n    /**\n     * @internal\n     * @en Item registration (internal use).\n     * @ja item 登録 (内部用)\n     *\n     * @param item\n     *  - `en` {@link ItemProfile} instance\n     *  - `ja` {@link ItemProfile} インスタンス\n     * @param insertTo\n     *  - `en` specify the insertion position of item by index\n     *  - `ja` item の挿入位置をインデックスで指定\n     */\n    _addItem(item: ItemProfile | ItemProfile[], insertTo?: number): void {\n        this[_properties].context._addItem(item, insertTo);\n    }\n\n    /**\n     * @en Delete the specified Item.\n     * @ja 指定した Item を削除\n     *\n     * @param index\n     *  - `en` specify the index to start releasing\n     *  - `ja` 解除開始のインデックスを指定\n     * @param size\n     *  - `en` total number of items to release\n     *  - `ja` 解除する item の総数 [default: 1]\n     * @param delay\n     *  - `en` delay time to actually delete the element [default: 0 (immediate deletion)\n     *  - `ja` 実際に要素を削除する delay time [default: 0 (即時削除)]\n     */\n    removeItem(index: number, size?: number, delay?: number): void;\n\n    /**\n     * @en Delete the specified Item.\n     * @ja 指定した Item を削除\n     *\n     * @param index\n     *  - `en` specify target index array. it is more efficient to specify reverse index.\n     *  - `ja` 対象インデックス配列を指定. reverse index を指定するほうが効率的\n     * @param delay\n     *  - `en` delay time to actually delete the element [default: 0 (immediate deletion)\n     *  - `ja` 実際に要素を削除する delay time [default: 0 (即時削除)]\n     */\n    removeItem(index: number[], delay?: number): void;\n\n    removeItem(index: number | number[], arg2?: number, arg3?: number): void {\n        this[_properties].context.removeItem(index as number, arg2, arg3); // avoid ts(2345)\n    }\n\n    /**\n     * @en Get the information set for the specified item.\n     * @ja 指定した item に設定した情報を取得\n     *\n     * @param target\n     *  - `en` identifier [index | event object]\n     *  - `ja` 識別子. [index | event object]\n     */\n    getItemInfo(target: number | Event): UnknownObject {\n        return this[_properties].context.getItemInfo(target);\n    }\n\n    /**\n     * @en Refresh active pages.\n     * @ja アクティブページを更新\n     */\n    refresh(): this {\n        this[_properties].context.refresh();\n        return this;\n    }\n\n    /**\n     * @en Build unassigned pages.\n     * @ja 未アサインページを構築\n     */\n    update(): this {\n        this[_properties].context.update();\n        return this;\n    }\n\n    /**\n     * @en Rebuild page assignments.\n     * @ja ページアサインを再構成\n     */\n    rebuild(): this {\n        this[_properties].context.rebuild();\n        return this;\n    }\n\n    /**\n     * @override\n     * @en Destroy internal data.\n     * @ja 管轄データを破棄\n     */\n    override release(): this {\n        this[_properties].context.release();\n        return super.release();\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListScrollable\n\n     /**\n     * @en Get scroll position.\n     * @ja スクロール位置を取得\n     */\n    get scrollPos(): number {\n        return this[_properties].context.scrollPos;\n    }\n\n     /**\n      * @en Get maximum scroll position.\n      * @ja スクロール位置の最大値を取得\n      */\n    get scrollPosMax(): number {\n        return this[_properties].context.scrollPosMax;\n    }\n\n     /**\n     * @en Scroll event handler setting/cancellation.\n     * @ja スクロールイベントハンドラ設定/解除\n     *\n     * @param handler\n     *  - `en` event handler function\n     *  - `ja` イベントハンドラー関数\n     * @param method\n     *  - `en` on: setting / off: canceling\n     *  - `ja` on: 設定 / off: 解除\n     */\n    setScrollHandler(handler: DOMEventListener, method: 'on' | 'off'): void {\n        this[_properties].context.setScrollHandler(handler, method);\n    }\n\n    /**\n     * @en Setting/cancelling scroll stop event handler.\n     * @ja スクロール終了イベントハンドラ設定/解除\n     *\n     * @param handler\n     *  - `en` event handler function\n     *  - `ja` イベントハンドラー関数\n     * @param method\n     *  - `en` on: setting / off: canceling\n     *  - `ja` on: 設定 / off: 解除\n     */\n    setScrollStopHandler(handler: DOMEventListener, method: 'on' | 'off'): void {\n        this[_properties].context.setScrollStopHandler(handler, method);\n    }\n\n    /**\n     * @en Set scroll position.\n     * @ja スクロール位置を指定\n     *\n     * @param pos\n     *  - `en` new scroll position value [0 - posMax]\n     *  - `ja` 新しいスクロール位置を指定 [0 - posMax]\n     * @param animate\n     *  - `en` enable/disable animation\n     *  - `ja` アニメーションの有無\n     * @param time\n     *  - `en` time spent on animation [msec]\n     *  - `ja` アニメーションに費やす時間 [msec]\n     */\n    scrollTo(pos: number, animate?: boolean, time?: number): Promise<void> {\n        return this[_properties].context.scrollTo(pos, animate, time);\n    }\n\n    /**\n     * @en Ensure visibility of item by index.\n     * @ja インデックス指定された item の表示を保証\n     *\n     * @param index\n     *  - `en` specify index of item\n     *  - `ja` item のインデックスを指定\n     * @param options\n     *  - `en` specify {@link ListEnsureVisibleOptions} object\n     *  - `ja` {@link ListEnsureVisibleOptions} オブジェクトを指定\n     */\n    ensureVisible(index: number, options?: ListEnsureVisibleOptions): Promise<void> {\n        return this[_properties].context.ensureVisible(index, options);\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListBackupRestore\n\n    /**\n     * @en Execute a backup of internal data.\n     * @ja 内部データのバックアップを実行\n     *\n     * @param key\n     *  - `en` specify backup key (any identifier)\n     *  - `ja` バックアップキー(任意の識別子)を指定\n     * @returns\n     *  - `en` true: success / false: failure\n     *  - `ja` true: 成功 / false: 失敗\n     */\n    backup(key: string): boolean {\n        return this[_properties].context.backup(key);\n    }\n\n    /**\n     * @en Execute a backup of internal data.\n     * @ja 内部データのバックアップを実行\n     *\n     * @param key\n     *  - `en` specify backup key (the one used for `backup()`)\n     *  - `ja` バックアップキーを指定 (`backup()` に使用したもの)\n     * @param rebuild\n     *  - `en` specify true to rebuild the list structure\n     *  - `ja` リスト構造を再構築する場合は true を指定\n     * @returns\n     *  - `en` true: success / false: failure\n     *  - `ja` true: 成功 / false: 失敗\n     */\n    restore(key: string, rebuild = true): boolean {\n        return this[_properties].context.restore(key, rebuild);\n    }\n\n    /**\n     * @en Check whether backup data exists.\n     * @ja バックアップデータの有無を確認\n     *\n     * @param key\n     *  - `en` specify backup key (the one used for `backup()`)\n     *  - `ja` バックアップキーを指定 (`backup()` に使用したもの)\n     * @returns\n     *  - `en` true: exists / false: not exists\n     *  - `ja` true: 有 / false: 無\n     */\n    hasBackup(key: string): boolean {\n        return this[_properties].context.hasBackup(key);\n    }\n\n    /**\n     * @en Discard backup data.\n     * @ja バックアップデータの破棄\n     *\n     * @param key\n     *  - `en` specify backup key (the one used for `backup()`)\n     *  - `ja` バックアップキーを指定 (`backup()` に使用したもの)\n     * @returns\n     *  - `en` true: discard existing data / false: specified data does not exist\n     *  - `ja` true: 存在したデータを破棄 / false: 指定されたデータは存在しない\n     */\n    clearBackup(key?: string): boolean {\n        return this[_properties].context.clearBackup(key);\n    }\n\n    /**\n     * @en Access backup data.\n     * @ja バックアップデータにアクセス\n     *\n     * @param key\n     *  - `en` specify backup key (the one used for `backup()`)\n     *  - `ja` バックアップキーを指定 (`backup()` に使用したもの)\n     */\n    getBackupData(key: string): UnknownObject | undefined {\n        return this[_properties].context.getBackupData(key);\n    }\n\n\n    /**\n     * @en Backup data can be set externally.\n     * @ja バックアップデータを外部より設定\n     *\n     * @param key\n     *  - `en` specify backup key\n     *  - `ja` バックアップキーを指定\n     * @returns\n     *  - `en` true: succeeded / false: schema invalid\n     *  - `ja` true: 成功 / false: スキーマが不正\n     */\n    setBackupData(key: string, data: UnknownObject): boolean {\n        return this[_properties].context.setBackupData(key, data as { items: ItemProfile[]; });\n    }\n}\n","import type { Writable } from '@cdp/runtime';\nimport type { IExpandableListView } from './interfaces';\nimport type { GroupProfile } from './profile';\nimport { type ListItemViewConstructionOptions, ListItemView } from './list-item-view';\n\n/** @internal */ const _properties = Symbol('properties');\n\n/** @internal */\ninterface Property {\n    readonly group: GroupProfile;\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Options to pass to {@link ExpandableListItemView} construction.\n * @ja {@link ExpandableListItemView} 構築に渡すオプション\n */\nexport interface ExpandableListItemViewConstructionOptions<TElement extends Node = HTMLElement, TFuncName = string>\n    extends ListItemViewConstructionOptions<TElement, TFuncName> {\n    owner: IExpandableListView;\n    /** {@link GroupProfile} instance */\n    group: GroupProfile;\n}\n\n/**\n * @en List item container class handled by {@link ExpandableListView}.\n * @ja {@link ExpandableListView} が扱うリストアイテムコンテナクラス\n */\nexport abstract class ExpandableListItemView<TElement extends Node = HTMLElement, TEvent extends object = object>\n    extends ListItemView<TElement, TEvent> {\n\n    /** @internal */\n    private readonly [_properties]!: Property;\n\n    /** constructor */\n    constructor(options: ExpandableListItemViewConstructionOptions<TElement>) {\n        super(options);\n        const { group } = options;\n        (this[_properties] as Writable<Property>) = { group } as Property;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// protected methods:\n\n    /**\n     * @en Check expanded / collapsed status.\n     * @ja 展開状態を判定\n     *\n     * @returns\n     *  - `en` true: expanded, collapsed: close\n     *  - `ja` true: 展開, false: 収束\n     */\n    protected get isExpanded(): boolean {\n        return this[_properties].group.isExpanded;\n    }\n\n    /**\n     * @en Determine whether the list is during expanding.\n     * @ja 展開中か判定\n     */\n    protected get isExpanding(): boolean {\n        return (this.owner as IExpandableListView).isExpanding;\n    }\n\n    /**\n     * @en Determine whether the list is during collapsing.\n     * @ja 収束中か判定\n     */\n    protected get isCollapsing(): boolean {\n        return (this.owner as IExpandableListView).isCollapsing;\n    }\n\n    /**\n     * @en Determine whether the list is during expanding or collapsing.\n     * @ja 開閉中か判定\n     */\n    protected get isSwitching(): boolean {\n        return (this.owner as IExpandableListView).isSwitching;\n    }\n\n    /**\n     * @en Determine if it has a child {@link GroupProfile}.\n     * @ja 子 {@link GroupProfile} を持っているか判定\n     *\n     * @returns\n     *  - `en` true: exists, false: unexists\n     *  - `ja` true: 有, false: 無\n     */\n    protected get hasChildren(): boolean {\n        return this[_properties].group.hasChildren;\n    }\n}\n","import {\n    luid,\n    statusAddRef,\n    statusRelease,\n    statusScope,\n    isStatusIn,\n} from '@cdp/runtime';\nimport type {\n    IExpandOperation,\n    IListStatusManager,\n    IListBackupRestore,\n    IExpandableListContext,\n} from '../interfaces';\nimport { GroupProfile } from '../profile';\n\n/**\n * @internal\n * @en Core logic implementation class that manages expanding / collapsing state.\n * @ja 開閉状態管理を行うコアロジック実装クラス\n */\nexport class ExpandCore implements\n    IExpandOperation,\n    IListStatusManager,\n    IListBackupRestore {\n\n    private readonly _owner: IExpandableListContext;\n\n    /** { id: GroupProfile } */\n    private _mapGroups: Record<string, GroupProfile> = {};\n    /** 第1階層 GroupProfile を格納 */\n    private _aryTopGroups: GroupProfile[] = [];\n\n    /** データの backup 領域. key と { map, tops } を格納 */\n    private readonly _backup: Record<string, { map: Record<string, GroupProfile>; tops: GroupProfile[]; }> = {};\n\n    /**\n     * constructor\n     * @param owner 親 View のインスタンス\n     */\n    constructor(owner: IExpandableListContext) {\n        this._owner = owner;\n    }\n\n    /** データを破棄 */\n    public release(): void {\n        this._mapGroups = {};\n        this._aryTopGroups = [];\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IExpandOperation\n\n    /** 新規 GroupProfile を作成 */\n    newGroup(id?: string): GroupProfile {\n        id = id ?? luid('list-group', 4);\n        if (null != this._mapGroups[id]) {\n            return this._mapGroups[id];\n        }\n        const group = new GroupProfile(this._owner, id);\n        this._mapGroups[id] = group;\n        return group;\n    }\n\n    /** 登録済み Group を取得 */\n    getGroup(id: string): GroupProfile | undefined {\n        return this._mapGroups[id];\n    }\n\n    /** 第1階層の Group 登録 */\n    registerTopGroup(topGroup: GroupProfile): void {\n        // すでに登録済みの場合は restore して layout キーごとに復元する。\n        if ('registered' === topGroup.status) {\n            // TODO: orientation changed 時の layout キー変更対応だが、キーに変更が無いときは不具合となる。\n            // この API に実装が必要かも含めて見直しが必要\n            topGroup.restore();\n            return;\n        }\n\n        const lastGroup = this._aryTopGroups[this._aryTopGroups.length - 1];\n        const insertTo = lastGroup?.getNextItemIndex(true) ?? 0;\n\n        this._aryTopGroups.push(topGroup);\n        topGroup.register(insertTo);\n    }\n\n    /** 第1階層の Group を取得 */\n    getTopGroups(): GroupProfile[] {\n        return this._aryTopGroups.slice(0);\n    }\n\n    /** すべてのグループを展開 (1階層) */\n    async expandAll(): Promise<void> {\n        const promisies: Promise<void>[] = [];\n        for (const group of this._aryTopGroups) {\n            promisies.push(group.expand());\n        }\n        await Promise.all(promisies);\n    }\n\n    /** すべてのグループを収束 (1階層) */\n    async collapseAll(delay?: number): Promise<void> {\n        const promisies: Promise<void>[] = [];\n        for (const group of this._aryTopGroups) {\n            promisies.push(group.collapse(delay));\n        }\n        await Promise.all(promisies);\n    }\n\n    /** 展開中か判定 */\n    get isExpanding(): boolean {\n        return this.isStatusIn('expanding');\n    }\n\n    /** 収束中か判定 */\n    get isCollapsing(): boolean {\n        return this.isStatusIn('collapsing');\n    }\n\n    /** 開閉中か判定 */\n    get isSwitching(): boolean {\n        return this.isExpanding || this.isCollapsing;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListStatusManager\n\n    /** 状態変数の参照カウントのインクリメント */\n    statusAddRef(status: string): number {\n        return statusAddRef(status);\n    }\n\n    /** 状態変数の参照カウントのデクリメント */\n    statusRelease(status: string): number {\n        return statusRelease(status);\n    }\n\n    /** 処理スコープ毎に状態変数を設定 */\n    statusScope<T>(status: string, executor: () => T | Promise<T>): Promise<T> {\n        return statusScope(status, executor);\n    }\n\n    /** 指定した状態中であるか確認 */\n    isStatusIn(status: string): boolean {\n        return isStatusIn(status);\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IListBackupRestore\n\n    /** 内部データをバックアップ */\n    backup(key: string): boolean {\n        const { _backup } = this;\n        if (null == _backup[key]) {\n            _backup[key] = {\n                map: this._mapGroups,\n                tops: this._aryTopGroups,\n            };\n        }\n        return true;\n    }\n\n    /** 内部データをリストア */\n    restore(key: string, rebuild: boolean): boolean {\n        const backup = this.getBackupData(key);\n        if (null == backup) {\n            return false;\n        }\n\n        if (0 < this._aryTopGroups.length) {\n            this.release();\n        }\n\n        Object.assign(this._mapGroups, backup.map);\n        this._aryTopGroups = backup.tops.slice();\n\n        // 展開しているものを登録\n        for (const group of this._aryTopGroups) {\n            group.restore();\n        }\n\n        // 再構築の予約\n        rebuild && this._owner.rebuild();\n        return true;\n    }\n\n    /** バックアップデータの有無 */\n    hasBackup(key: string): boolean {\n        return null != this._backup[key];\n    }\n\n    /** バックアップデータの破棄 */\n    clearBackup(key?: string): boolean {\n        if (null == key) {\n            for (const key of Object.keys(this._backup)) {\n                delete this._backup[key];\n            }\n            return true;\n        } else if (null != this._backup[key]) {\n            delete this._backup[key];\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    /** バックアップデータにアクセス */\n    getBackupData(key: string): { map: Record<string, GroupProfile>; tops: GroupProfile[]; } {\n        return this._backup[key];\n    }\n\n    /** バックアップデータを外部より設定 */\n    setBackupData(key: string, data: { map: Record<string, GroupProfile>; tops: GroupProfile[]; }): boolean {\n        if (data.map && Array.isArray(data.tops)) {\n            this._backup[key] = data;\n            return true;\n        }\n        return false;\n    }\n}\n","import type { Writable, UnknownObject } from '@cdp/runtime';\nimport type { IExpandableListView, IExpandOperation } from './interfaces';\nimport { ExpandCore } from './core';\nimport type { GroupProfile } from './profile';\nimport { type ListViewConstructOptions, ListView } from './list-view';\n\n/** @internal */ const _properties = Symbol('properties');\n\n/** @internal */\ninterface Property {\n    readonly context: ExpandCore;\n}\n\n//__________________________________________________________________________________________________//\n\n/**\n * @en Virtual list view class with expanding / collapsing functionality.\n * @ja 開閉機能を備えた仮想リストビュークラス\n */\nexport abstract class ExpandableListView<TElement extends Node = HTMLElement, TEvent extends object = object>\n    extends ListView<TElement, TEvent> implements IExpandableListView {\n\n    /** @internal */\n    private readonly [_properties]!: Property;\n\n    /** constructor */\n    constructor(options?: ListViewConstructOptions<TElement>) {\n        super(options);\n        (this[_properties] as Writable<Property>) = {\n            context: new ExpandCore(this),\n        } as Property;\n    }\n\n    /** context accessor */\n    get expandContext(): IExpandOperation {\n        return this[_properties].context;\n    }\n\n///////////////////////////////////////////////////////////////////////\n// implements: IExpandableListView\n\n    /**\n     * @en Create a new {@link GroupProfile}. Return the object if it is already registered.\n     * @ja 新規 {@link GroupProfile} を作成. 登録済みの場合はそのオブジェクトを返却\n     *\n     * @param id\n     *  - `en` specify the newly created group id. if not specified, automatic allocation will be performed.\n     *  - `ja` 新規に作成する Group ID を指定. 指定しない場合は自動割り振り\n     */\n    newGroup(id?: string): GroupProfile {\n        return this[_properties].context.newGroup(id);\n    }\n\n    /**\n     * @en Get registered {@link GroupProfile}.\n     * @ja 登録済み {@link GroupProfile} を取得\n     *\n     * @param id\n     *  - `en` specify the Group ID to retrieve\n     *  - `ja` 取得する Group ID を指定\n     */\n    getGroup(id: string): GroupProfile | undefined {\n        return this[_properties].context.getGroup(id);\n    }\n\n    /**\n     * @en 1st layer {@link GroupProfile} registration.\n     * @ja 第1階層の {@link GroupProfile} 登録\n     *\n     * @param topGroup\n     *  - `en` constructed {@link GroupProfile} instance\n     *  - `ja` 構築済み {@link GroupProfile} インスタンス\n     */\n    registerTopGroup(topGroup: GroupProfile): void {\n        this[_properties].context.registerTopGroup(topGroup);\n    }\n\n    /**\n     * @en Get 1st layer {@link GroupProfile}. <br>\n     *     A copy array is returned, so the client cannot cache it.\n     * @ja 第1階層の {@link GroupProfile} を取得 <br>\n     *     コピー配列が返されるため、クライアントはキャッシュ不可\n     */\n    getTopGroups(): GroupProfile[] {\n        return this[_properties].context.getTopGroups();\n    }\n\n    /**\n     * @en Expand all groups (1st layer)\n     * @ja すべてのグループを展開 (1階層)\n     */\n    expandAll(): Promise<void> {\n        return this[_properties].context.expandAll();\n    }\n\n    /**\n     * @en Collapse all groups (1st layer)\n     * @ja すべてのグループを収束 (1階層)\n     */\n    collapseAll(delay?: number): Promise<void> {\n        return this[_properties].context.collapseAll(delay);\n    }\n\n    /**\n     * @en Determine whether the list is during expanding.\n     * @ja 展開中か判定\n     */\n    get isExpanding(): boolean {\n        return this[_properties].context.isExpanding;\n    }\n\n    /**\n     * @en Determine whether the list is during collapsing.\n     * @ja 収束中か判定\n     */\n    get isCollapsing(): boolean {\n        return this[_properties].context.isCollapsing;\n    }\n\n    /**\n     * @en Determine whether the list is during expanding or collapsing.\n     * @ja 開閉中か判定\n     */\n    get isSwitching(): boolean {\n        return this[_properties].context.isSwitching;\n    }\n\n    /**\n     * @en Increment reference count for status identifier.\n     * @ja 状態変数の参照カウントのインクリメント\n     *\n     * @param status\n     *  - `en` state identifier\n     *  - `ja` 状態識別子\n     * @returns\n     *  - `en` reference count value\n     *  - `ja` 参照カウントの値\n     */\n    statusAddRef(status: string): number {\n        return this[_properties].context.statusAddRef(status);\n    }\n\n    /**\n     * @en Decrement reference count for status identifier.\n     * @ja 状態変数の参照カウントのデクリメント\n     *\n     * @param status\n     *  - `en` state identifier\n     *  - `ja` 状態識別子\n     * @returns\n     *  - `en` reference count value\n     *  - `ja` 参照カウントの値\n     */\n    statusRelease(status: string): number {\n        return this[_properties].context.statusRelease(status);\n    }\n\n    /**\n     * @en State variable management scope\n     * @ja 状態変数管理スコープ\n     *\n     * @param status\n     *  - `en` state identifier\n     *  - `ja` 状態識別子\n     * @param executor\n     *  - `en` seed function.\n     *  - `ja` 対象の関数\n     * @returns\n     *  - `en` retval of seed function.\n     *  - `ja` 対象の関数の戻り値\n     */\n    statusScope<T>(status: string, executor: () => T | Promise<T>): Promise<T> {\n        return this[_properties].context.statusScope(status, executor);\n    }\n\n    /**\n     * @en Check if it's in the specified state.\n     * @ja 指定した状態中であるか確認\n     *\n     * @param status\n     *  - `en` state identifier\n     *  - `ja` 状態識別子\n     * @return {Boolean} true: 状態内 / false: 状態外\n     * @returns\n     *  - `en` `true`: within the status / `false`: out of the status\n     *  - `ja` `true`: 状態内 / `false`: 状態外\n     */\n    isStatusIn(status: string): boolean {\n        return this[_properties].context.isStatusIn(status);\n    }\n\n///////////////////////////////////////////////////////////////////////\n// override: ListView\n\n    /**\n     * @override\n     * @en Destroy internal data.\n     * @ja 管轄データを破棄\n     */\n    override release(): this {\n        super.release();\n        this[_properties].context.release();\n        return this;\n    }\n\n    /**\n     * @override\n     * @en Execute a backup of internal data.\n     * @ja 内部データのバックアップを実行\n     *\n     * @param key\n     *  - `en` specify backup key (any identifier)\n     *  - `ja` バックアップキー(任意の識別子)を指定\n     * @returns\n     *  - `en` true: success / false: failure\n     *  - `ja` true: 成功 / false: 失敗\n     */\n    override backup(key: string): boolean {\n        return this[_properties].context.backup(key);\n    }\n\n    /**\n     * @override\n     * @en Execute a backup of internal data.\n     * @ja 内部データのバックアップを実行\n     *\n     * @param key\n     *  - `en` specify backup key (the one used for `backup()`)\n     *  - `ja` バックアップキーを指定 (`backup()` に使用したもの)\n     * @param rebuild\n     *  - `en` specify true to rebuild the list structure\n     *  - `ja` リスト構造を再構築する場合は true を指定\n     * @returns\n     *  - `en` true: success / false: failure\n     *  - `ja` true: 成功 / false: 失敗\n     */\n    override restore(key: string, rebuild = true): boolean {\n        return this[_properties].context.restore(key, rebuild);\n    }\n\n    /**\n     * @en Check whether backup data exists.\n     * @ja バックアップデータの有無を確認\n     *\n     * @param key\n     *  - `en` specify backup key (the one used for `backup()`)\n     *  - `ja` バックアップキーを指定 (`backup()` に使用したもの)\n     * @returns\n     *  - `en` true: exists / false: not exists\n     *  - `ja` true: 有 / false: 無\n     */\n    override hasBackup(key: string): boolean {\n        return this[_properties].context.hasBackup(key);\n    }\n\n    /**\n     * @en Discard backup data.\n     * @ja バックアップデータの破棄\n     *\n     * @param key\n     *  - `en` specify backup key (the one used for `backup()`)\n     *  - `ja` バックアップキーを指定 (`backup()` に使用したもの)\n     * @returns\n     *  - `en` true: discard existing data / false: specified data does not exist\n     *  - `ja` true: 存在したデータを破棄 / false: 指定されたデータは存在しない\n     */\n    override clearBackup(key?: string): boolean {\n        return this[_properties].context.clearBackup(key);\n    }\n\n    /**\n     * @en Access backup data.\n     * @ja バックアップデータにアクセス\n     *\n     * @param key\n     *  - `en` specify backup key (the one used for `backup()`)\n     *  - `ja` バックアップキーを指定 (`backup()` に使用したもの)\n     */\n    override getBackupData(key: string): UnknownObject | undefined {\n        return this[_properties].context.getBackupData(key);\n    }\n\n\n    /**\n     * @en Backup data can be set externally.\n     * @ja バックアップデータを外部より設定\n     *\n     * @param key\n     *  - `en` specify backup key\n     *  - `ja` バックアップキーを指定\n     * @returns\n     *  - `en` true: succeeded / false: schema invalid\n     *  - `ja` true: 成功 / false: スキーマが不正\n     */\n    override setBackupData(key: string, data: UnknownObject): boolean {\n        return this[_properties].context.setBackupData(key, data as { map: Record<string, GroupProfile>; tops: GroupProfile[]; });\n    }\n}\n"],"mappings":"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","ignoreList":[]}