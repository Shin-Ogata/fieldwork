/*!
 * @cdp/extension-template-transformer 0.9.9
 *   extension for transform to HTML templates from mustache.
 */
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(n="undefined"!=typeof globalThis?globalThis:n||self,t((n.CDP=n.CDP||{},n.CDP.Exension=n.CDP.Exension||{})))}(this,(function(n){"use strict";const t=n=>t=>e(t,n);function e(n,t){const e=[],i=[];let s=n,o=s.indexOf(t.delimiter.start);for(;o>=0;){if(s.indexOf(t.delimiter.end,o)<0)throw new Error(`missing end delimiter at: '${s}'`);e.push(s.substring(0,o));const n=r(s.substring(o+t.delimiter.start.length),t);if(n.insertionPoint)s=n.remainingTmplStr,i.push(n.insertionPoint),o=s.indexOf(t.delimiter.start);else{const r=e.pop();s=r+n.remainingTmplStr,o=s.indexOf(t.delimiter.start,r.length)}}return e.push(s),n=>t.html(e,...i.map((t=>t(n))))}function r(n,t){const e=Object.values(t.transformers).find((e=>e.test(n,t))),r=e?e.transform:t.transformVariable;return r(n,t)}function i(n,t){if("."===t)return n;let e=n;for(let n of t.split(".")){if(!e.hasOwnProperty(n))return"";e=e[n]}return e}function s(n,t){return function e(n){return null==n?"":""+n}(i(n,t))}const o=(n,{delimiter:t})=>{const e=n.indexOf(t.end),r=n.substring(0,e);return{remainingTmplStr:n.substring(e+t.end.length),insertionPoint:n=>s(n,r)}},m=n=>({test:n=>"{"===n[0],transform:(t,{delimiter:e})=>{const r=t.indexOf("}"+e.end);if(r<0)throw new Error(`missing end delimiter at: '${e.start}${t}'`);const i=t.substring(1,r);return{remainingTmplStr:t.substring(r+1+e.end.length),insertionPoint:t=>n(s(t,i))}}});function l(n){return[null,void 0,!1,0,NaN,""].some((t=>t===n))||n.length&&0===n.length}function a(n,t){const e=n.indexOf(t.end),r=n.substring(1,e),i=`${t.start}/${r}${t.end}`,s=n.indexOf(i);if(s<0)throw new Error(`missing end delimiter at: '${t.start}${n}'`);return{dataKey:r,innerTmpl:n.substring(e+t.start.length,s),remainingTmplStr:n.substring(s+i.length)}}const d=()=>({test:n=>"#"===n[0],transform:(n,t)=>{const r=a(n,t.delimiter),s=e(r.innerTmpl,t);return{remainingTmplStr:r.remainingTmplStr,insertionPoint:n=>{const t=i(n,r.dataKey);return l(t)?"":t.map?t.map((n=>s(n))):s(n)}}}}),f=()=>({test:n=>"^"===n[0],transform:(n,{delimiter:t})=>{const e=a(n,t);return{remainingTmplStr:e.remainingTmplStr,insertionPoint:n=>l(i(n,e.dataKey))?e.innerTmpl:""}}}),u=()=>({test:n=>"!"===n[0],transform:(n,{delimiter:t})=>({remainingTmplStr:n.substring(n.indexOf(t.end)+t.end.length),insertionPoint:void 0})}),c=()=>({test:n=>"="===n[0],transform:(n,t)=>{const e=t.delimiter.end.length,r=n.indexOf("="+t.delimiter.end);if(r<0)throw new Error(`missing end delimiter at: '${n}'`);const[i,s]=n.substring(1,r).split(" ");return t.delimiter.start=i,t.delimiter.end=s,{remainingTmplStr:n.substring(r+1+e),insertionPoint:void 0}}});const g={variable:o,unsafeVariable:m,section:d,invertedSection:f,comment:u,customDelimiter:c};n.createTransformFactory=function p(n,e){return"function"==typeof n?(r=n,i=e,t({html:r,delimiter:{start:"{{",end:"}}"},transformVariable:o,transformers:{unsafeVariable:m(i),section:d(),invertedSection:f(),comment:{test:n=>"!"===n[0],transform:(n,{delimiter:t})=>({remainingTmplStr:n.substring(n.indexOf(t.end)+t.end.length),insertionPoint:void 0})},customDelimiterTransformer:c()}})):t(Object.assign({delimiter:{start:"{{",end:"}}"},transformers:{}},n));var r,i},n.transformer=g,Object.defineProperty(n,"__esModule",{value:!0})}));
//# sourceMappingURL=extension-template-transformer.min.map